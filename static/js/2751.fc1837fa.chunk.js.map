{"version":3,"file":"static/js/2751.fc1837fa.chunk.js","mappings":"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","sources":["../node_modules/prosemirror-dropcursor/dist/index.js","../node_modules/prosemirror-gapcursor/dist/index.js","../node_modules/@milkdown/plugin-cursor/src/index.ts","../node_modules/@milkdown/crepe/src/feature/cursor/index.ts"],"sourcesContent":["import { Plugin } from 'prosemirror-state';\nimport { dropPoint } from 'prosemirror-transform';\n\n/**\nCreate a plugin that, when added to a ProseMirror instance,\ncauses a decoration to show up at the drop position when something\nis dragged over the editor.\n\nNodes may add a `disableDropCursor` property to their spec to\ncontrol the showing of a drop cursor inside them. This may be a\nboolean or a function, which will be called with a view and a\nposition, and should return a boolean.\n*/\nfunction dropCursor(options = {}) {\n    return new Plugin({\n        view(editorView) { return new DropCursorView(editorView, options); }\n    });\n}\nclass DropCursorView {\n    constructor(editorView, options) {\n        var _a;\n        this.editorView = editorView;\n        this.cursorPos = null;\n        this.element = null;\n        this.timeout = -1;\n        this.width = (_a = options.width) !== null && _a !== void 0 ? _a : 1;\n        this.color = options.color === false ? undefined : (options.color || \"black\");\n        this.class = options.class;\n        this.handlers = [\"dragover\", \"dragend\", \"drop\", \"dragleave\"].map(name => {\n            let handler = (e) => { this[name](e); };\n            editorView.dom.addEventListener(name, handler);\n            return { name, handler };\n        });\n    }\n    destroy() {\n        this.handlers.forEach(({ name, handler }) => this.editorView.dom.removeEventListener(name, handler));\n    }\n    update(editorView, prevState) {\n        if (this.cursorPos != null && prevState.doc != editorView.state.doc) {\n            if (this.cursorPos > editorView.state.doc.content.size)\n                this.setCursor(null);\n            else\n                this.updateOverlay();\n        }\n    }\n    setCursor(pos) {\n        if (pos == this.cursorPos)\n            return;\n        this.cursorPos = pos;\n        if (pos == null) {\n            this.element.parentNode.removeChild(this.element);\n            this.element = null;\n        }\n        else {\n            this.updateOverlay();\n        }\n    }\n    updateOverlay() {\n        let $pos = this.editorView.state.doc.resolve(this.cursorPos);\n        let isBlock = !$pos.parent.inlineContent, rect;\n        if (isBlock) {\n            let before = $pos.nodeBefore, after = $pos.nodeAfter;\n            if (before || after) {\n                let node = this.editorView.nodeDOM(this.cursorPos - (before ? before.nodeSize : 0));\n                if (node) {\n                    let nodeRect = node.getBoundingClientRect();\n                    let top = before ? nodeRect.bottom : nodeRect.top;\n                    if (before && after)\n                        top = (top + this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top) / 2;\n                    rect = { left: nodeRect.left, right: nodeRect.right, top: top - this.width / 2, bottom: top + this.width / 2 };\n                }\n            }\n        }\n        if (!rect) {\n            let coords = this.editorView.coordsAtPos(this.cursorPos);\n            rect = { left: coords.left - this.width / 2, right: coords.left + this.width / 2, top: coords.top, bottom: coords.bottom };\n        }\n        let parent = this.editorView.dom.offsetParent;\n        if (!this.element) {\n            this.element = parent.appendChild(document.createElement(\"div\"));\n            if (this.class)\n                this.element.className = this.class;\n            this.element.style.cssText = \"position: absolute; z-index: 50; pointer-events: none;\";\n            if (this.color) {\n                this.element.style.backgroundColor = this.color;\n            }\n        }\n        this.element.classList.toggle(\"prosemirror-dropcursor-block\", isBlock);\n        this.element.classList.toggle(\"prosemirror-dropcursor-inline\", !isBlock);\n        let parentLeft, parentTop;\n        if (!parent || parent == document.body && getComputedStyle(parent).position == \"static\") {\n            parentLeft = -pageXOffset;\n            parentTop = -pageYOffset;\n        }\n        else {\n            let rect = parent.getBoundingClientRect();\n            parentLeft = rect.left - parent.scrollLeft;\n            parentTop = rect.top - parent.scrollTop;\n        }\n        this.element.style.left = (rect.left - parentLeft) + \"px\";\n        this.element.style.top = (rect.top - parentTop) + \"px\";\n        this.element.style.width = (rect.right - rect.left) + \"px\";\n        this.element.style.height = (rect.bottom - rect.top) + \"px\";\n    }\n    scheduleRemoval(timeout) {\n        clearTimeout(this.timeout);\n        this.timeout = setTimeout(() => this.setCursor(null), timeout);\n    }\n    dragover(event) {\n        if (!this.editorView.editable)\n            return;\n        let pos = this.editorView.posAtCoords({ left: event.clientX, top: event.clientY });\n        let node = pos && pos.inside >= 0 && this.editorView.state.doc.nodeAt(pos.inside);\n        let disableDropCursor = node && node.type.spec.disableDropCursor;\n        let disabled = typeof disableDropCursor == \"function\" ? disableDropCursor(this.editorView, pos, event) : disableDropCursor;\n        if (pos && !disabled) {\n            let target = pos.pos;\n            if (this.editorView.dragging && this.editorView.dragging.slice) {\n                let point = dropPoint(this.editorView.state.doc, target, this.editorView.dragging.slice);\n                if (point != null)\n                    target = point;\n            }\n            this.setCursor(target);\n            this.scheduleRemoval(5000);\n        }\n    }\n    dragend() {\n        this.scheduleRemoval(20);\n    }\n    drop() {\n        this.scheduleRemoval(20);\n    }\n    dragleave(event) {\n        if (event.target == this.editorView.dom || !this.editorView.dom.contains(event.relatedTarget))\n            this.setCursor(null);\n    }\n}\n\nexport { dropCursor };\n","import { keydownHandler } from 'prosemirror-keymap';\nimport { Selection, NodeSelection, TextSelection, Plugin } from 'prosemirror-state';\nimport { Slice, Fragment } from 'prosemirror-model';\nimport { DecorationSet, Decoration } from 'prosemirror-view';\n\n/**\nGap cursor selections are represented using this class. Its\n`$anchor` and `$head` properties both point at the cursor position.\n*/\nclass GapCursor extends Selection {\n    /**\n    Create a gap cursor.\n    */\n    constructor($pos) {\n        super($pos, $pos);\n    }\n    map(doc, mapping) {\n        let $pos = doc.resolve(mapping.map(this.head));\n        return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos);\n    }\n    content() { return Slice.empty; }\n    eq(other) {\n        return other instanceof GapCursor && other.head == this.head;\n    }\n    toJSON() {\n        return { type: \"gapcursor\", pos: this.head };\n    }\n    /**\n    @internal\n    */\n    static fromJSON(doc, json) {\n        if (typeof json.pos != \"number\")\n            throw new RangeError(\"Invalid input for GapCursor.fromJSON\");\n        return new GapCursor(doc.resolve(json.pos));\n    }\n    /**\n    @internal\n    */\n    getBookmark() { return new GapBookmark(this.anchor); }\n    /**\n    @internal\n    */\n    static valid($pos) {\n        let parent = $pos.parent;\n        if (parent.isTextblock || !closedBefore($pos) || !closedAfter($pos))\n            return false;\n        let override = parent.type.spec.allowGapCursor;\n        if (override != null)\n            return override;\n        let deflt = parent.contentMatchAt($pos.index()).defaultType;\n        return deflt && deflt.isTextblock;\n    }\n    /**\n    @internal\n    */\n    static findGapCursorFrom($pos, dir, mustMove = false) {\n        search: for (;;) {\n            if (!mustMove && GapCursor.valid($pos))\n                return $pos;\n            let pos = $pos.pos, next = null;\n            // Scan up from this position\n            for (let d = $pos.depth;; d--) {\n                let parent = $pos.node(d);\n                if (dir > 0 ? $pos.indexAfter(d) < parent.childCount : $pos.index(d) > 0) {\n                    next = parent.child(dir > 0 ? $pos.indexAfter(d) : $pos.index(d) - 1);\n                    break;\n                }\n                else if (d == 0) {\n                    return null;\n                }\n                pos += dir;\n                let $cur = $pos.doc.resolve(pos);\n                if (GapCursor.valid($cur))\n                    return $cur;\n            }\n            // And then down into the next node\n            for (;;) {\n                let inside = dir > 0 ? next.firstChild : next.lastChild;\n                if (!inside) {\n                    if (next.isAtom && !next.isText && !NodeSelection.isSelectable(next)) {\n                        $pos = $pos.doc.resolve(pos + next.nodeSize * dir);\n                        mustMove = false;\n                        continue search;\n                    }\n                    break;\n                }\n                next = inside;\n                pos += dir;\n                let $cur = $pos.doc.resolve(pos);\n                if (GapCursor.valid($cur))\n                    return $cur;\n            }\n            return null;\n        }\n    }\n}\nGapCursor.prototype.visible = false;\nGapCursor.findFrom = GapCursor.findGapCursorFrom;\nSelection.jsonID(\"gapcursor\", GapCursor);\nclass GapBookmark {\n    constructor(pos) {\n        this.pos = pos;\n    }\n    map(mapping) {\n        return new GapBookmark(mapping.map(this.pos));\n    }\n    resolve(doc) {\n        let $pos = doc.resolve(this.pos);\n        return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos);\n    }\n}\nfunction closedBefore($pos) {\n    for (let d = $pos.depth; d >= 0; d--) {\n        let index = $pos.index(d), parent = $pos.node(d);\n        // At the start of this parent, look at next one\n        if (index == 0) {\n            if (parent.type.spec.isolating)\n                return true;\n            continue;\n        }\n        // See if the node before (or its first ancestor) is closed\n        for (let before = parent.child(index - 1);; before = before.lastChild) {\n            if ((before.childCount == 0 && !before.inlineContent) || before.isAtom || before.type.spec.isolating)\n                return true;\n            if (before.inlineContent)\n                return false;\n        }\n    }\n    // Hit start of document\n    return true;\n}\nfunction closedAfter($pos) {\n    for (let d = $pos.depth; d >= 0; d--) {\n        let index = $pos.indexAfter(d), parent = $pos.node(d);\n        if (index == parent.childCount) {\n            if (parent.type.spec.isolating)\n                return true;\n            continue;\n        }\n        for (let after = parent.child(index);; after = after.firstChild) {\n            if ((after.childCount == 0 && !after.inlineContent) || after.isAtom || after.type.spec.isolating)\n                return true;\n            if (after.inlineContent)\n                return false;\n        }\n    }\n    return true;\n}\n\n/**\nCreate a gap cursor plugin. When enabled, this will capture clicks\nnear and arrow-key-motion past places that don't have a normally\nselectable position nearby, and create a gap cursor selection for\nthem. The cursor is drawn as an element with class\n`ProseMirror-gapcursor`. You can either include\n`style/gapcursor.css` from the package's directory or add your own\nstyles to make it visible.\n*/\nfunction gapCursor() {\n    return new Plugin({\n        props: {\n            decorations: drawGapCursor,\n            createSelectionBetween(_view, $anchor, $head) {\n                return $anchor.pos == $head.pos && GapCursor.valid($head) ? new GapCursor($head) : null;\n            },\n            handleClick,\n            handleKeyDown,\n            handleDOMEvents: { beforeinput: beforeinput }\n        }\n    });\n}\nconst handleKeyDown = keydownHandler({\n    \"ArrowLeft\": arrow(\"horiz\", -1),\n    \"ArrowRight\": arrow(\"horiz\", 1),\n    \"ArrowUp\": arrow(\"vert\", -1),\n    \"ArrowDown\": arrow(\"vert\", 1)\n});\nfunction arrow(axis, dir) {\n    const dirStr = axis == \"vert\" ? (dir > 0 ? \"down\" : \"up\") : (dir > 0 ? \"right\" : \"left\");\n    return function (state, dispatch, view) {\n        let sel = state.selection;\n        let $start = dir > 0 ? sel.$to : sel.$from, mustMove = sel.empty;\n        if (sel instanceof TextSelection) {\n            if (!view.endOfTextblock(dirStr) || $start.depth == 0)\n                return false;\n            mustMove = false;\n            $start = state.doc.resolve(dir > 0 ? $start.after() : $start.before());\n        }\n        let $found = GapCursor.findGapCursorFrom($start, dir, mustMove);\n        if (!$found)\n            return false;\n        if (dispatch)\n            dispatch(state.tr.setSelection(new GapCursor($found)));\n        return true;\n    };\n}\nfunction handleClick(view, pos, event) {\n    if (!view || !view.editable)\n        return false;\n    let $pos = view.state.doc.resolve(pos);\n    if (!GapCursor.valid($pos))\n        return false;\n    let clickPos = view.posAtCoords({ left: event.clientX, top: event.clientY });\n    if (clickPos && clickPos.inside > -1 && NodeSelection.isSelectable(view.state.doc.nodeAt(clickPos.inside)))\n        return false;\n    view.dispatch(view.state.tr.setSelection(new GapCursor($pos)));\n    return true;\n}\n// This is a hack that, when a composition starts while a gap cursor\n// is active, quickly creates an inline context for the composition to\n// happen in, to avoid it being aborted by the DOM selection being\n// moved into a valid position.\nfunction beforeinput(view, event) {\n    if (event.inputType != \"insertCompositionText\" || !(view.state.selection instanceof GapCursor))\n        return false;\n    let { $from } = view.state.selection;\n    let insert = $from.parent.contentMatchAt($from.index()).findWrapping(view.state.schema.nodes.text);\n    if (!insert)\n        return false;\n    let frag = Fragment.empty;\n    for (let i = insert.length - 1; i >= 0; i--)\n        frag = Fragment.from(insert[i].createAndFill(null, frag));\n    let tr = view.state.tr.replace($from.pos, $from.pos, new Slice(frag, 0, 0));\n    tr.setSelection(TextSelection.near(tr.doc.resolve($from.pos + 1)));\n    view.dispatch(tr);\n    return false;\n}\nfunction drawGapCursor(state) {\n    if (!(state.selection instanceof GapCursor))\n        return null;\n    let node = document.createElement(\"div\");\n    node.className = \"ProseMirror-gapcursor\";\n    return DecorationSet.create(state.doc, [Decoration.widget(state.selection.head, node, { key: \"gapcursor\" })]);\n}\n\nexport { GapCursor, gapCursor };\n","import type { Meta, MilkdownPlugin } from '@milkdown/ctx'\nimport { dropCursor } from '@milkdown/prose/dropcursor'\nimport { gapCursor } from '@milkdown/prose/gapcursor'\nimport { $ctx, $prose } from '@milkdown/utils'\n\nfunction withMeta<T extends MilkdownPlugin>(\n  plugin: T,\n  meta: Partial<Meta> & Pick<Meta, 'displayName'>\n): T {\n  Object.assign(plugin, {\n    meta: {\n      package: '@milkdown/plugin-cursor',\n      ...meta,\n    },\n  })\n\n  return plugin\n}\n\n/// @internal\nexport interface DropCursorOptions {\n  /**\n    The color of the cursor. Defaults to `black`.\n   */\n  color?: string | false\n  /**\n    The precise width of the cursor in pixels. Defaults to 1.\n   */\n  width?: number\n  /**\n    A CSS class name to add to the cursor element.\n   */\n  class?: string\n}\n\n/// A slice that contains [options for drop cursor](https://github.com/ProseMirror/prosemirror-dropcursor#documentation).\nexport const dropCursorConfig = $ctx<DropCursorOptions, 'dropCursorConfig'>(\n  {},\n  'dropCursorConfig'\n)\n\nwithMeta(dropCursorConfig, {\n  displayName: 'Ctx<dropCursor>',\n})\n\n/// This plugin wraps [drop cursor](https://github.com/ProseMirror/prosemirror-dropcursor).\nexport const dropCursorPlugin = $prose((ctx) =>\n  dropCursor(ctx.get(dropCursorConfig.key))\n)\n\nwithMeta(dropCursorPlugin, {\n  displayName: 'Prose<dropCursor>',\n})\n\n/// This plugin wraps [gap cursor](https://github.com/ProseMirror/prosemirror-gapcursor).\nexport const gapCursorPlugin = $prose(() => gapCursor())\n\nwithMeta(gapCursorPlugin, {\n  displayName: 'Prose<gapCursor>',\n})\n\n/// All plugins exported by this package.\nexport const cursor: MilkdownPlugin[] = [\n  dropCursorConfig,\n  dropCursorPlugin,\n  gapCursorPlugin,\n]\n","import { cursor, dropCursorConfig } from '@milkdown/kit/plugin/cursor'\n\nimport type { DefineFeature } from '../shared'\n\ninterface CursorConfig {\n  color: string | false\n  width: number\n}\nexport type CursorFeatureConfig = Partial<CursorConfig>\n\nexport const defineFeature: DefineFeature<CursorFeatureConfig> = (\n  editor,\n  config\n) => {\n  editor\n    .config((ctx) => {\n      ctx.update(dropCursorConfig.key, () => ({\n        class: 'crepe-drop-cursor',\n        width: config?.width ?? 4,\n        color: config?.color ?? false,\n      }))\n    })\n    .use(cursor)\n}\n"],"names":["DropCursorView","constructor","editorView","options","_a","this","cursorPos","element","timeout","width","color","undefined","class","handlers","map","name","handler","e","dom","addEventListener","destroy","forEach","_ref","removeEventListener","update","prevState","doc","state","content","size","setCursor","updateOverlay","pos","parentNode","removeChild","rect","$pos","resolve","isBlock","parent","inlineContent","before","nodeBefore","after","nodeAfter","node","nodeDOM","nodeSize","nodeRect","getBoundingClientRect","top","bottom","left","right","coords","coordsAtPos","parentLeft","parentTop","offsetParent","appendChild","document","createElement","className","style","cssText","backgroundColor","classList","toggle","body","getComputedStyle","position","pageXOffset","pageYOffset","scrollLeft","scrollTop","height","scheduleRemoval","clearTimeout","setTimeout","dragover","event","editable","posAtCoords","clientX","clientY","inside","nodeAt","disableDropCursor","type","spec","disabled","target","dragging","slice","point","dropPoint","dragend","drop","dragleave","contains","relatedTarget","GapCursor","Selection","super","mapping","head","valid","near","Slice","empty","eq","other","toJSON","fromJSON","json","RangeError","getBookmark","GapBookmark","anchor","isTextblock","d","depth","index","child","lastChild","childCount","isAtom","isolating","closedBefore","indexAfter","firstChild","closedAfter","override","allowGapCursor","deflt","contentMatchAt","defaultType","findGapCursorFrom","dir","mustMove","arguments","length","search","next","$cur","isText","NodeSelection","isSelectable","prototype","visible","findFrom","jsonID","handleKeyDown","keydownHandler","arrow","axis","dirStr","dispatch","view","sel","selection","$start","$to","$from","TextSelection","endOfTextblock","$found","tr","setSelection","handleClick","clickPos","beforeinput","inputType","insert","findWrapping","schema","nodes","text","frag","Fragment","i","from","createAndFill","replace","drawGapCursor","DecorationSet","create","Decoration","widget","key","withMeta","plugin","meta","Object","assign","package","dropCursorConfig","$ctx","displayName","dropCursorPlugin","$prose","ctx","Plugin","dropCursor","get","gapCursorPlugin","props","decorations","createSelectionBetween","_view","$anchor","$head","handleDOMEvents","cursor","defineFeature","editor","config","_b","use"],"sourceRoot":""}