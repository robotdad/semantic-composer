(self.webpackChunksemantic_composer=self.webpackChunksemantic_composer||[]).push([[1070],{381:(e,t,n)=>{var i="Expected a function",o=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,r=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,u=c||d||Function("return this")(),h=Object.prototype.toString,p=Math.max,m=Math.min,v=function(){return u.Date.now()};function g(e,t,n){var o,l,a,s,r,c,d=0,u=!1,h=!1,g=!0;if("function"!=typeof e)throw new TypeError(i);function k(t){var n=o,i=l;return o=l=void 0,d=t,s=e.apply(i,n)}function y(e){var n=e-c;return void 0===c||n>=t||n<0||h&&e-d>=a}function w(){var e=v();if(y(e))return M(e);r=setTimeout(w,function(e){var n=t-(e-c);return h?m(n,a-(e-d)):n}(e))}function M(e){return r=void 0,g&&o?k(e):(o=l=void 0,s)}function $(){var e=v(),n=y(e);if(o=arguments,l=this,c=e,n){if(void 0===r)return function(e){return d=e,r=setTimeout(w,t),u?k(e):s}(c);if(h)return r=setTimeout(w,t),k(c)}return void 0===r&&(r=setTimeout(w,t)),s}return t=b(t)||0,f(n)&&(u=!!n.leading,a=(h="maxWait"in n)?p(b(n.maxWait)||0,t):a,g="trailing"in n?!!n.trailing:g),$.cancel=function(){void 0!==r&&clearTimeout(r),d=0,o=c=l=r=void 0},$.flush=function(){return void 0===r?s:M(v())},$}function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==h.call(e)}(e))return NaN;if(f(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=f(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=a.test(e);return n||s.test(e)?r(e.slice(2),n?2:8):l.test(e)?NaN:+e}e.exports=function(e,t,n){var o=!0,l=!0;if("function"!=typeof e)throw new TypeError(i);return f(n)&&(o="leading"in n?!!n.leading:o,l="trailing"in n?!!n.trailing:l),g(e,t,{leading:o,maxWait:t,trailing:l})}},1070:(e,t,n)=>{"use strict";n.d(t,{defineFeature:()=>ut});var i,o,l,a,s,r,c,d,u,h,p,m,v,g,f,b,k,y,w,M,$,x,C,I,L,T,W,E,N,S,O=n(4478),A=n(616),R=n(7184),B=n(1310),D=n(381),Y=n(4282),H=n(6667),P=e=>{throw TypeError(e)},j=(e,t,n)=>t.has(e)||P("Cannot "+n),F=(e,t,n)=>(j(e,t,"read from private field"),n?n.call(e):t.get(e)),q=(e,t,n)=>t.has(e)?P("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),U=(e,t,n,i)=>(j(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n);function _(e,t){return Object.assign(e,{meta:{package:"@milkdown/plugin-block",...t}}),e}const z=(0,O.Qx)({filterNodes:e=>!(0,A.gi)((e=>"table"===e.type.name))(e)},"blockConfig");_(z,{displayName:"Ctx<blockConfig>"});let J=null;const G={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};function K(e,t){const n=[];let{openStart:i,openEnd:o,content:l}=t;for(;i>1&&o>1&&1===l.childCount&&1===l.firstChild.childCount;){i-=1,o-=1;const e=l.firstChild;n.push(e.type.name,e.attrs!==e.type.defaultAttrs?e.attrs:null),l=e.content}const a=e.someProp("clipboardSerializer")||Y.ZF.fromSchema(e.state.schema),s=J||(J=document.implementation.createHTMLDocument("title")),r=s.createElement("div");r.appendChild(a.serializeFragment(l,{document:s}));let c,d=r.firstChild,u=0;for(;d&&1===d.nodeType&&(c=G[d.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){const t=s.createElement(c[e]);for(;r.firstChild;)t.appendChild(r.firstChild);r.appendChild(t),u++}d=r.firstChild}d&&1===d.nodeType&&d.setAttribute("data-pm-slice",`${i} ${o}${u?` -${u}`:""} ${JSON.stringify(n)}`);return{dom:r,text:e.someProp("clipboardTextSerializer",(n=>n(t,e)))||t.content.textBetween(0,t.content.size,"\n\n")}}const Q=A.T.ie&&A.T.ie_version<15||A.T.ios&&A.T.webkit_version<604;class V{constructor(){q(this,c),q(this,i),q(this,o),q(this,l),q(this,a),q(this,s),q(this,r),q(this,h),q(this,p),q(this,m),q(this,v),q(this,g),q(this,f),q(this,b),q(this,k),U(this,o,(()=>{if(!F(this,a))return null;const e=F(this,a),t=F(this,c,u);if(t&&R.nh.isSelectable(e.node)){const n=R.nh.create(t.state.doc,e.$pos.pos);return t.dispatch(t.state.tr.setSelection(n)),t.focus(),U(this,l,n),n}return null})),U(this,l,null),U(this,a,null),U(this,s,void 0),U(this,r,!1),U(this,p,(()=>{var e;null==(e=F(this,h))||e.call(this,{type:"hide"}),U(this,a,null)})),U(this,m,(e=>{var t;U(this,a,e),null==(t=F(this,h))||t.call(this,{type:"show",active:e})})),this.bind=(e,t)=>{U(this,i,e),U(this,h,t)},this.addEvent=e=>{e.addEventListener("mousedown",F(this,v)),e.addEventListener("mouseup",F(this,g)),e.addEventListener("dragstart",F(this,f))},this.removeEvent=e=>{e.removeEventListener("mousedown",F(this,v)),e.removeEventListener("mouseup",F(this,g)),e.removeEventListener("dragstart",F(this,f))},this.unBind=()=>{U(this,h,void 0)},U(this,v,(()=>{var e;U(this,s,null==(e=F(this,a))?void 0:e.el.getBoundingClientRect()),F(this,o).call(this)})),U(this,g,(()=>{F(this,r)?(U(this,r,!1),U(this,l,null)):requestAnimationFrame((()=>{var e;F(this,s)&&(null==(e=F(this,c,u))||e.focus())}))})),U(this,f,(e=>{var t;U(this,r,!0);const n=F(this,c,u);if(!n)return;n.dom.dataset.dragging="true";const i=F(this,l);if(e.dataTransfer&&i){const o=i.content();e.dataTransfer.effectAllowed="copyMove";const{dom:l,text:s}=K(n,o);e.dataTransfer.clearData(),e.dataTransfer.setData(Q?"Text":"text/html",l.innerHTML),Q||e.dataTransfer.setData("text/plain",s);const r=null==(t=F(this,a))?void 0:t.el;r&&e.dataTransfer.setDragImage(r,0,0),n.dragging={slice:o,move:!0}}})),this.keydownCallback=e=>(F(this,p).call(this),U(this,r,!1),e.dom.dataset.dragging="false",!1),U(this,b,D(((e,t)=>{if(!e.editable)return;const n=e.dom.getBoundingClientRect(),i=n.left+n.width/2;if(!(e.root.elementFromPoint(i,t.clientY)instanceof Element))return void F(this,p).call(this);const o=F(this,c,d);if(!o)return;const l=function(e,t,n){var i;if(!e.dom.parentElement)return null;try{const o=null==(i=e.posAtCoords({left:t.x,top:t.y}))?void 0:i.inside;if(null==o||o<0)return null;let l=e.state.doc.resolve(o),a=e.state.doc.nodeAt(o),s=e.nodeDOM(o);const r=t=>{const i=l.depth>=1&&0===l.index(l.depth);if(!t&&!i)return;const o=l.before(l.depth);a=e.state.doc.nodeAt(o),s=e.nodeDOM(o),l=e.state.doc.resolve(o),n(l,a)||r(!0)},c=n(l,a);return r(!c),s&&a?{node:a,$pos:l,el:s}:null}catch{return null}}(e,{x:i,y:t.clientY},o);l?F(this,m).call(this,l):F(this,p).call(this)}),200)),this.mousemoveCallback=(e,t)=>(e.composing||!e.editable||F(this,b).call(this,e,t),!1),this.dragoverCallback=(e,t)=>{var n;if(F(this,r)){const i=null==(n=F(this,c,u))?void 0:n.dom.parentElement;if(!i)return!1;const o=i.scrollHeight>i.clientHeight,l=i.getBoundingClientRect();if(o){if(i.scrollTop>0&&Math.abs(t.y-l.y)<20){const e=i.scrollTop>10?i.scrollTop-10:0;return i.scrollTop=e,!1}const n=Math.round(e.dom.getBoundingClientRect().height);if(Math.round(i.scrollTop+l.height)<n&&Math.abs(t.y-(l.height+l.y))<20){const e=i.scrollTop+10;return i.scrollTop=e,!1}}}return!1},this.dragenterCallback=e=>{e.dragging&&(U(this,r,!0),e.dom.dataset.dragging="true")},this.dragleaveCallback=(e,t)=>{const n=t.clientX,i=t.clientY;(n<0||i<0||n>window.innerWidth||i>window.innerHeight)&&(U(this,a,null),F(this,k).call(this,e))},this.dropCallback=e=>(F(this,k).call(this,e),!1),this.dragendCallback=e=>{F(this,k).call(this,e)},U(this,k,(e=>{U(this,r,!1),e.dom.dataset.dragging="false"}))}}i=new WeakMap,o=new WeakMap,l=new WeakMap,a=new WeakMap,s=new WeakMap,r=new WeakMap,c=new WeakSet,d=function(){var e;return null==(e=F(this,i))?void 0:e.get(z.key).filterNodes},u=function(){var e;return null==(e=F(this,i))?void 0:e.get(B.kY)},h=new WeakMap,p=new WeakMap,m=new WeakMap,v=new WeakMap,g=new WeakMap,f=new WeakMap,b=new WeakMap,k=new WeakMap;const Z=(0,O.Qx)((()=>new V),"blockService"),X=(0,O.Qx)({},"blockServiceInstance");_(Z,{displayName:"Ctx<blockService>"}),_(X,{displayName:"Ctx<blockServiceInstance>"});const ee=(0,O.Qx)({},"blockSpec");_(ee,{displayName:"Ctx<blockSpec>"});const te=(0,O.Gf)((e=>{const t=new R.hs("MILKDOWN_BLOCK"),n=e.get(Z.key)();e.set(X.key,n);const i=e.get(ee.key);return new R.k_({key:t,...i,props:{...i.props,handleDOMEvents:{drop:e=>n.dropCallback(e),pointermove:(e,t)=>n.mousemoveCallback(e,t),keydown:e=>n.keydownCallback(e),dragover:(e,t)=>n.dragoverCallback(e,t),dragleave:(e,t)=>n.dragleaveCallback(e,t),dragenter:e=>n.dragenterCallback(e),dragend:e=>n.dragendCallback(e)}}})}));_(te,{displayName:"Prose<block>"});class ne{constructor(e){q(this,N),q(this,y),q(this,w),q(this,M),q(this,$),q(this,x),q(this,C),q(this,I),q(this,L),q(this,T),q(this,W),q(this,E),U(this,$,null),U(this,C,!1),this.update=()=>{requestAnimationFrame((()=>{if(!F(this,C))try{(e=this,t=N,n=S,j(e,t,"access private method"),n).call(this),U(this,C,!0)}catch{}var e,t,n}))},this.destroy=()=>{var e,t;null==(e=F(this,M))||e.unBind(),null==(t=F(this,M))||t.removeEvent(F(this,y)),F(this,y).remove()},this.show=e=>{const t=e.el,n=F(this,w).get(B.kY).dom,i={ctx:F(this,w),active:e,editorDom:n,blockDom:F(this,y)},o={contextElement:t,getBoundingClientRect:()=>F(this,W)?F(this,W).call(this,i):t.getBoundingClientRect()},l=[(0,H.UU)()];if(F(this,T)){const e=F(this,T).call(this,i),t=(0,H.cY)(e);l.push(t)}(0,H.rD)(o,F(this,y),{placement:F(this,E)?F(this,E).call(this,i):"left",middleware:[...l,...F(this,I)],...F(this,L)}).then((e=>{let{x:t,y:n}=e;Object.assign(F(this,y).style,{left:`${t}px`,top:`${n}px`}),F(this,y).dataset.show="true"}))},this.hide=()=>{F(this,y).dataset.show="false"},U(this,w,e.ctx),U(this,y,e.content),U(this,T,e.getOffset),U(this,W,e.getPosition),U(this,E,e.getPlacement),U(this,I,e.middleware??[]),U(this,L,e.floatingUIOptions??{}),U(this,x,e.root),this.hide()}get active(){return F(this,$)}}y=new WeakMap,w=new WeakMap,M=new WeakMap,$=new WeakMap,x=new WeakMap,C=new WeakMap,I=new WeakMap,L=new WeakMap,T=new WeakMap,W=new WeakMap,E=new WeakMap,N=new WeakSet,S=function(){const e=F(this,w).get(B.kY);(F(this,x)??e.dom.parentElement??document.body).appendChild(F(this,y));const t=F(this,w).get(X.key);t.bind(F(this,w),(e=>{"hide"===e.type?(this.hide(),U(this,$,null)):"show"===e.type&&(this.show(e.active),U(this,$,e.active))})),U(this,M,t),F(this,M).addEvent(F(this,y)),F(this,y).draggable=!0};const ie=[ee,z,Z,X,te];ie.key=ee.key,ie.pluginKey=te.key;var oe,le,ae,se,re,ce,de,ue,he,pe,me,ve=n(9118),ge=n(446),fe=e=>{throw TypeError(e)},be=(e,t,n)=>t.has(e)||fe("Cannot "+n),ke=(e,t,n)=>(be(e,t,"read from private field"),n?n.call(e):t.get(e)),ye=(e,t,n)=>t.has(e)?fe("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),we=(e,t,n,i)=>(be(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n);class Me{constructor(e){var t,n=this;ye(this,pe),ye(this,oe),ye(this,le),ye(this,ae),ye(this,se),ye(this,re),ye(this,ce),ye(this,de),ye(this,ue),ye(this,he),we(this,oe,!1),this.onShow=()=>{},this.onHide=()=>{},we(this,he,((e,t)=>{const{state:n,composing:i}=e,{selection:o,doc:l}=n,{ranges:a}=o,s=Math.min(...a.map((e=>e.$from.pos))),r=Math.max(...a.map((e=>e.$to.pos))),c=t&&t.doc.eq(l)&&t.selection.eq(o);if(!ke(this,oe)){(ke(this,se)??e.dom.parentElement??document.body).appendChild(this.element),we(this,oe,!0)}if(i||c)return;if(!ke(this,de).call(this,e,t))return void this.hide();const d={getBoundingClientRect:()=>(0,A.MG)(e,s,r)};(0,H.rD)(d,this.element,{placement:"bottom-start",middleware:[(0,H.UU)(),(0,H.cY)(ke(this,ue)),...ke(this,le)],...ke(this,ae)}).then((e=>{let{x:t,y:n}=e;Object.assign(this.element.style,{left:`${t}px`,top:`${n}px`})})),this.show()})),this.update=(e,t)=>{ge(ke(this,he),ke(this,re))(e,t)},this.getContent=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>"paragraph"===e.type.name;const{selection:i}=e.state,{empty:o,$from:l}=i,a=e.state.selection instanceof R.U3,s=n.element.contains(document.activeElement),r=!e.hasFocus()&&!s,c=!e.editable,d=(0,A.KP)(t)(e.state.selection);if(!r&&!c&&o&&a&&!!d)return l.parent.textBetween(Math.max(0,l.parentOffset-500),l.parentOffset,void 0,"\ufffc")},this.destroy=()=>{},this.show=()=>{this.element.dataset.show="true",this.onShow()},this.hide=()=>{this.element.dataset.show="false",this.onHide()},this.element=e.content,we(this,re,e.debounce??200),we(this,de,e.shouldShow??(t=me,be(this,pe,"access private method"),t)),we(this,ce,e.trigger??"/"),we(this,ue,e.offset),we(this,le,e.middleware??[]),we(this,ae,e.floatingUIOptions??{}),we(this,se,e.root)}}oe=new WeakMap,le=new WeakMap,ae=new WeakMap,se=new WeakMap,re=new WeakMap,ce=new WeakMap,de=new WeakMap,ue=new WeakMap,he=new WeakMap,pe=new WeakSet,me=function(e){const t=this.getContent(e);if(!t)return!1;const n=t.at(-1);return!!n&&(Array.isArray(ke(this,ce))?ke(this,ce).includes(n):ke(this,ce)===n)};var $e,xe,Ce=n(4931),Ie=n(2420),Le=n(1517),Te=n(2025),We=n(8990),Ee=n(7511),Ne=n(8115),Se=e=>{throw TypeError(e)},Oe=(e,t,n)=>t.has(e)||Se("Cannot "+n),Ae=(e,t,n)=>(Oe(e,t,"read from private field"),n?n.call(e):t.get(e)),Re=(e,t,n)=>t.has(e)?Se("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n);class Be{constructor(){Re(this,$e,[]),this.clear=()=>{var e,t,n;return n=[],Oe(e=this,t=$e,"write to private field"),t.set(e,n),this},Re(this,xe,(e=>{const t={group:e,addItem:(n,i)=>{const o={key:n,...i};return e.items.push(o),t},clear:()=>(e.items=[],t)};return t})),this.addGroup=(e,t)=>{const n={key:e,label:t,items:[]};return Ae(this,$e).push(n),Ae(this,xe).call(this,n)},this.getGroup=e=>{const t=Ae(this,$e).find((t=>t.key===e));if(!t)throw new Error(`Group with key ${e} not found`);return Ae(this,xe).call(this,t)},this.build=()=>Ae(this,$e)}}function De(e){const{$from:t,$to:n}=e.selection,{pos:i}=t,{pos:o}=n;return e=e.deleteRange(i-t.node().content.size,o)}function Ye(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(n,i)=>{if(i){const o=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const{from:i,to:o}=e.selection;return e.setBlockType(i,o,t,n)}(De(n.tr),e,t);i(o.scrollIntoView())}return!0}}function He(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(n,i)=>{const o=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const{$from:i,$to:o}=e.selection,l=i.blockRange(o),a=l&&(0,Ne.oM)(l,t,n);return a?e.wrap(l,a):null}(De(n.tr),e,t);return!!o&&(i&&i(o.scrollIntoView()),!0)}}function Pe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(n,i)=>{const o=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const i=t.createAndFill(n);return i?e.replaceSelectionWith(i):null}(De(n.tr),e,t);return!!o&&(i&&i(o.scrollIntoView()),!0)}}$e=new WeakMap,xe=new WeakMap;const je=e=>{let{show:t,hide:n,ctx:i,filter:o,config:l}=e;const{groups:a,size:s}=(0,Ie.Kr)((()=>function(e,t,n){var i,o,l,a,s,r,c,d,u,h,p,m,v,g,f,b,k,y,w,M,$,x,C,I,L,T,W,E,N,S,O,A,D,Y,H,P,j,F,q,U,_,z,J,G,K,Q,V,Z,X,ee,te,ne;const ie=null==n?void 0:n.get(We.F),oe=null==ie?void 0:ie.includes(We.C.Latex),le=null==ie?void 0:ie.includes(We.C.ImageBlock),ae=null==ie?void 0:ie.includes(We.C.Table),se=new Be;se.addGroup("text",null!=(i=null==t?void 0:t.slashMenuTextGroupLabel)?i:"Text").addItem("text",{label:null!=(o=null==t?void 0:t.slashMenuTextGroupLabel)?o:"Text",icon:null!=(a=null==(l=null==t?void 0:t.slashMenuTextIcon)?void 0:l.call(t))?a:Ee.t,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;Ye(ve.Wf.type(e))(i,n)}}).addItem("h1",{label:null!=(s=null==t?void 0:t.slashMenuH1Label)?s:"Heading 1",icon:null!=(c=null==(r=null==t?void 0:t.slashMenuH1Icon)?void 0:r.call(t))?c:Ee.k,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;Ye(ve.Y4.type(e),{level:1})(i,n)}}).addItem("h2",{label:null!=(d=null==t?void 0:t.slashMenuH2Label)?d:"Heading 2",icon:null!=(h=null==(u=null==t?void 0:t.slashMenuH2Icon)?void 0:u.call(t))?h:Ee.l,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;Ye(ve.Y4.type(e),{level:2})(i,n)}}).addItem("h3",{label:null!=(p=null==t?void 0:t.slashMenuH3Label)?p:"Heading 3",icon:null!=(v=null==(m=null==t?void 0:t.slashMenuH3Icon)?void 0:m.call(t))?v:Ee.m,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;Ye(ve.Y4.type(e),{level:3})(i,n)}}).addItem("h4",{label:null!=(g=null==t?void 0:t.slashMenuH4Label)?g:"Heading 4",icon:null!=(b=null==(f=null==t?void 0:t.slashMenuH4Icon)?void 0:f.call(t))?b:Ee.n,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;Ye(ve.Y4.type(e),{level:4})(i,n)}}).addItem("h5",{label:null!=(k=null==t?void 0:t.slashMenuH5Label)?k:"Heading 5",icon:null!=(w=null==(y=null==t?void 0:t.slashMenuH5Icon)?void 0:y.call(t))?w:Ee.o,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;Ye(ve.Y4.type(e),{level:5})(i,n)}}).addItem("h6",{label:null!=(M=null==t?void 0:t.slashMenuH6Label)?M:"Heading 6",icon:null!=(x=null==($=null==t?void 0:t.slashMenuH6Icon)?void 0:$.call(t))?x:Ee.p,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;Ye(ve.Y4.type(e),{level:6})(i,n)}}).addItem("quote",{label:null!=(C=null==t?void 0:t.slashMenuQuoteLabel)?C:"Quote",icon:null!=(L=null==(I=null==t?void 0:t.slashMenuQuoteIcon)?void 0:I.call(t))?L:Ee.q,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;He(ve.JC.type(e))(i,n)}}).addItem("divider",{label:null!=(T=null==t?void 0:t.slashMenuDividerLabel)?T:"Divider",icon:null!=(E=null==(W=null==t?void 0:t.slashMenuDividerIcon)?void 0:W.call(t))?E:Ee.u,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;Pe(ve.Ab.type(e))(i,n)}}),se.addGroup("list",null!=(N=null==t?void 0:t.slashMenuListGroupLabel)?N:"List").addItem("bullet-list",{label:null!=(S=null==t?void 0:t.slashMenuBulletListLabel)?S:"Bullet List",icon:null!=(A=null==(O=null==t?void 0:t.slashMenuBulletListIcon)?void 0:O.call(t))?A:Ee.v,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;He(ve.UM.type(e))(i,n)}}).addItem("ordered-list",{label:null!=(D=null==t?void 0:t.slashMenuOrderedListLabel)?D:"Ordered List",icon:null!=(H=null==(Y=null==t?void 0:t.slashMenuOrderedListIcon)?void 0:Y.call(t))?H:Ee.w,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;He(ve.N.type(e))(i,n)}}).addItem("todo-list",{label:null!=(P=null==t?void 0:t.slashMenuTaskListLabel)?P:"Todo List",icon:null!=(F=null==(j=null==t?void 0:t.slashMenuTaskListIcon)?void 0:j.call(t))?F:Ee.x,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;He(ve.hm.type(e),{checked:!1})(i,n)}});const re=se.addGroup("advanced",null!=(q=null==t?void 0:t.slashMenuAdvancedGroupLabel)?q:"Advanced");le&&re.addItem("image",{label:null!=(U=null==t?void 0:t.slashMenuImageLabel)?U:"Image",icon:null!=(z=null==(_=null==t?void 0:t.slashMenuImageIcon)?void 0:_.call(t))?z:Ee.i,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;Pe(Le.YD.type(e))(i,n)}}),re.addItem("code",{label:null!=(J=null==t?void 0:t.slashMenuCodeBlockLabel)?J:"Code",icon:null!=(K=null==(G=null==t?void 0:t.slashMenuCodeBlockIcon)?void 0:G.call(t))?K:Ee.y,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;Pe(ve.Ay.type(e))(i,n)}}),ae&&re.addItem("table",{label:null!=(Q=null==t?void 0:t.slashMenuTableLabel)?Q:"Table",icon:null!=(Z=null==(V=null==t?void 0:t.slashMenuTableIcon)?void 0:V.call(t))?Z:Ee.z,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;let{tr:o}=i;o=De(o);const l=o.selection.from,a=(0,Te.ZR)(e,3,3);o=o.replaceSelectionWith(a),n(o),requestAnimationFrame((()=>{const e=t.state.doc.content.size,i=t.state.doc.resolve(l>e?e:l<0?0:l),o=R.U3.near(i),a=t.state.tr;a.setSelection(o),n(a.scrollIntoView())}))}}),oe&&re.addItem("math",{label:null!=(X=null==t?void 0:t.slashMenuMathLabel)?X:"Math",icon:null!=(te=null==(ee=null==t?void 0:t.slashMenuMathIcon)?void 0:ee.call(t))?te:Ee.A,onRun:e=>{const t=e.get(B.kY),{dispatch:n,state:i}=t;Pe(ve.Ay.type(e),{language:"LaTex"})(i,n)}}),null==(ne=null==t?void 0:t.buildMenu)||ne.call(t,se);let ce=se.build();e&&(ce=ce.map((t=>{const n=t.items.filter((t=>t.label.toLowerCase().includes(e.toLowerCase())));return{...t,items:n}})).filter((e=>e.items.length>0)));const de=ce.flatMap((e=>e.items));return de.forEach(((e,t)=>{Object.assign(e,{index:t})})),ce.reduce(((e,t)=>{const n=e+t.items.length;return Object.assign(t,{range:[e,n]}),n}),0),{groups:ce,size:de.length}}(o,l,i)),[o]),r=(0,Ie.KT)(),[c,d]=(0,Ie.J0)(0),u=(0,Ie.Kr)((()=>r.current.getRootNode()),[r]),h=(0,Ie.li)({x:-999,y:-999}),p=(0,Ie.hb)((e=>{const t=h.current;if(!t)return;const{x:n,y:i}=e;t.x=n,t.y=i}),[]);(0,Ie.vJ)((()=>{0===s&&t?null==n||n():c>=s&&d(0)}),[s,t]);const m=(0,Ie.hb)(((e,t)=>{d((n=>{const i="function"===typeof e?e(n):e;return null==t||t(i),i}))}),[]),v=(0,Ie.hb)((e=>{const t=r.current.querySelector(`[data-index="${e}"]`),n=r.current.querySelector(".menu-groups");t&&n&&(n.scrollTop=t.offsetTop-n.offsetTop)}),[]),g=(0,Ie.hb)((e=>{const t=a.flatMap((e=>e.items)).at(e);t&&i&&t.onRun(i),null==n||n()}),[a]),f=(0,Ie.hb)((e=>"Escape"===e.key?(e.preventDefault(),void(null==n||n())):"ArrowDown"===e.key?(e.preventDefault(),m((e=>e<s-1?e+1:e),v)):"ArrowUp"===e.key?(e.preventDefault(),m((e=>e<=0?e:e-1),v)):"ArrowLeft"===e.key?(e.preventDefault(),m((e=>{const t=a.find((t=>t.range[0]<=e&&t.range[1]>e));if(!t)return e;const n=a[a.indexOf(t)-1];return n?n.range[1]-1:e}),v)):"ArrowRight"===e.key?(e.preventDefault(),m((e=>{const t=a.find((t=>t.range[0]<=e&&t.range[1]>e));if(!t)return e;const n=a[a.indexOf(t)+1];return n?n.range[0]:e}),v)):void("Enter"===e.key&&(e.preventDefault(),g(c)))),[n,a,c]),b=(0,Ie.hb)((e=>t=>{const n=h.current;if(!n)return;const{x:i,y:o}=t;i===n.x&&o===n.y||m(e)}),[]);return(0,Ie.vJ)((()=>(t?u.addEventListener("keydown",f,{capture:!0}):u.removeEventListener("keydown",f,{capture:!0}),()=>{u.removeEventListener("keydown",f,{capture:!0})})),[t,f]),Ie.qy`
    <host onmousedown=${e=>e.preventDefault()}>
      <nav class="tab-group">
        <ul>
          ${a.map((e=>Ie.qy`<li
                key=${e.key}
                onmousedown=${()=>m(e.range[0],v)}
                class=${c>=e.range[0]&&c<e.range[1]?"selected":""}
              >
                ${e.label}
              </li>`))}
        </ul>
      </nav>
      <div class="menu-groups" onmousemove=${p}>
        ${a.map((e=>Ie.qy`
            <div key=${e.key} class="menu-group">
              <h6>${e.label}</h6>
              <ul>
                ${e.items.map((e=>Ie.qy`<li
                      key=${e.key}
                      data-index=${e.index}
                      class=${c===e.index?"hover":""}
                      onmouseenter=${b(e.index)}
                      onmousedown=${()=>{var t;null==(t=r.current.querySelector(`[data-index="${e.index}"]`))||t.classList.add("active")}}
                      onmouseup=${()=>{var t;null==(t=r.current.querySelector(`[data-index="${e.index}"]`))||t.classList.remove("active"),g(e.index)}}
                    >
                      ${e.icon}
                      <span>${e.label}</span>
                    </li>`))}
              </ul>
            </div>
          `))}
      </div>
    </host>
  `};je.props={ctx:Object,config:Object,show:Boolean,filter:String,hide:Function};const Fe=(0,Ie.c)(je);var qe,Ue,_e,ze=e=>{throw TypeError(e)},Je=(e,t,n)=>t.has(e)||ze("Cannot "+n),Ge=(e,t,n)=>(Je(e,t,"read from private field"),n?n.call(e):t.get(e)),Ke=(e,t,n)=>t.has(e)?ze("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Qe=(e,t,n,i)=>(Je(e,t,"write to private field"),t.set(e,n),n);const Ve=function(e){const t=(0,O.Qx)({},`${e}_SLASH_SPEC`),n=(0,O.Gf)((n=>{const i=n.get(t.key);return new R.k_({key:new R.hs(`${e}_SLASH`),...i})})),i=[t,n];return i.key=t.key,i.pluginKey=n.key,t.meta={package:"@milkdown/plugin-slash",displayName:`Ctx<slashSpec>|${e}`},n.meta={package:"@milkdown/plugin-slash",displayName:`Prose<slash>|${e}`},i}("CREPE_MENU"),Ze=(0,O.Qx)({show:()=>{},hide:()=>{}},"menuAPICtx");(0,Ce.d)("milkdown-slash-menu",Fe);class Xe{constructor(e,t,n){Ke(this,qe),Ke(this,Ue),Ke(this,_e,null),this.update=e=>{Ge(this,Ue).update(e)},this.show=e=>{Qe(this,_e,e),Ge(this,qe).filter="",Ge(this,Ue).show()},this.hide=()=>{Qe(this,_e,null),Ge(this,Ue).hide()},this.destroy=()=>{Ge(this,Ue).destroy(),Ge(this,qe).remove()},Qe(this,qe,new Fe),Ge(this,qe).hide=this.hide,Ge(this,qe).ctx=e,Ge(this,qe).config=n;const i=this;Qe(this,Ue,new Me({content:Ge(this,qe),debounce:20,shouldShow(e){if((0,Ce.i)(e.state.selection)||(0,Ce.a)(e.state.selection))return!1;const t=this.getContent(e,(e=>["paragraph","heading"].includes(e.type.name)));if(null==t)return!1;const n=Ge(i,_e);return Ge(i,qe).filter=t.startsWith("/")?t.slice(1):t,"number"===typeof n?e.state.doc.resolve(n).node()===e.state.doc.resolve(e.state.selection.from).node()||(Qe(i,_e,null),!1):!!t.startsWith("/")},offset:10})),Ge(this,Ue).onShow=()=>{Ge(this,qe).show=!0},Ge(this,Ue).onHide=()=>{Ge(this,qe).show=!1},this.update(t),e.set(Ze.key,{show:e=>this.show(e),hide:()=>this.hide()})}}qe=new WeakMap,Ue=new WeakMap,_e=new WeakMap;const et=e=>{let{onAdd:t,addIcon:n,handleIcon:i}=e;const o=(0,Ie.li)();(0,Ie.vJ)((()=>{var e;null==(e=o.current)||e.classList.remove("active")}));return Ie.qy`
    <host>
      <div
        ref=${o}
        onmousedown=${e=>{var t;e.preventDefault(),e.stopPropagation(),null==(t=o.current)||t.classList.add("active")}}
        onmouseup=${e=>{var n;e.preventDefault(),e.stopPropagation(),null==t||t(),null==(n=o.current)||n.classList.remove("active")}}
        class="operation-item"
      >
        ${(null==n?void 0:n())||Ee.B}
      </div>
      <div class="operation-item">${(null==i?void 0:i())||Ee.C}</div>
    </host>
  `};et.props={show:Boolean,onAdd:Function,addIcon:Function,handleIcon:Function};const tt=(0,Ie.c)(et);var nt,it,ot,lt=e=>{throw TypeError(e)},at=(e,t,n)=>t.has(e)||lt("Cannot "+n),st=(e,t,n)=>(at(e,t,"read from private field"),n?n.call(e):t.get(e)),rt=(e,t,n)=>t.has(e)?lt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),ct=(e,t,n,i)=>(at(e,t,"write to private field"),t.set(e,n),n);class dt{constructor(e,t){rt(this,nt),rt(this,it),rt(this,ot),this.update=()=>{st(this,it).update()},this.destroy=()=>{st(this,it).destroy(),st(this,nt).remove()},this.onAdd=()=>{const e=st(this,ot),t=e.get(B.kY);t.hasFocus()||t.focus();const{state:n,dispatch:i}=t,o=st(this,it).active;if(!o)return;const l=o.$pos.pos+o.node.nodeSize;let a=n.tr.insert(l,ve.Wf.type(e).create());a=a.setSelection(R.U3.near(a.doc.resolve(l))),i(a.scrollIntoView()),st(this,it).hide(),e.get(Ze.key).show(a.selection.from)},ct(this,ot,e);const n=new tt;ct(this,nt,n),st(this,nt).onAdd=this.onAdd,st(this,nt).addIcon=null==t?void 0:t.handleAddIcon,st(this,nt).handleIcon=null==t?void 0:t.handleDragIcon,ct(this,it,new ne({ctx:e,content:n,getOffset:()=>16,getPlacement:e=>{let{active:t,blockDom:n}=e;if("heading"===t.node.type.name)return"left";let i=0;t.node.descendants((e=>{i+=e.childCount}));const o=t.el,l=o.getBoundingClientRect(),a=n.getBoundingClientRect(),s=window.getComputedStyle(o),r=Number.parseInt(s.paddingTop,10)||0,c=Number.parseInt(s.paddingBottom,10)||0,d=l.height-r-c,u=a.height;return i>2||u<d?"left-start":"left"}})),this.update()}}nt=new WeakMap,it=new WeakMap,ot=new WeakMap,(0,Ce.d)("milkdown-block-handle",tt);const ut=(e,t)=>{e.config((e=>function(e,t){e.set(z.key,{filterNodes:e=>!(0,A.gi)((e=>["table","blockquote","math_inline"].includes(e.type.name)))(e)}),e.set(ie.key,{view:()=>new dt(e,t)})}(e,t))).config((e=>function(e,t){e.set(Ve.key,{view:n=>new Xe(e,n,t)})}(e,t))).use(Ze).use(ie).use(Ve)}},1517:(e,t,n)=>{"use strict";n.d(t,{YD:()=>$,iH:()=>S,p0:()=>L});var i=n(4478),o=n(5846),l=n(4723),a=n(2420),s=n(9452),r=n(8387),c=Object.defineProperty,d=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,p=(e,t,n)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,m=(e,t)=>{for(var n in t||(t={}))u.call(t,n)&&p(e,n,t[n]);if(d)for(var n of d(t))h.call(t,n)&&p(e,n,t[n]);return e};function v(e,t){return Object.assign(e,{meta:m({package:"@milkdown/components"},t)}),e}var g=Object.defineProperty,f=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable,y=(e,t,n)=>t in e?g(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,w=(e,t)=>{for(var n in t||(t={}))b.call(t,n)&&y(e,n,t[n]);if(f)for(var n of f(t))k.call(t,n)&&y(e,n,t[n]);return e};const M="image-block",$=(0,i.Yh)("image-block",(()=>({inline:!1,group:"block",selectable:!0,draggable:!0,isolating:!0,marks:"",atom:!0,priority:100,attrs:{src:{default:""},caption:{default:""},ratio:{default:1}},parseDOM:[{tag:`img[data-type="${M}"]`,getAttrs:e=>{var t;if(!(e instanceof HTMLElement))throw(0,o.Ik)(e);return{src:e.getAttribute("src")||"",caption:e.getAttribute("caption")||"",ratio:Number(null!=(t=e.getAttribute("ratio"))?t:1)}}}],toDOM:e=>["img",w({"data-type":M},e.attrs)],parseMarkdown:{match:e=>{let{type:t}=e;return"image-block"===t},runner:(e,t,n)=>{const i=t.url,o=t.title;let l=Number(t.alt||1);(Number.isNaN(l)||0===l)&&(l=1),e.addNode(n,{src:i,caption:o,ratio:l})}},toMarkdown:{match:e=>"image-block"===e.type.name,runner:(e,t)=>{e.openNode("paragraph"),e.addNode("image",void 0,void 0,{title:t.attrs.caption,url:t.attrs.src,alt:`${Number.parseFloat(t.attrs.ratio).toFixed(2)}`}),e.closeNode()}}})));function x(e){return(0,l.YR)(e,"paragraph",((e,t,n)=>{var i,o;if(1!==(null==(i=e.children)?void 0:i.length))return;const l=null==(o=e.children)?void 0:o[0];if(!l||"image"!==l.type)return;const{url:a,alt:s,title:r}=l,c={type:"image-block",url:a,alt:s,title:r};n.children.splice(t,1,c)}))}v($.node,{displayName:"NodeSchema<image-block>",group:"ImageBlock"});const C=(0,i.lz)("remark-image-block",(()=>()=>x));v(C.plugin,{displayName:"Remark<remarkImageBlock>",group:"ImageBlock"}),v(C.options,{displayName:"RemarkConfig<remarkImageBlock>",group:"ImageBlock"});const I={imageIcon:()=>"\ud83c\udf0c",captionIcon:()=>"\ud83d\udcac",uploadButton:()=>a.qy`Upload file`,confirmButton:()=>a.qy`Confirm ⏎`,uploadPlaceholderText:"or paste the image link ...",captionPlaceholderText:"Image caption",onUpload:e=>Promise.resolve(URL.createObjectURL(e))},L=(0,i.Qx)(I,"imageBlockConfigCtx");v(L,{displayName:"Config<image-block>",group:"ImageBlock"});let T=0;const W=(0,s.d_)("abcdefg",8),E=e=>{let{src:t="",caption:n="",ratio:i=1,selected:o=!1,readonly:l=!1,setAttr:s,config:c}=e;const d=(0,a.li)(),u=(0,a.li)(),h=(0,a.li)(),[p,m]=(0,a.J0)(n.length>0),[v,g]=(0,a.J0)(0!==t.length),[f]=(0,a.J0)(W()),[b,k]=(0,a.J0)(!1),[y,w]=(0,a.J0)(t);!function(e){let{image:t,resizeHandle:n,ratio:i,setRatio:o,src:l,readonly:s}=e;const r=(0,a.KT)(),c=(0,a.Kr)((()=>r.current.getRootNode()),[r]);(0,a.vJ)((()=>{const e=t.current;e&&(delete e.dataset.origin,delete e.dataset.height,e.style.height="")}),[l]),(0,a.vJ)((()=>{const e=n.current,l=t.current;if(!e||!l)return;const a=e=>{e.preventDefault();const t=l.getBoundingClientRect().top,n=e.clientY-t,i=Number(n<100?100:n).toFixed(2);l.dataset.height=i,l.style.height=`${i}px`},d=()=>{c.removeEventListener("pointermove",a),c.removeEventListener("pointerup",d);const e=Number(l.dataset.origin),t=Number(l.dataset.height),n=Number.parseFloat(Number(t/e).toFixed(2));Number.isNaN(n)||o(n)},u=e=>{s||(e.preventDefault(),c.addEventListener("pointermove",a),c.addEventListener("pointerup",d))},h=e=>{const t=r.current.getBoundingClientRect().width;if(!t)return;const n=e.target,o=n.height,a=n.width,s=a<t?o:t*(o/a),c=(s*i).toFixed(2);l.dataset.origin=s.toFixed(2),l.dataset.height=c,l.style.height=`${c}px`};return l.addEventListener("load",h),e.addEventListener("pointerdown",u),()=>{l.removeEventListener("load",h),e.removeEventListener("pointerdown",u)}}),[])}({image:d,resizeHandle:u,ratio:i,setRatio:e=>null==s?void 0:s("ratio",e),src:t,readonly:l}),(0,a.vJ)((()=>{o||m(n.length>0)}),[o]);const $=()=>{var e,t;null==s||s("src",null!=(t=null==(e=h.current)?void 0:e.value)?t:"")},x=e=>{e.preventDefault(),e.stopPropagation()};return a.qy`<host class=${(0,r.A)(o&&"selected")}>
    <div class=${(0,r.A)("image-edit",t.length>0&&"hidden")}>
      <div class="image-icon">${null==c?void 0:c.imageIcon()}</div>
      <div class=${(0,r.A)("link-importer",b&&"focus")}>
        <input
          ref=${h}
          draggable="true"
          ondragstart=${x}
          disabled=${l}
          class="link-input-area"
          value=${y}
          oninput=${e=>{const t=e.target.value;g(0!==t.length),w(t)}}
          onkeydown=${e=>{"Enter"===e.key&&$()}}
          onfocus=${()=>k(!0)}
          onblur=${()=>k(!1)}
        />
        <div class=${(0,r.A)("placeholder",v&&"hidden")}>
          <input
            disabled=${l}
            class="hidden"
            id=${f}
            type="file"
            accept="image/*"
            onchange=${e=>{return t=void 0,n=null,i=function*(){var t;const n=null==(t=e.target.files)?void 0:t[0];if(!n)return;const i=yield null==c?void 0:c.onUpload(n);i&&(null==s||s("src",i),g(!0))},new Promise(((o,l)=>{var a=t=>{try{r(i.next(t))}catch(e){l(e)}},s=t=>{try{r(i.throw(t))}catch(e){l(e)}},r=e=>e.done?o(e.value):Promise.resolve(e.value).then(a,s);r((i=i.apply(t,n)).next())}));var t,n,i}}
          />
          <label class="uploader" for=${f}>
            ${null==c?void 0:c.uploadButton()}
          </label>
          <span class="text" onclick=${()=>{var e;return null==(e=h.current)?void 0:e.focus()}}>
            ${null==c?void 0:c.uploadPlaceholderText}
          </span>
        </div>
      </div>
      <div
        class=${(0,r.A)("confirm",0===y.length&&"hidden")}
        onclick=${()=>$()}
      >
        ${null==c?void 0:c.confirmButton()}
      </div>
    </div>
    <div class=${(0,r.A)("image-wrapper",0===t.length&&"hidden")}>
      <div class="operation">
        <div class="operation-item" onpointerdown=${e=>{e.preventDefault(),e.stopPropagation(),l||m((e=>!e))}}>
          ${null==c?void 0:c.captionIcon()}
        </div>
      </div>
      <img
        ref=${d}
        data-type=${M}
        src=${t}
        alt=${n}
        ratio=${i}
      />
      <div ref=${u} class="image-resize-handle"></div>
    </div>
    <input
      draggable="true"
      ondragstart=${x}
      class=${(0,r.A)("caption-input",!p&&"hidden")}
      placeholder=${null==c?void 0:c.captionPlaceholderText}
      oninput=${e=>{const t=e.target.value;T&&window.clearTimeout(T),T=window.setTimeout((()=>{null==s||s("caption",t)}),1e3)}}
      onblur=${e=>{const t=e.target.value;T&&(window.clearTimeout(T),T=0),null==s||s("caption",t)}}
      value=${n}
    />
  </host>`};E.props={src:String,caption:String,ratio:Number,selected:Boolean,readonly:Boolean,setAttr:Function,config:Object};!function(e,t){const n=customElements.get(e);null!=n?n!==t&&console.warn(`Custom element ${e} has been defined before.`):customElements.define(e,t)}("milkdown-image-block",(0,a.c)(E));const N=(0,i.m5)($.node,(e=>(t,n,i)=>{const o=document.createElement("milkdown-image-block"),l=e.get(L.key),a=l.proxyDomURL,s=e=>{if(a){const t=a(e.attrs.src);"string"===typeof t?o.src=t:t.then((e=>{o.src=e}))}else o.src=e.attrs.src;o.ratio=e.attrs.ratio,o.caption=e.attrs.caption,o.readonly=!n.editable};return s(t),o.selected=!1,o.setAttr=(e,t)=>{const o=i();null!=o&&n.dispatch(n.state.tr.setNodeAttribute(o,e,t))},o.config=l,{dom:o,update:e=>e.type===t.type&&(s(e),!0),stopEvent:e=>e.target instanceof HTMLInputElement,selectNode:()=>{o.selected=!0},deselectNode:()=>{o.selected=!1},destroy:()=>{o.remove()}}}));v(N,{displayName:"NodeView<image-block>",group:"ImageBlock"});const S=[C,$,N,L].flat()},4931:(e,t,n)=>{"use strict";function i(e){return"code_block"===e.$from.parent.type.name}function o(e){var t;const n=null==(t=e.$from.node(e.$from.depth-1))?void 0:t.type;return"list_item"===(null==n?void 0:n.name)}function l(e,t){null==customElements.get(e)&&customElements.define(e,t)}n.d(t,{a:()=>o,d:()=>l,i:()=>i})}}]);
//# sourceMappingURL=1070.3e6467e4.chunk.js.map