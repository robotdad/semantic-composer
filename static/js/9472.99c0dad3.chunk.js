(self.webpackChunksemantic_composer=self.webpackChunksemantic_composer||[]).push([[9472],{381:(t,e,n)=>{var i="Expected a function",o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt,c="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,h="object"==typeof self&&self&&self.Object===Object&&self,p=c||h||Function("return this")(),u=Object.prototype.toString,d=Math.max,f=Math.min,m=function(){return p.Date.now()};function k(t,e,n){var o,s,r,a,l,c,h=0,p=!1,u=!1,k=!0;if("function"!=typeof t)throw new TypeError(i);function w(e){var n=o,i=s;return o=s=void 0,h=e,a=t.apply(i,n)}function g(t){var n=t-c;return void 0===c||n>=e||n<0||u&&t-h>=r}function b(){var t=m();if(g(t))return O(t);l=setTimeout(b,function(t){var n=e-(t-c);return u?f(n,r-(t-h)):n}(t))}function O(t){return l=void 0,k&&o?w(t):(o=s=void 0,a)}function x(){var t=m(),n=g(t);if(o=arguments,s=this,c=t,n){if(void 0===l)return function(t){return h=t,l=setTimeout(b,e),p?w(t):a}(c);if(u)return l=setTimeout(b,e),w(c)}return void 0===l&&(l=setTimeout(b,e)),a}return e=y(e)||0,v(n)&&(p=!!n.leading,r=(u="maxWait"in n)?d(y(n.maxWait)||0,e):r,k="trailing"in n?!!n.trailing:k),x.cancel=function(){void 0!==l&&clearTimeout(l),h=0,o=c=s=l=void 0},x.flush=function(){return void 0===l?a:O(m())},x}function v(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function y(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==u.call(t)}(t))return NaN;if(v(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=v(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var n=r.test(t);return n||a.test(t)?l(t.slice(2),n?2:8):s.test(t)?NaN:+t}t.exports=function(t,e,n){var o=!0,s=!0;if("function"!=typeof t)throw new TypeError(i);return v(n)&&(o="leading"in n?!!n.leading:o,s="trailing"in n?!!n.trailing:s),k(t,e,{leading:o,maxWait:e,trailing:s})}},2572:(t,e,n)=>{"use strict";n.d(e,{GN:()=>Lt,Q3:()=>M,e7:()=>L,h1:()=>Tt});var i=n(4478),o=n(2420),s=n(7472),r=n(446),a=n(616),l=n(9118),c=n(8387),h=n(7184),p=n(1310),u=Object.defineProperty,d=Object.getOwnPropertySymbols,f=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,k=(t,e,n)=>e in t?u(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,v=(t,e)=>{for(var n in e||(e={}))f.call(e,n)&&k(t,n,e[n]);if(d)for(var n of d(e))m.call(e,n)&&k(t,n,e[n]);return t};function y(t,e){return Object.assign(t,{meta:v({package:"@milkdown/components"},e)}),t}var w=Object.defineProperty,g=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,x=(t,e,n)=>e in t?w(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,P=(t,e)=>{for(var n in e||(e={}))b.call(e,n)&&x(t,n,e[n]);if(g)for(var n of g(e))O.call(e,n)&&x(t,n,e[n]);return t};const j=(0,i.Qx)(P({},{mode:"preview"}),"linkTooltipStateCtx");y(j,{displayName:"State<link-tooltip>",group:"LinkTooltip"});const M=(0,i.Qx)(P({},{addLink:()=>{},editLink:()=>{},removeLink:()=>{}}),"linkTooltipAPICtx");y(j,{displayName:"API<link-tooltip>",group:"LinkTooltip"});const C={linkIcon:()=>"\ud83d\udd17",editButton:()=>"\u270e",removeButton:()=>"\u232b",confirmButton:()=>o.qy`Confirm ⏎`,onCopyLink:()=>{},inputPlaceholder:"Paste link..."},L=(0,i.Qx)(P({},C),"linkTooltipConfigCtx");y(j,{displayName:"Config<link-tooltip>",group:"LinkTooltip"});const T=(0,s.y)("LINK_PREVIEW");y(T[0],{displayName:"PreviewTooltipSpec<link-tooltip>",group:"LinkTooltip"}),y(T[1],{displayName:"PreviewTooltipPlugin<link-tooltip>",group:"LinkTooltip"});const $=(0,s.y)("LINK_EDIT");function E(t,e){const n=customElements.get(t);null!=n?n!==e&&console.warn(`Custom element ${t} has been defined before.`):customElements.define(t,e)}y($[0],{displayName:"EditTooltipSpec<link-tooltip>",group:"LinkTooltip"}),y($[1],{displayName:"EditTooltipPlugin<link-tooltip>",group:"LinkTooltip"});const W=t=>{let{config:e,src:n,onEdit:i,onRemove:s}=t;return o.qy`
    <host>
      <div class="link-preview" onmousedown=${t=>{t.preventDefault(),navigator.clipboard&&n&&navigator.clipboard.writeText(n).then((()=>{null==e||e.onCopyLink(n)})).catch((t=>{throw t}))}}>
        <span class="link-icon"> ${null==e?void 0:e.linkIcon()} </span>
        <a href=${n} target="_blank" class="link-display">${n}</a>
        <span class="button link-edit-button" onmousedown=${t=>{t.stopPropagation(),t.preventDefault(),null==i||i()}}>
          ${null==e?void 0:e.editButton()}
        </span>
        <span
          class="button link-remove-button"
          onmousedown=${t=>{t.stopPropagation(),t.preventDefault(),null==s||s()}}
        >
          ${null==e?void 0:e.removeButton()}
        </span>
      </div>
    </host>
  `};W.props={config:Object,src:String,onEdit:Function,onRemove:Function};const S=(0,o.c)(W);var B,I,N,D,F,Y,_,U,q=t=>{throw TypeError(t)},R=(t,e,n)=>e.has(t)||q("Cannot "+n),A=(t,e,n)=>(R(t,e,"read from private field"),n?n.call(t):e.get(t)),G=(t,e,n)=>e.has(t)?q("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Q=(t,e,n,i)=>(R(t,e,"write to private field"),e.set(t,n),n);class K{constructor(t,e){this.ctx=t,G(this,B,new S),G(this,I),G(this,N,this.ctx.use(j.key)),G(this,D,!1),G(this,F,(t=>{let{mode:e}=t;"edit"===e&&A(this,U).call(this)})),G(this,Y,(()=>{Q(this,D,!0)})),G(this,_,(()=>{Q(this,D,!1)})),G(this,U,(()=>{A(this,I).hide(),A(this,I).element.removeEventListener("mouseenter",A(this,Y)),A(this,I).element.removeEventListener("mouseleave",A(this,_))})),this.show=(t,e,n,i)=>{A(this,B).config=this.ctx.get(L.key),A(this,B).src=t.attrs.href,A(this,B).onEdit=()=>{this.ctx.get(M.key).editLink(t,e,n)},A(this,B).onRemove=()=>{this.ctx.get(M.key).removeLink(e,n),A(this,U).call(this)},A(this,I).show({getBoundingClientRect:()=>i}),A(this,I).element.addEventListener("mouseenter",A(this,Y)),A(this,I).element.addEventListener("mouseleave",A(this,_))},this.hide=()=>{A(this,D)||A(this,U).call(this)},this.update=()=>{},this.destroy=()=>{A(this,N).off(A(this,F)),A(this,I).destroy(),A(this,B).remove()},Q(this,I,new s.B({debounce:0,content:A(this,B),shouldShow:()=>!1})),A(this,I).update(e),Q(this,N,t.use(j.key)),A(this,N).on(A(this,F))}}function H(t){let e;const n=r(((n,i)=>{if(!e)return;if(!n.hasFocus())return;if("edit"===t.get(j.key).mode)return;const o=function(t,e,n){const i=e.posAtCoords({left:n.clientX,top:n.clientY});if(!i)return;const{pos:o}=i,s=e.state.doc.nodeAt(o);if(!s)return;const r=s.marks.find((e=>e.type===l.Yk.mark.type(t)));if(!r)return;return T.pluginKey()?{show:!0,pos:o,node:s,mark:r}:void 0}(t,n,i);if(o){const t=n.state.doc.resolve(o.pos),i=function(t,e,n,i,o){let s={start:-1,end:-1};return n.nodesBetween(i,o,((n,i)=>{if(s.start>-1)return!1;-1===s.start&&t.isInSet(n.marks)&&e===n&&(s={start:i,end:i+Math.max(n.textContent.length,1)})})),s}(o.mark,o.node,n.state.doc,t.before(),t.after()),s=i.start,r=i.end;e.show(o.mark,s,r,(0,a.MG)(n,s,r))}else e.hide()}),200);t.set(T.key,{props:{handleDOMEvents:{mousemove:n,mouseleave:()=>{setTimeout((()=>{null==e||e.hide()}),200)}}},view:n=>(e=new K(t,n),e)})}B=new WeakMap,I=new WeakMap,N=new WeakMap,D=new WeakMap,F=new WeakMap,Y=new WeakMap,_=new WeakMap,U=new WeakMap,E("milkdown-link-preview",S);const J=t=>{let{src:e,onConfirm:n,onCancel:i,config:s}=t;const r=(0,o.li)(),[a,l]=(0,o.J0)(e);(0,o.vJ)((()=>{l(null!=e?e:"")}),[e]);return o.qy`
    <host>
      <div class="link-edit">
        <input
          class="input-area"
          placeholder=${null==s?void 0:s.inputPlaceholder}
          ref=${r}
          onkeydown=${t=>{var e,o;t.stopPropagation(),"Enter"===t.key&&(null==n||n(null!=(o=null==(e=r.current)?void 0:e.value)?o:""),t.preventDefault()),"Escape"===t.key&&(null==i||i(),t.preventDefault())}}
          oninput=${t=>l(t.target.value)}
          value=${a}
        />
        <span
          class=${(0,c.A)("button confirm",!a&&"hidden")}
          onclick=${()=>{var t,e;null==n||n(null!=(e=null==(t=r.current)?void 0:t.value)?e:"")}}
        >
          ${null==s?void 0:s.confirmButton()}
        </span>
      </div>
    </host>
  `};J.props={config:Object,src:String,onConfirm:Function,onCancel:Function};const V=(0,o.c)(J);var X,z,Z,tt,et,nt,it=Object.defineProperty,ot=Object.defineProperties,st=Object.getOwnPropertyDescriptors,rt=Object.getOwnPropertySymbols,at=Object.prototype.hasOwnProperty,lt=Object.prototype.propertyIsEnumerable,ct=t=>{throw TypeError(t)},ht=(t,e,n)=>e in t?it(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pt=(t,e)=>{for(var n in e||(e={}))at.call(e,n)&&ht(t,n,e[n]);if(rt)for(var n of rt(e))lt.call(e,n)&&ht(t,n,e[n]);return t},ut=(t,e)=>ot(t,st(e)),dt=(t,e,n)=>e.has(t)||ct("Cannot "+n),ft=(t,e,n)=>(dt(t,e,"read from private field"),n?n.call(t):e.get(t)),mt=(t,e,n)=>e.has(t)?ct("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),kt=(t,e,n,i)=>(dt(t,e,"write to private field"),e.set(t,n),n);const vt={from:-1,to:-1,mark:null};class yt{constructor(t,e){this.ctx=t,mt(this,X,new V),mt(this,z),mt(this,Z,pt({},vt)),mt(this,tt,(()=>{ft(this,z).hide(),this.ctx.update(j.key,(t=>ut(pt({},t),{mode:"preview"}))),kt(this,Z,pt({},vt))})),mt(this,et,(t=>{const e=this.ctx.get(p.kY),{from:n,to:i,mark:o}=ft(this,Z),s=l.Yk.type(this.ctx);if(o&&o.attrs.href===t)return void ft(this,tt).call(this);const r=e.state.tr;o&&r.removeMark(n,i,o),r.addMark(n,i,s.create({href:t})),e.dispatch(r),ft(this,tt).call(this)})),mt(this,nt,((t,e,n)=>{const i=this.ctx.get(L.key);ft(this,X).config=i,ft(this,X).src=t,this.ctx.update(j.key,(t=>ut(pt({},t),{mode:"edit"})));const o=this.ctx.get(p.kY);o.dispatch(o.state.tr.setSelection(h.U3.create(o.state.doc,e,n))),ft(this,z).show({getBoundingClientRect:()=>(0,a.MG)(o,e,n)}),requestAnimationFrame((()=>{var t;null==(t=ft(this,X).querySelector("input"))||t.focus()}))})),this.update=t=>{const{state:e}=t,{selection:n}=e;if(!(n instanceof h.U3))return;const{from:i,to:o}=n;i===ft(this,Z).from&&o===ft(this,Z).to||ft(this,tt).call(this)},this.destroy=()=>{ft(this,z).destroy(),ft(this,X).remove()},this.addLink=(t,e)=>{kt(this,Z,{from:t,to:e,mark:null}),ft(this,nt).call(this,"",t,e)},this.editLink=(t,e,n)=>{kt(this,Z,{from:e,to:n,mark:t}),ft(this,nt).call(this,t.attrs.href,e,n)},this.removeLink=(t,e)=>{const n=this.ctx.get(p.kY),i=n.state.tr;i.removeMark(t,e,l.Yk.type(this.ctx)),n.dispatch(i),ft(this,tt).call(this)},kt(this,z,new s.B({content:ft(this,X),debounce:0,shouldShow:()=>!1})),ft(this,z).onHide=()=>{ft(this,X).update().catch((t=>{throw t})),e.dom.focus({preventScroll:!0})},ft(this,z).update(e),ft(this,X).onConfirm=ft(this,et),ft(this,X).onCancel=ft(this,tt)}}X=new WeakMap,z=new WeakMap,Z=new WeakMap,tt=new WeakMap,et=new WeakMap,nt=new WeakMap;var wt=Object.defineProperty,gt=Object.defineProperties,bt=Object.getOwnPropertyDescriptors,Ot=Object.getOwnPropertySymbols,xt=Object.prototype.hasOwnProperty,Pt=Object.prototype.propertyIsEnumerable,jt=(t,e,n)=>e in t?wt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Mt=(t,e)=>{for(var n in e||(e={}))xt.call(e,n)&&jt(t,n,e[n]);if(Ot)for(var n of Ot(e))Pt.call(e,n)&&jt(t,n,e[n]);return t},Ct=(t,e)=>gt(t,bt(e));function Lt(t){H(t),function(t){let e;t.update(M.key,(t=>Ct(Mt({},t),{addLink:(t,n)=>{null==e||e.addLink(t,n)},editLink:(t,n,i)=>{null==e||e.editLink(t,n,i)},removeLink:(t,n)=>{null==e||e.removeLink(t,n)}}))),t.set($.key,{view:n=>(e=new yt(t,n),e)})}(t)}E("milkdown-link-edit",V);const Tt=[j,M,L,T,$].flat()},7472:(t,e,n)=>{"use strict";n.d(e,{B:()=>x,y:()=>P});var i,o,s,r,a,l,c,h,p,u,d=n(7184),f=n(381),m=n(6667),k=n(616),v=n(4478),y=t=>{throw TypeError(t)},w=(t,e,n)=>e.has(t)||y("Cannot "+n),g=(t,e,n)=>(w(t,e,"read from private field"),n?n.call(t):e.get(t)),b=(t,e,n)=>e.has(t)?y("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),O=(t,e,n,i)=>(w(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n);class x{constructor(t){var e;b(this,p),b(this,i),b(this,o),b(this,s),b(this,r),b(this,a),b(this,l),b(this,c),b(this,h),O(this,l,!1),this.onShow=()=>{},this.onHide=()=>{},O(this,h,((t,e)=>{const{state:n,composing:i}=t,{selection:h,doc:p}=n,{ranges:u}=h,d=Math.min(...u.map((t=>t.$from.pos))),f=Math.max(...u.map((t=>t.$to.pos))),v=e&&e.doc.eq(p)&&e.selection.eq(h);if(!g(this,l)){(g(this,a)??t.dom.parentElement??document.body).appendChild(this.element),O(this,l,!0)}if(i||v)return;if(!g(this,o).call(this,t,e))return void this.hide();const y={getBoundingClientRect:()=>(0,k.MG)(t,d,f)};(0,m.rD)(y,this.element,{placement:g(this,r).placement??"top",middleware:[(0,m.UU)(),(0,m.cY)(g(this,c)),(0,m.BN)(),...g(this,s)]}).then((t=>{let{x:e,y:n}=t;Object.assign(this.element.style,{left:`${e}px`,top:`${n}px`})})),this.show()})),this.update=(t,e)=>{f(g(this,h),g(this,i))(t,e)},this.destroy=()=>{},this.show=t=>{this.element.dataset.show="true",t&&(0,m.rD)(t,this.element,{placement:"top",middleware:[(0,m.UU)(),(0,m.cY)(g(this,c))],...g(this,r)}).then((t=>{let{x:e,y:n}=t;Object.assign(this.element.style,{left:`${e}px`,top:`${n}px`})})),this.onShow()},this.hide=()=>{"false"!==this.element.dataset.show&&(this.element.dataset.show="false",this.onHide())},this.element=t.content,O(this,i,t.debounce??200),O(this,o,t.shouldShow??(e=u,w(this,p,"access private method"),e)),O(this,c,t.offset),O(this,s,t.middleware??[]),O(this,r,t.floatingUIOptions??{}),O(this,a,t.root),this.element.dataset.show="false"}}function P(t){const e=(0,v.Qx)({},`${t}_TOOLTIP_SPEC`),n=(0,v.Gf)((n=>{const i=n.get(e.key);return new d.k_({key:new d.hs(`${t}_TOOLTIP`),...i})})),i=[e,n];return i.key=e.key,i.pluginKey=n.key,e.meta={package:"@milkdown/plugin-tooltip",displayName:`Ctx<tooltipSpec>|${t}`},n.meta={package:"@milkdown/plugin-tooltip",displayName:`Prose<tooltip>|${t}`},i}i=new WeakMap,o=new WeakMap,s=new WeakMap,r=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,h=new WeakMap,p=new WeakSet,u=function(t){const{doc:e,selection:n}=t.state,{empty:i,from:o,to:s}=n,r=!e.textBetween(o,s).length&&t.state.selection instanceof d.U3,a=this.element.contains(document.activeElement),l=!t.hasFocus()&&!a,c=!t.editable;return!(l||i||r||c)}},9472:(t,e,n)=>{"use strict";n.d(e,{defineFeature:()=>s});var i=n(2572),o=n(7511);n(2420);const s=(t,e)=>{t.config(i.GN).config((t=>{t.update(i.e7.key,(t=>{var n,i,s,r,a,l;return{...t,linkIcon:null!=(n=null==e?void 0:e.linkIcon)?n:()=>o.h,editButton:null!=(i=null==e?void 0:e.editButton)?i:()=>o.e,removeButton:null!=(s=null==e?void 0:e.removeButton)?s:()=>o.r,confirmButton:null!=(r=null==e?void 0:e.confirmButton)?r:()=>o.g,inputPlaceholder:null!=(a=null==e?void 0:e.inputPlaceholder)?a:"Paste link...",onCopyLink:null!=(l=null==e?void 0:e.onCopyLink)?l:()=>{}}}))})).use(i.h1)}}}]);
//# sourceMappingURL=9472.99c0dad3.chunk.js.map