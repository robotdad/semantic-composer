{"version":3,"file":"static/js/1070.3e6467e4.chunk.js","mappings":"wGAUA,IAAIA,EAAkB,sBASlBC,EAAS,aAGTC,EAAa,qBAGbC,EAAa,aAGbC,EAAY,cAGZC,EAAeC,SAGfC,EAA8B,iBAAVC,EAAAA,GAAsBA,EAAAA,GAAUA,EAAAA,EAAOC,SAAWA,QAAUD,EAAAA,EAGhFE,EAA0B,iBAARC,MAAoBA,MAAQA,KAAKF,SAAWA,QAAUE,KAGxEC,EAAOL,GAAcG,GAAYG,SAAS,cAATA,GAUjCC,EAPcL,OAAOM,UAOQC,SAG7BC,EAAYC,KAAKC,IACjBC,EAAYF,KAAKG,IAkBjBC,EAAM,WACR,OAAOV,EAAKW,KAAKD,KACnB,EAwDA,SAASE,EAASC,EAAMC,EAAMC,GAC5B,IAAIC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAAiB,EACjBC,GAAU,EACVC,GAAS,EACTC,GAAW,EAEf,GAAmB,mBAARZ,EACT,MAAM,IAAIa,UAAUtC,GAUtB,SAASuC,EAAWC,GAClB,IAAIC,EAAOb,EACPc,EAAUb,EAKd,OAHAD,EAAWC,OAAWc,EACtBT,EAAiBM,EACjBT,EAASN,EAAKmB,MAAMF,EAASD,EAE/B,CAmBA,SAASI,EAAaL,GACpB,IAAIM,EAAoBN,EAAOP,EAM/B,YAAyBU,IAAjBV,GAA+Ba,GAAqBpB,GACzDoB,EAAoB,GAAOV,GANJI,EAAON,GAM8BJ,CACjE,CAEA,SAASiB,IACP,IAAIP,EAAOlB,IACX,GAAIuB,EAAaL,GACf,OAAOQ,EAAaR,GAGtBR,EAAUiB,WAAWF,EAzBvB,SAAuBP,GACrB,IAEIT,EAASL,GAFWc,EAAOP,GAI/B,OAAOG,EAAShB,EAAUW,EAAQD,GAHRU,EAAON,IAGkCH,CACrE,CAmBqCmB,CAAcV,GACnD,CAEA,SAASQ,EAAaR,GAKpB,OAJAR,OAAUW,EAINN,GAAYT,EACPW,EAAWC,IAEpBZ,EAAWC,OAAWc,EACfZ,EACT,CAcA,SAASoB,IACP,IAAIX,EAAOlB,IACP8B,EAAaP,EAAaL,GAM9B,GAJAZ,EAAWyB,UACXxB,EAAWyB,KACXrB,EAAeO,EAEXY,EAAY,CACd,QAAgBT,IAAZX,EACF,OAvEN,SAAqBQ,GAMnB,OAJAN,EAAiBM,EAEjBR,EAAUiB,WAAWF,EAAcrB,GAE5BS,EAAUI,EAAWC,GAAQT,CACtC,CAgEawB,CAAYtB,GAErB,GAAIG,EAGF,OADAJ,EAAUiB,WAAWF,EAAcrB,GAC5Ba,EAAWN,EAEtB,CAIA,YAHgBU,IAAZX,IACFA,EAAUiB,WAAWF,EAAcrB,IAE9BK,CACT,CAGA,OAxGAL,EAAO8B,EAAS9B,IAAS,EACrB+B,EAAS9B,KACXQ,IAAYR,EAAQQ,QAEpBL,GADAM,EAAS,YAAaT,GACHV,EAAUuC,EAAS7B,EAAQG,UAAY,EAAGJ,GAAQI,EACrEO,EAAW,aAAcV,IAAYA,EAAQU,SAAWA,GAiG1Dc,EAAUO,OAnCV,gBACkBf,IAAZX,GACF2B,aAAa3B,GAEfE,EAAiB,EACjBN,EAAWK,EAAeJ,EAAWG,OAAUW,CACjD,EA8BAQ,EAAUS,MA5BV,WACE,YAAmBjB,IAAZX,EAAwBD,EAASiB,EAAa1B,IACvD,EA2BO6B,CACT,CAyFA,SAASM,EAASI,GAChB,IAAIC,SAAcD,EAClB,QAASA,IAAkB,UAARC,GAA4B,YAARA,EACzC,CA2EA,SAASN,EAASK,GAChB,GAAoB,iBAATA,EACT,OAAOA,EAET,GAhCF,SAAkBA,GAChB,MAAuB,iBAATA,GAtBhB,SAAsBA,GACpB,QAASA,GAAyB,iBAATA,CAC3B,CAqBKE,CAAaF,IAvXF,mBAuXY/C,EAAekD,KAAKH,EAChD,CA6BMI,CAASJ,GACX,OAzZM,IA2ZR,GAAIJ,EAASI,GAAQ,CACnB,IAAIK,EAAgC,mBAAjBL,EAAMM,QAAwBN,EAAMM,UAAYN,EACnEA,EAAQJ,EAASS,GAAUA,EAAQ,GAAMA,CAC3C,CACA,GAAoB,iBAATL,EACT,OAAiB,IAAVA,EAAcA,GAASA,EAEhCA,EAAQA,EAAMO,QAAQnE,EAAQ,IAC9B,IAAIoE,EAAWlE,EAAWmE,KAAKT,GAC/B,OAAQQ,GAAYjE,EAAUkE,KAAKT,GAC/BxD,EAAawD,EAAMU,MAAM,GAAIF,EAAW,EAAI,GAC3CnE,EAAWoE,KAAKT,GAtab,KAsa6BA,CACvC,CAEAW,EAAOC,QA9IP,SAAkBhD,EAAMC,EAAMC,GAC5B,IAAIQ,GAAU,EACVE,GAAW,EAEf,GAAmB,mBAARZ,EACT,MAAM,IAAIa,UAAUtC,GAMtB,OAJIyD,EAAS9B,KACXQ,EAAU,YAAaR,IAAYA,EAAQQ,QAAUA,EACrDE,EAAW,aAAcV,IAAYA,EAAQU,SAAWA,GAEnDb,EAASC,EAAMC,EAAM,CAC1B,QAAWS,EACX,QAAWT,EACX,SAAYW,GAEhB,C,+fCtTgB,SAAAqC,EACdC,EACAC,GASO,OAPPnE,OAAOoE,OAAOF,EAAQ,CACpBC,KAAM,CACJE,QAAS,4BACNF,KAIAD,CACT,CCJa,MAUAI,GAAcC,EAAAA,EAAAA,IACzB,CAAEC,YAX2CC,KAC/BC,EAAAA,EAAAA,KAAYC,GAA4B,UAAnBA,EAAKtB,KAAKuB,MAA/BF,CAAiDD,IAW/D,eAGFR,EAASK,EAAa,CACpBO,YAAa,qBClBf,IAAIC,EAAgC,KAQpC,MAAMC,EAAwC,CAC5CC,MAAO,CAAC,SACRC,MAAO,CAAC,SACRC,MAAO,CAAC,SACRC,QAAS,CAAC,SACVC,SAAU,CAAC,SACXC,IAAK,CAAC,QAAS,YACfC,GAAI,CAAC,QAAS,SACdC,GAAI,CAAC,QAAS,QAAS,MACvBC,GAAI,CAAC,QAAS,QAAS,OAGT,SAAAC,EAAsBC,EAAkB5B,GACtD,MAAM6B,EAAU,GAChB,IAAI,UAAEC,EAAA,QAAWC,EAAA,QAASC,GAAYhC,EAEpC,KAAA8B,EAAY,GACZC,EAAU,GACa,IAAvBC,EAAQC,YAC2B,IAAnCD,EAAQE,WAAYD,YACpB,CACaH,GAAA,EACFC,GAAA,EACX,MAAMlB,EAAOmB,EAAQE,WACbL,EAAAM,KACNtB,EAAKtB,KAAKuB,KACVD,EAAKuB,QACFvB,EAAKtB,KAA8C8C,aAClDxB,EAAKuB,MACL,MAENJ,EAAUnB,EAAKmB,OAAA,CAGX,MAAAM,EACJV,EAAKW,SAAS,wBACdC,EAAAA,GAAcC,WAAWb,EAAKc,MAAMC,QAChCC,EA1CJ5B,IACCA,EAAe6B,SAASC,eAAeC,mBAAmB,UA0CvDC,EAAOJ,EAAIK,cAAc,OAC1BD,EAAAE,YAAYZ,EAAWa,kBAAkBnB,EAAS,CAAEa,SAAUD,KAEnE,IACIQ,EADAlB,EAAac,EAAKd,WAElBmB,EAAW,EAEb,KAAAnB,GACwB,IAAxBA,EAAWoB,WACVF,EAAYnC,EAAQiB,EAAWqB,SAASC,iBACzC,CACA,IAAK,IAAIC,EAAIL,EAAUM,OAAS,EAAGD,GAAK,EAAGA,IAAK,CAC9C,MAAME,EAAUf,EAAIK,cAAcG,EAAUK,IAC5C,KAAOT,EAAKd,YAAoByB,EAAAT,YAAYF,EAAKd,YACjDc,EAAKE,YAAYS,GACjBN,GAAA,CAEFnB,EAAac,EAAKd,UAAA,CAGhBA,GAAsC,IAAxBA,EAAWoB,UACzBpB,EAA2B0B,aAC3B,gBACA,GAAG9B,KAAaC,IAAUsB,EAAW,KAAKA,IAAa,MAAMQ,KAAKC,UAAUjC,MAQzE,OAAEkC,IAAKf,EAAMgB,KAHlBpC,EAAKW,SAAS,2BAA4B0B,GAAMA,EAAEjE,EAAO4B,MACzD5B,EAAMgC,QAAQkC,YAAY,EAAGlE,EAAMgC,QAAQmC,KAAM,QAGrD,CCxEA,MAAMC,EACHC,EAAAA,EAAQC,IAAcD,EAAAA,EAAQE,WAAa,IAC3CF,EAAAA,EAAQG,KAAOH,EAAAA,EAAQI,eAAiB,IAoBpC,MAAMC,EAANC,WAAAA,GAAAC,EAAA,KAAAC,GAELD,EAAA,KAAAE,GAGAF,EAAA,KAAAG,GAmBAH,EAAA,KAAAI,GAEAJ,EAAA,KAAAK,GAEAL,EAAA,KAAAM,GAGAN,EAAA,KAAAO,GAaAP,EAAA,KAAAQ,GAGAR,EAAA,KAAAS,GAMAT,EAAA,KAAAU,GA+BAV,EAAA,KAAAW,GAMAX,EAAA,KAAAY,GAcAZ,EAAA,KAAAa,GAsCAb,EAAA,KAAAc,GAkGAd,EAAA,KAAAe,GA3OAC,EAAA,KAAAb,GAA2C,KACrC,IAACc,EAAA9G,KAAKkG,GAAgB,YAC1B,MAAMzH,EAASqI,EAAA9G,KAAKkG,GACdrD,EAAOiE,EAAA9G,KAAK8F,EAAAiB,GAElB,GAAIlE,GAAQmE,EAAAA,GAAcC,aAAaxI,EAAOqD,MAAO,CACnD,MAAMoF,EAAgBF,EAAAA,GAAcG,OAClCtE,EAAKc,MAAME,IACXpF,EAAO2I,KAAKxF,KAKP,OAHPiB,EAAKwE,SAASxE,EAAKc,MAAMlB,GAAG6E,aAAaJ,IACzCrE,EAAK0E,QACLV,EAAA7G,KAAKiG,EAAmBiB,GACjBA,CAAA,CAEF,eAI4BL,EAAA,KAAAZ,EAAA,MAERY,EAAA,KAAAX,EAAA,MAESW,EAAA,KAAAV,OAAA,GAG1BU,EAAA,KAAAT,GAAA,GAgBZS,EAAA,KAAAP,GAAQ,K,MACN,OAAAkB,EAAAV,EAAA9G,KAAKqG,KAALmB,EAAA9G,KAAAV,KAAe,CAAEQ,KAAM,SACvBqG,EAAA7G,KAAKkG,EAAU,SAIjBW,EAAA,KAAAN,GAASkB,I,MACPZ,EAAA7G,KAAKkG,EAAUuB,GACf,OAAAD,EAAAV,EAAA9G,KAAKqG,KAALmB,EAAA9G,KAAAV,KAAe,CAAEQ,KAAM,OAAQiH,UAAA,IAI1B,KAAAC,KAAA,CAACC,EAAUC,KAChBf,EAAA7G,KAAK+F,EAAO4B,GACZd,EAAA7G,KAAKqG,EAAUuB,EAAA,EAIjB,KAAAC,SAAY7C,IACNA,EAAA8C,iBAAiB,YAAahB,EAAA9G,KAAKwG,IACnCxB,EAAA8C,iBAAiB,UAAWhB,EAAA9G,KAAKyG,IACjCzB,EAAA8C,iBAAiB,YAAahB,EAAA9G,KAAK0G,GAAiB,EAI1D,KAAAqB,YAAe/C,IACTA,EAAAgD,oBAAoB,YAAalB,EAAA9G,KAAKwG,IACtCxB,EAAAgD,oBAAoB,UAAWlB,EAAA9G,KAAKyG,IACpCzB,EAAAgD,oBAAoB,YAAalB,EAAA9G,KAAK0G,GAAiB,EAI7D,KAAAuB,OAAS,KACPpB,EAAA7G,KAAKqG,OAAU,IAIjBQ,EAAA,KAAAL,GAAmB,K,MACjBK,EAAA7G,KAAKmG,EAAiB,OAAAqB,EAAAV,EAAA9G,KAAKkG,SAAL,EAAAsB,EAAcU,GAAGC,yBACvCrB,EAAA9G,KAAKgG,GAALtF,KAAAV,KAAA,IAIF6G,EAAA,KAAAJ,GAAiB,KACVK,EAAA9G,KAAKoG,IAQVS,EAAA7G,KAAKoG,GAAY,GACjBS,EAAA7G,KAAKiG,EAAmB,OARtBmC,uBAAsB,K,MACftB,EAAA9G,KAAKmG,KACV,OAAAqB,EAAAV,EAAA9G,KAAK8F,EAAAiB,KAALS,EAAYD,QAAA,GAMQ,IAI1BV,EAAA,KAAAH,GAAoB2B,I,MAClBxB,EAAA7G,KAAKoG,GAAY,GAEjB,MAAMvD,EAAOiE,EAAA9G,KAAK8F,EAAAiB,GAClB,IAAKlE,EAAM,OACNA,EAAAmC,IAAIsD,QAAQC,SAAW,OAE5B,MAAMC,EAAY1B,EAAA9G,KAAKiG,GACnB,GAAAoC,EAAMI,cAAgBD,EAAW,CAC7B,MAAAvH,EAAQuH,EAAUvF,UACxBoF,EAAMI,aAAaC,cAAgB,WACnC,MAAM,IAAE1D,EAAA,KAAKC,GAASrC,EAAsBC,EAAM5B,GAClDoH,EAAMI,aAAaE,YACnBN,EAAMI,aAAaG,QACjBvD,EAAqB,OAAS,YAC9BL,EAAI6D,WAEDxD,GAAoBgD,EAAMI,aAAaG,QAAQ,aAAc3D,GAC5D,MAAA6D,EAAW,OAAAtB,EAAAV,EAAA9G,KAAKkG,SAAL,EAAAsB,EAAcU,GAC3BY,GAAgBT,EAAAI,aAAaM,aAAaD,EAAU,EAAG,GAE3DjG,EAAK0F,SAAW,CACdtH,QACA+H,MAAM,EACR,KAKJ,KAAAC,gBAAmBpG,IACjBiE,EAAA9G,KAAKsG,GAAL5F,KAAAV,MAEA6G,EAAA7G,KAAKoG,GAAY,GACZvD,EAAAmC,IAAIsD,QAAQC,SAAW,SACrB,GAIY1B,EAAA,KAAAF,EAAAuC,GAAS,CAACrG,EAAkBwF,KAC3C,IAACxF,EAAKsG,SAAU,OAEd,MAAAC,EAAOvG,EAAKmC,IAAImD,wBAChBkB,EAAID,EAAKE,KAAOF,EAAKG,MAAQ,EAE/B,KADQ1G,EAAKvF,KAAKkM,iBAAiBH,EAAGhB,EAAMoB,mBAC3BC,SAEnB,YADA5C,EAAA9G,KAAKsG,GAAL5F,KAAAV,MAIF,MAAM2B,EAAcmF,EAAA9G,KAAK8F,EAAA6D,GACzB,IAAKhI,EAAa,OAElB,MAAMlD,EC3LM,SACdoE,EACA+G,EACAjI,G,MAGI,IADSkB,EAAKmC,IAAI6E,cACJ,YAEd,IACI,MAAAjI,EAAM,OAAA4F,EAAA3E,EAAKiH,YAAY,CAC3BR,KAAMM,EAAOP,EACbU,IAAKH,EAAOI,UAFF,EAAAxC,EAGRyC,OACJ,GAAW,MAAPrI,GAAeA,EAAM,EAAU,YAEnC,IAAIwF,EAAOvE,EAAKc,MAAME,IAAIqG,QAAQtI,GAC9BE,EAAOe,EAAKc,MAAME,IAAIsG,OAAOvI,GAC7BwI,EAAUvH,EAAKwH,QAAQzI,GAErB,MAAA0I,EAAUC,IACR,MAAAC,EAAapD,EAAKqD,OAAS,GAAgC,IAA3BrD,EAAKsD,MAAMtD,EAAKqD,OAGtD,IAFqBF,IAAcC,EAEhB,OAEnB,MAAMG,EAAcvD,EAAKwD,OAAOxD,EAAKqD,OACrC3I,EAAOe,EAAKc,MAAME,IAAIsG,OAAOQ,GACnBP,EAAAvH,EAAKwH,QAAQM,GACvBvD,EAAOvE,EAAKc,MAAME,IAAIqG,QAAQS,GAEzBhJ,EAAYyF,EAAMtF,IAAKwI,GAAU,EAAK,EAIvCO,EAAelJ,EAAYyF,EAAMtF,GAGvC,OAFAwI,GAAQO,GAEHT,GAAYtI,EAEV,CAAEA,OAAMsF,OAAMc,GAAIkC,GAFK,IAEG,OAE1B,YAEX,CDgJmBU,CACbjI,EACA,CAAEwG,IAAGW,EAAG3B,EAAMoB,SACd9H,GAGGlD,EAILqI,EAAA9G,KAAKuG,GAAL7F,KAAAV,KAAWvB,GAHTqI,EAAA9G,KAAKsG,GAAL5F,KAAAV,KAGS,GACV,MAGiB,KAAA+K,kBAAA,CAAClI,EAAkBwF,KACjCxF,EAAKmI,YAAcnI,EAAKsG,UAEvBrC,EAAA,KAAAH,GAAAjG,KAAA,KAAmBmC,EAAMwF,IAFe,GAQ5B,KAAA4C,iBAAA,CAACpI,EAAkBwF,K,MACpC,GAAIvB,EAAA9G,KAAKoG,GAAW,CACZ,MAAA9I,EAAO,OAAAkK,EAAAV,EAAA9G,KAAK8F,EAAAiB,SAAL,EAAAS,EAAYxC,IAAI6E,cACzB,IAACvM,EAAa,SAEZ,MAAA4N,EAAyB5N,EAAK6N,aAAe7N,EAAK8N,aAElDC,EAAW/N,EAAK6K,wBACtB,GAAI+C,EAAwB,CACtB,GAAA5N,EAAKgO,UAAY,GAAK1N,KAAK2N,IAAIlD,EAAM2B,EAAIqB,EAASrB,GA9M/C,GA8M4D,CACjE,MAAMD,EAAMzM,EAAKgO,UAAY,GAAKhO,EAAKgO,UAAY,GAAK,EAEjD,OADPhO,EAAKgO,UAAYvB,GACV,EAET,MAAMyB,EAAc5N,KAAK6N,MAAM5I,EAAKmC,IAAImD,wBAAwBuD,QAG9D,GAFmB9N,KAAK6N,MAAMnO,EAAKgO,UAAYD,EAASK,QAEzCF,GACf5N,KAAK2N,IAAIlD,EAAM2B,GAAKqB,EAASK,OAASL,EAASrB,IAvN1C,GAwNL,CACM,MAAAD,EAAMzM,EAAKgO,UAAY,GAEtB,OADPhO,EAAKgO,UAAYvB,GACV,EACT,CACF,CAEK,UAIT,KAAA4B,kBAAqB9I,IACdA,EAAK0F,WAEV1B,EAAA7G,KAAKoG,GAAY,GACZvD,EAAAmC,IAAIsD,QAAQC,SAAW,SAIV,KAAAqD,kBAAA,CAAC/I,EAAkBwF,KACrC,MAAMgB,EAAIhB,EAAMwD,QACV7B,EAAI3B,EAAMoB,SAEZJ,EAAI,GAAKW,EAAI,GAAKX,EAAIyC,OAAOC,YAAc/B,EAAI8B,OAAOE,eACxDnF,EAAA7G,KAAKkG,EAAU,MACfY,EAAA9G,KAAK4G,GAALlG,KAAAV,KAAc6C,GAAI,EAKtB,KAAAoJ,aAAgBpJ,IACdiE,EAAA9G,KAAK4G,GAALlG,KAAAV,KAAc6C,IAEP,GAIT,KAAAqJ,gBAAmBrJ,IACjBiE,EAAA9G,KAAK4G,GAALlG,KAAAV,KAAc6C,EAAA,EAIhBgE,EAAA,KAAAD,GAAY/D,IACVgE,EAAA7G,KAAKoG,GAAY,GACZvD,EAAAmC,IAAIsD,QAAQC,SAAW,UAC9B,EAjPAxC,EAAA,IAAAoG,QAGAnG,EAAA,IAAAmG,QAmBAlG,EAAA,IAAAkG,QAEAjG,EAAA,IAAAiG,QAEAhG,EAAA,IAAAgG,QAGA/F,EAAA,IAAA+F,QA/BKrG,EAAA,IAAAsG,QAkCDzC,EAAwC,W,MAC1C,OAAO,OAAAnC,EAAAV,EAAA9G,KAAK+F,SAAL,EAAAyB,EAAW6E,IAAI5K,EAAY6K,KAAK3K,WAAA,EAIrCoF,EAAQ,W,MACH,cAAAS,EAAAV,EAAA9G,KAAK+F,SAAL,EAAAyB,EAAW6E,IAAIE,EAAAA,GAAa,EAIrClG,EAAA,IAAA8F,QAGA7F,EAAA,IAAA6F,QAMA5F,EAAA,IAAA4F,QA+BA3F,EAAA,IAAA2F,QAMA1F,EAAA,IAAA0F,QAcAzF,EAAA,IAAAyF,QAsCAxF,EAAA,IAAAwF,QAkGAvF,EAAA,IAAAuF,QE5QK,MAAMK,GAAe9K,EAAAA,EAAAA,KAAK,IAAM,IAAIiE,GAAgB,gBAG9C8G,GAAuB/K,EAAAA,EAAAA,IAClC,CAAC,EACD,wBAGFN,EAASoL,EAAc,CACrBxK,YAAa,sBAGfZ,EAASqL,EAAsB,CAC7BzK,YAAa,8BAKR,MAAM0K,IAAYhL,EAAAA,EAAAA,IAAmC,CAAC,EAAG,aAEhEN,EAASsL,GAAW,CAClB1K,YAAa,mBAIF,MAAA2K,IAAcC,EAAAA,EAAAA,KAAQjF,IAC3B,MAAAkF,EAAyB,IAAIC,EAAAA,GAAU,kBAEvCC,EADapF,EAAI0E,IAAIG,EAAaF,IACxBU,GACZrF,EAAAsF,IAAIR,EAAqBH,IAAKS,GAClC,MAAMG,EAAOvF,EAAI0E,IAAIK,GAAUJ,KAE/B,OAAO,IAAIa,EAAAA,GAAO,CAChBb,IAAKO,KACFK,EACHE,MAAO,IACFF,EAAKE,MACRC,gBAAiB,CACfC,KAAOzK,GACEkK,EAAQd,aAAapJ,GAE9B0K,YAAaA,CAAC1K,EAAMwF,IACX0E,EAAQhC,kBAAkBlI,EAAMwF,GAEzCmF,QAAU3K,GACDkK,EAAQ9D,gBAAgBpG,GAEjC4K,SAAUA,CAAC5K,EAAMwF,IACR0E,EAAQ9B,iBAAiBpI,EAAMwF,GAExCqF,UAAWA,CAAC7K,EAAMwF,IACT0E,EAAQnB,kBAAkB/I,EAAMwF,GAEzCsF,UAAY9K,GACHkK,EAAQpB,kBAAkB9I,GAEnC+K,QAAU/K,GACDkK,EAAQb,gBAAgBrJ,MAIrC,IAGJzB,EAASuL,GAAa,CACpB3K,YAAa,iBCnBR,MAAM6L,GA+CXjI,WAAAA,CAAYvH,GA/CPwH,EAAA,KAAAiI,GAEIjI,EAAA,KAAAkI,GAGAlI,EAAA,KAAAmI,GAGTnI,EAAA,KAAAoI,GAGApI,EAAA,KAAAqI,GAGSrI,EAAA,KAAAsI,GAGTtI,EAAA,KAAAuI,GAGSvI,EAAA,KAAAwI,GAGAxI,EAAA,KAAAyI,GAGAzI,EAAA,KAAA0I,GASA1I,EAAA,KAAA2I,GAKA3I,EAAA,KAAA4I,GA7BwB5H,EAAA,KAAAqH,EAAA,MAMlBrH,EAAA,KAAAuH,GAAA,GAiEf,KAAAM,OAAS,KACPtG,uBAAsB,KAChB,IAACtB,EAAA9G,KAAKoO,GACJ,K,EACFpO,K,EAAK8N,E,EAAAa,E,kCAALjO,KAAAV,MACA6G,EAAA7G,KAAKoO,GAAe,SACb,C,SAET,GAEF,EAIJ,KAAAQ,QAAU,K,QACR,OAAApH,EAAAV,EAAA9G,KAAKiO,KAALzG,EAAeS,SACV,OAAA4G,EAAA/H,EAAA,KAAAmH,KAAAY,EAAU9G,YAAYjB,EAAA9G,KAAK+N,IAChCjH,EAAA9G,KAAK+N,GAASe,QAAQ,EAIxB,KAAAC,KAAQtH,IACN,MAAMzC,EAAMyC,EAAOS,GACb8G,EAAYlI,EAAA9G,KAAKgO,GAAK3B,IAAIE,EAAAA,IAAevH,IACzCiK,EAA+B,CACnCtH,IAAKb,EAAA9G,KAAKgO,GACVvG,SACAuH,YACAE,SAAUpI,EAAA9G,KAAK+N,IAEXoB,EAA4B,CAChCC,eAAgBpK,EAChBmD,sBAAuBA,IACjBrB,EAAA9G,KAAKwO,GAAqB1H,EAAA9G,KAAKwO,GAAL9N,KAAAV,KAAkBiP,GAEzCjK,EAAImD,yBAGTkH,EAAa,EAACC,EAAAA,EAAAA,OACpB,GAAIxI,EAAA9G,KAAKuO,GAAY,CACb,MAAAgB,EAAezI,EAAA9G,KAAKuO,GAAL7N,KAAAV,KAAgBiP,GAC/BO,GAAYC,EAAAA,EAAAA,IAAOF,GACzBF,EAAWjM,KAAKoM,EAAS,EAGXE,EAAAA,EAAAA,IAAAP,EAAWrI,EAAA9G,KAAK+N,GAAU,CACxC4B,UAAW7I,EAAA9G,KAAKyO,GACZ3H,EAAA9G,KAAKyO,GAAL/N,KAAAV,KAAmBiP,GACnB,OACJI,WAAY,IAAIA,KAAevI,EAAA9G,KAAKqO,OACjCvH,EAAA9G,KAAKsO,KACPsB,MAAKC,IAAc,IAAb,EAAExG,EAAA,EAAGW,GAAA6F,EACL1S,OAAAoE,OAAOuF,EAAA9G,KAAK+N,GAAS+B,MAAO,CACjCxG,KAAM,GAAGD,MACTU,IAAK,GAAGC,QAELlD,EAAA,KAAAiH,GAASzF,QAAQyG,KAAO,SAC7B,EAIJ,KAAAgB,KAAO,KACAjJ,EAAA,KAAAiH,GAASzF,QAAQyG,KAAO,SAhG7BlI,EAAA7G,KAAKgO,EAAO3P,EAAQsJ,KACpBd,EAAA7G,KAAK+N,EAAW1P,EAAQ4E,SACxB4D,EAAA7G,KAAKuO,EAAalQ,EAAQ2R,WAC1BnJ,EAAA7G,KAAKwO,EAAenQ,EAAQ4R,aAC5BpJ,EAAA7G,KAAKyO,EAAgBpQ,EAAQ6R,cACxBrJ,EAAA,KAAAwH,EAAchQ,EAAQgR,YAAc,IACpCxI,EAAA,KAAAyH,EAAqBjQ,EAAQ8R,mBAAqB,CAAC,GACxDtJ,EAAA7G,KAAKmO,EAAQ9P,EAAQf,MACrB0C,KAAK+P,MAAK,CAbZ,UAAItI,GACF,OAAOX,EAAA9G,KAAKkO,EAAA,EA1CLH,EAAA,IAAA5B,QAGA6B,EAAA,IAAA7B,QAGT8B,EAAA,IAAA9B,QAGA+B,EAAA,IAAA/B,QAGSgC,EAAA,IAAAhC,QAGTiC,EAAA,IAAAjC,QAGSkC,EAAA,IAAAlC,QAGAmC,EAAA,IAAAnC,QAGAoC,EAAA,IAAApC,QASAqC,EAAA,IAAArC,QAKAsC,EAAA,IAAAtC,QAxCJ2B,EAAA,IAAA1B,QA4DLuC,EAAQ,WACN,MAAM9L,EAAOiE,EAAA9G,KAAKgO,GAAK3B,IAAIE,EAAAA,KACdzF,EAAA9G,KAAKmO,IAAStL,EAAKmC,IAAI6E,eAAiB/F,SAASsM,MACzDjM,YAAY2C,EAAA9G,KAAK+N,IAEtB,MAAMhB,EAAUjG,EAAA9G,KAAKgO,GAAK3B,IAAII,EAAqBH,KACnDS,EAAQrF,KAAKZ,EAAA9G,KAAKgO,IAAOqC,IACF,SAAjBA,EAAQ7P,MACVR,KAAK+P,OACLlJ,EAAA7G,KAAKkO,EAAc,OACO,SAAjBmC,EAAQ7P,OACZ,KAAAuO,KAAKsB,EAAQ5I,QAClBZ,EAAA7G,KAAKkO,EAAcmC,EAAQ5I,QAAA,IAI/BZ,EAAA7G,KAAKiO,EAAWlB,GACXjG,EAAA,KAAAmH,GAASpG,SAASf,EAAA9G,KAAK+N,IAC5BjH,EAAA9G,KAAK+N,GAASuC,WAAY,GCpGvB,MAAMC,GAAQ,CACnB7D,GACAjL,EACA+K,EACAC,EACAE,IAEF4D,GAAMjE,IAAMI,GAAUJ,IACtBiE,GAAMC,UAAY7D,GAAYL,I,kYCAvB,MAAMmE,GAwCX7K,WAAAA,CAAYvH,GAA+B,I,EAAAqS,EAAA,KAxCtC7K,GAAA,KAAA8K,IAKL9K,GAAA,KAAAuI,IAGSvI,GAAA,KAAAwI,IAGAxI,GAAA,KAAAyI,IAGAzI,GAAA,KAAAsI,IAGAtI,GAAA,KAAA+K,IAGA/K,GAAA,KAAAgL,IAGAhL,GAAA,KAAAiL,IAGAjL,GAAA,KAAAkL,IA0BTlL,GAAA,KAAAmL,IA/CenK,GAAA,KAAAuH,IAAA,GA8Bf,KAAA6C,OAAS,OAGT,KAAAC,OAAS,OAcGrK,GAAC,KAADmK,IAAA,CAACnO,EAAkBsO,KACvB,YAAExN,EAAA,UAAOqH,GAAcnI,GACvB,UAAE2F,EAAA,IAAW3E,GAAQF,GACrB,OAAEyN,GAAW5I,EACb6I,EAAOzT,KAAKG,OAAOqT,EAAOE,KAAKC,GAAUA,EAAMC,MAAM5P,OACrD6P,EAAK7T,KAAKC,OAAOuT,EAAOE,KAAKC,GAAUA,EAAMG,IAAI9P,OACjD+P,EACJR,GAAaA,EAAUtN,IAAI+N,GAAG/N,IAAQsN,EAAU3I,UAAUoJ,GAAGpJ,GAE3D,IAAC1B,GAAA9G,KAAKoO,IAAc,EACTtH,GAAA9G,KAAKmO,KAAStL,EAAKmC,IAAI6E,eAAiB/F,SAASsM,MACzDjM,YAAYnE,KAAKoK,SACtBvD,GAAA7G,KAAKoO,IAAe,GAGtB,GAAIpD,GAAa2G,EAAQ,OAEzB,IAAK7K,GAAA9G,KAAK8Q,IAALpQ,KAAAV,KAAiB6C,EAAMsO,GAE1B,YADAnR,KAAK+P,OAIP,MAAMZ,EAA4B,CAChChH,sBAAuBA,KAAM0J,EAAAA,EAAAA,IAAahP,EAAMwO,EAAMI,KAExC/B,EAAAA,EAAAA,IAAAP,EAAWnP,KAAKoK,QAAS,CACvCuF,UAAW,eACXN,WAAY,EAACC,EAAAA,EAAAA,OAAQG,EAAAA,EAAAA,IAAO3I,GAAA9G,KAAK+Q,QAAajK,GAAA9G,KAAKqO,QAChDvH,GAAA9G,KAAKsO,MACPsB,MAAKC,IAAc,IAAb,EAAExG,EAAA,EAAGW,GAAA6F,EACL1S,OAAAoE,OAAOvB,KAAKoK,QAAQ0F,MAAO,CAChCxG,KAAM,GAAGD,MACTU,IAAK,GAAGC,OACR,IAGJhK,KAAK+O,MAAM,IAmBJ,KAAAL,OAAA,CAAC7L,EAAkBsO,KACVjT,GAAS4I,GAAA9G,KAAKgR,IAAWlK,GAAA9G,KAAK4Q,IAE9CkB,CAAQjP,EAAMsO,EAAU,EAKb,KAAAY,WAAA,SACXlP,GAGuB,IAFvBmP,EAAAjS,UAAA4E,OAAA,QAAAtF,IAAAU,UAAA,GAAAA,UAAA,GAAsC+B,GACjB,cAAnBA,EAAKtB,KAAKuB,KAEN,gBAAEyG,GAAc3F,EAAKc,OACrB,MAAEsO,EAAA,MAAOT,GAAUhJ,EACnB0J,EAAcrP,EAAKc,MAAM6E,qBAAqB2J,EAAAA,GAE9CC,EAAkB1B,EAAKtG,QAAQiI,SAASvO,SAASwO,eAEjDC,GAAe1P,EAAK2P,aAAeJ,EAEnCK,GAAc5P,EAAKsG,SAEnBuJ,GAAYC,EAAAA,EAAAA,IAAeX,EAAfW,CAA0B9P,EAAKc,MAAM6E,WAIvD,IAAI+J,IAAeE,GAAeR,GAAUC,KAFlBQ,EAK1B,OAAOlB,EAAMoB,OAAOzN,YAClBvH,KAAKC,IAAI,EAAG2T,EAAMqB,aAAe,KACjCrB,EAAMqB,kBACN,EACA,SAEJ,EAGA,KAAAjE,QAAU,OAGV,KAAAG,KAAO,KACA,KAAA3E,QAAQ9B,QAAQyG,KAAO,OAC5B/O,KAAKiR,QAAQ,EAIf,KAAAlB,KAAO,KACA,KAAA3F,QAAQ9B,QAAQyG,KAAO,QAC5B/O,KAAKkR,QAAQ,EApHblR,KAAKoK,QAAU/L,EAAQ4E,QAClB4D,GAAA,KAAA+J,GAAYvS,EAAQH,UAAY,KAChC2I,GAAA,KAAAiK,GAAczS,EAAQyU,a,EAAmBC,G,GAAL/S,KAAK2Q,G,6BACzC9J,GAAA,KAAAgK,GAAWxS,EAAQ2U,SAAW,KACnCnM,GAAA7G,KAAK+Q,GAAU1S,EAAQoR,QAClB5I,GAAA,KAAAwH,GAAchQ,EAAQgR,YAAc,IACpCxI,GAAA,KAAAyH,GAAqBjQ,EAAQ8R,mBAAqB,CAAC,GACxDtJ,GAAA7G,KAAKmO,GAAQ9P,EAAQf,KAAA,EA3CvB8Q,GAAA,IAAAjC,QAGSkC,GAAA,IAAAlC,QAGAmC,GAAA,IAAAnC,QAGAgC,GAAA,IAAAhC,QAGAyE,GAAA,IAAAzE,QAGA0E,GAAA,IAAA1E,QAGA2E,GAAA,IAAA3E,QAGA4E,GAAA,IAAA5E,QA0BT6E,GAAA,IAAA7E,QApDKwE,GAAA,IAAAvE,QA4FL2G,GAAA,SAAalQ,GACL,MAAAoQ,EAA0BjT,KAAK+R,WAAWlP,GAE5C,IAACoQ,EAAgC,SAE/B,MAAAC,EAASD,EAAwBE,IAAI,GAEvC,QAACD,IAEEE,MAAMC,QAAQvM,GAAA9G,KAAK6Q,KACtB/J,GAAA9G,KAAK6Q,IAASyC,SAASJ,GACvBpM,GAAA9G,KAAK6Q,MAAaqC,EAAA,E,IC/I1BK,GAAAC,G,yUAEO,MAAMC,GAAN7N,WAAAA,GACL8N,GAAA,KAAAH,GAAkC,IAElC,KAAAI,MAAQ,K,UAEC,O,EADQ,G,KAAf3T,K,EAAKuT,G,qCACEvT,IAAA,EAGT0T,GAAA,KAAAF,IAAqBI,IACnB,MAAMC,EAAgB,CACpBD,QACAE,QAASA,CAACxH,EAAayH,KACrB,MAAMC,EAAO,CAAE1H,SAAQyH,GAEhB,OADDH,EAAAK,MAAM7Q,KAAK4Q,GACVH,CAAA,EAETF,MAAOA,KACLC,EAAMK,MAAQ,GACPJ,IAGJ,OAAAA,CAAA,IAGE,KAAAK,SAAA,CAAC5H,EAAa6H,KACvB,MACMP,EAA8B,CAClCtH,MACA6H,QACAF,MAJuC,IAQlC,OAFFG,GAAA,KAAAb,IAAQnQ,KAAKwQ,GAEXQ,GAAApU,KAAKwT,IAAL9S,KAAuB,KAAAkT,EAAA,EAGhC,KAAAS,SAAY/H,IACJ,MAAAsH,EAAQQ,GAAApU,KAAKuT,IAAQe,MAAMC,GAAUA,EAAMjI,MAAQA,IACzD,IAAKsH,EAAO,MAAM,IAAIY,MAAM,kBAAkBlI,eAEvC,OAAA8H,GAAApU,KAAKwT,IAAL9S,KAAuB,KAAAkT,EAAA,EAGhC,KAAAa,MAAQ,IACCL,GAAK,KAAAb,GACd,ECpBK,SAASmB,GAAWjS,GACzB,MAAM,MAAE+O,EAAA,IAAOE,GAAQjP,EAAG+F,WAClB5G,IAAKyP,GAASG,GACd5P,IAAK6P,GAAOC,EAEb,OADFjP,EAAAA,EAAGkS,YAAYtD,EAAOG,EAAM1P,OAAOmB,QAAQmC,KAAMqM,EAExD,CAoCgB,SAAAmD,GACdrQ,GAES,IADTlB,EAAAtD,UAAA4E,OAAA,QAAAtF,IAAAU,UAAA,GAAAA,UAAA,GAAsB,KAEf,OAAC4D,EAAO0D,KACb,GAAIA,EAAU,CACZ,MAAM5E,EAxCL,SACLA,EACA8B,GAEA,IADAlB,EAAAtD,UAAA4E,OAAA,QAAAtF,IAAAU,UAAA,GAAAA,UAAA,GAAsB,KAEtB,MAAM,KAAEsR,EAAA,GAAMI,GAAOhP,EAAG+F,UACxB,OAAO/F,EAAGoS,aAAaxD,EAAMI,EAAIlN,EAAUlB,EAC7C,CAiCiBwR,CAAaH,GAAW/Q,EAAMlB,IAAK8B,EAAUlB,GAC/CgE,EAAA5E,EAAGqS,iBAAgB,CAEvB,SAEX,CAEgB,SAAAC,GACdxQ,GAES,IADTlB,EAAAtD,UAAA4E,OAAA,QAAAtF,IAAAU,UAAA,GAAAA,UAAA,GAAsB,KAEf,OAAC4D,EAAO0D,KACb,MAAM5E,EA3CH,SACLA,EACA8B,GAEA,IADAlB,EAAAtD,UAAA4E,OAAA,QAAAtF,IAAAU,UAAA,GAAAA,UAAA,GAAsB,KAEtB,MAAM,MAAEyR,EAAA,IAAOE,GAAQjP,EAAG+F,UAEpB+I,EAAQC,EAAMwD,WAAWtD,GACzBuD,EAAW1D,IAAS2D,EAAAA,GAAAA,IAAa3D,EAAOhN,EAAUlB,GACpD,OAAC4R,EAEExS,EAAGwB,KAAKsN,EAAO0D,GAFA,IAGxB,CA+BeE,CAAgBT,GAAW/Q,EAAMlB,IAAK8B,EAAUlB,GACvD,QAACZ,IAED4E,GAAUA,EAAS5E,EAAGqS,mBAEnB,GAEX,CAEgB,SAAAM,GACd7Q,GAES,IADTlB,EAAAtD,UAAA4E,OAAA,QAAAtF,IAAAU,UAAA,GAAAA,UAAA,GAAsB,KAEf,OAAC4D,EAAO0D,KACb,MAAM5E,EA3CH,SACLA,EACA8B,GAEA,IADAlB,EAAAtD,UAAA4E,OAAA,QAAAtF,IAAAU,UAAA,GAAAA,UAAA,GAAsB,KAEhB,MAAA+B,EAAOyC,EAAS8Q,cAAchS,GAChC,OAACvB,EAEEW,EAAG6S,qBAAqBxT,GAFb,IAGpB,CAkCeyT,CAAab,GAAW/Q,EAAMlB,IAAK8B,EAAUlB,GACpD,QAACZ,IAED4E,GAAUA,EAAS5E,EAAGqS,mBAEnB,GAEX,CDzGEvB,GAAA,IAAApH,QAOAqH,GAAA,IAAArH,QEaK,MAAMqJ,GAAsC3F,IAM7C,IAN8C,KAClDd,EAAA,KACAgB,EAAA,IACApI,EAAA,OACA2C,EAAA,OACAmL,GACI5F,EACE,aAAE6F,EAAQtQ,KAAAA,IAASuQ,EAAAA,GAAAA,KACvB,ICcY,SACdrL,EACAmL,EACA9N,GAhDF,IAAAH,EAAAqH,EAAA+G,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GAAAC,GAAAC,GAkDQ,MAAAC,GAAQ,MAAAnR,OAAA,EAAAA,EAAK0E,IAAI0M,GAAAA,GACjBC,GAAwB,MAAPF,QAAO,EAAAA,GAAAxF,SAAS2F,GAAAA,EAAaC,OAC9CC,GAA6B,MAAPL,QAAO,EAAAA,GAAAxF,SAAS2F,GAAAA,EAAaG,YACnDC,GAAwB,MAAPP,QAAO,EAAAA,GAAAxF,SAAS2F,GAAAA,EAAaK,OAE9CC,GAAe,IAAI9F,GAEtB8F,GAAArF,SAAS,OAAQ,OAAA1M,EAAQ,MAAAiO,OAAA,EAAAA,EAAA+D,yBAARhS,EAAmC,QACpDsM,QAAQ,OAAQ,CACfK,MAAO,OAAAtF,EAAQ,MAAA4G,OAAA,EAAAA,EAAA+D,yBAA2B3K,EAAA,OAC1C4K,KAAuC,OAAjC5D,EAAA,OAAQD,EAAA,MAAAH,OAAA,EAAAA,EAAAiE,wBAAyB,EAAA9D,EAAAlV,KAAA+U,IAAAI,EAAA8D,GAAAA,EACvCC,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZ+R,GAA4BkF,GAAAA,GAAgBtZ,KAAKqZ,GACjEE,CAAQpW,EAAO0D,EAAS,IAG3ByM,QAAQ,KAAM,CACbK,MAAO,OAAA2B,EAAQ,MAAAL,OAAA,EAAAA,EAAAuE,kBAAoBlE,EAAA,YACnC2D,KAAqC,OAA/BzD,EAAA,OAAQD,EAAA,MAAAN,OAAA,EAAAA,EAAAwE,sBAAuB,EAAAlE,EAAArV,KAAA+U,IAAAO,EAAAkE,GAAAA,EACrCN,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZ+R,GAA4BuF,GAAAA,GAAc3Z,KAAKqZ,GAAM,CACnEO,MAAO,GAETL,CAAQpW,EAAO0D,EAAS,IAG3ByM,QAAQ,KAAM,CACbK,MAAO,OAAA8B,EAAQ,MAAAR,OAAA,EAAAA,EAAA4E,kBAAoBpE,EAAA,YACnCwD,KAAqC,OAA/BtD,EAAA,OAAQD,EAAA,MAAAT,OAAA,EAAAA,EAAA6E,sBAAuB,EAAApE,EAAAxV,KAAA+U,IAAAU,EAAAoE,GAAAA,EACrCX,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZ+R,GAA4BuF,GAAAA,GAAc3Z,KAAKqZ,GAAM,CACnEO,MAAO,GAETL,CAAQpW,EAAO0D,EAAS,IAG3ByM,QAAQ,KAAM,CACbK,MAAO,OAAAiC,EAAQ,MAAAX,OAAA,EAAAA,EAAA+E,kBAAoBpE,EAAA,YACnCqD,KAAqC,OAA/BnD,EAAA,OAAQD,EAAA,MAAAZ,OAAA,EAAAA,EAAAgF,sBAAuB,EAAApE,EAAA3V,KAAA+U,IAAAa,EAAAoE,GAAAA,EACrCd,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZ+R,GAA4BuF,GAAAA,GAAc3Z,KAAKqZ,GAAM,CACnEO,MAAO,GAETL,CAAQpW,EAAO0D,EAAS,IAG3ByM,QAAQ,KAAM,CACbK,MAAO,OAAAoC,EAAQ,MAAAd,OAAA,EAAAA,EAAAkF,kBAAoBpE,EAAA,YACnCkD,KAAqC,OAA/BhD,EAAA,OAAQD,EAAA,MAAAf,OAAA,EAAAA,EAAAmF,sBAAuB,EAAApE,EAAA9V,KAAA+U,IAAAgB,EAAAoE,GAAAA,EACrCjB,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZ+R,GAA4BuF,GAAAA,GAAc3Z,KAAKqZ,GAAM,CACnEO,MAAO,GAETL,CAAQpW,EAAO0D,EAAS,IAG3ByM,QAAQ,KAAM,CACbK,MAAO,OAAAuC,EAAQ,MAAAjB,OAAA,EAAAA,EAAAqF,kBAAoBpE,EAAA,YACnC+C,KAAqC,OAA/B7C,EAAA,OAAQD,EAAA,MAAAlB,OAAA,EAAAA,EAAAsF,sBAAuB,EAAApE,EAAAjW,KAAA+U,IAAAmB,EAAAoE,GAAAA,EACrCpB,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZ+R,GAA4BuF,GAAAA,GAAc3Z,KAAKqZ,GAAM,CACnEO,MAAO,GAETL,CAAQpW,EAAO0D,EAAS,IAG3ByM,QAAQ,KAAM,CACbK,MAAO,OAAA0C,EAAQ,MAAApB,OAAA,EAAAA,EAAAwF,kBAAoBpE,EAAA,YACnC4C,KAAqC,OAA/B1C,EAAA,OAAQD,EAAA,MAAArB,OAAA,EAAAA,EAAAyF,sBAAuB,EAAApE,EAAApW,KAAA+U,IAAAsB,EAAAoE,GAAAA,EACrCvB,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZ+R,GAA4BuF,GAAAA,GAAc3Z,KAAKqZ,GAAM,CACnEO,MAAO,GAETL,CAAQpW,EAAO0D,EAAS,IAG3ByM,QAAQ,QAAS,CAChBK,MAAO,OAAA6C,EAAQ,MAAAvB,OAAA,EAAAA,EAAA2F,qBAAuBpE,EAAA,QACtCyC,KAAwC,OAAlCvC,EAAA,OAAQD,EAAA,MAAAxB,OAAA,EAAAA,EAAA4F,yBAA0B,EAAApE,EAAAvW,KAAA+U,IAAAyB,EAAAoE,GAAAA,EACxC1B,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZkS,GACdwG,GAAAA,GAAiB/a,KAAKqZ,GAExBE,CAAQpW,EAAO0D,EAAS,IAG3ByM,QAAQ,UAAW,CAClBK,MAAO,OAAAgD,EAAQ,MAAA1B,OAAA,EAAAA,EAAA+F,uBAAyBrE,EAAA,UACxCsC,KAA0C,OAApCpC,EAAA,OAAQD,EAAA,MAAA3B,OAAA,EAAAA,EAAAgG,2BAA4B,EAAArE,EAAA1W,KAAA+U,IAAA4B,EAAAqE,GAAAA,EAC1C9B,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZuS,GAA4BuG,GAAAA,GAASnb,KAAKqZ,GAC1DE,CAAQpW,EAAO0D,EAAS,IAK3BkS,GAAArF,SAAS,OAAQ,OAAAoD,EAAQ,MAAA7B,OAAA,EAAAA,EAAAmG,yBAARtE,EAAmC,QACpDxD,QAAQ,cAAe,CACtBK,MAAO,OAAAoD,EAAQ,MAAA9B,OAAA,EAAAA,EAAAoG,0BAA4BtE,EAAA,cAC3CkC,KAA6C,OAAvChC,EAAA,OAAQD,EAAA,MAAA/B,OAAA,EAAAA,EAAAqG,8BAA+B,EAAAtE,EAAA9W,KAAA+U,IAAAgC,EAAAsE,GAAAA,EAC7CnC,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZkS,GACdiH,GAAAA,GAAiBxb,KAAKqZ,GAExBE,CAAQpW,EAAO0D,EAAS,IAG3ByM,QAAQ,eAAgB,CACvBK,MAAO,OAAAuD,EAAQ,MAAAjC,OAAA,EAAAA,EAAAwG,2BAA6BvE,EAAA,eAC5C+B,KAA8C,OAAxC7B,EAAA,OAAQD,EAAA,MAAAlC,OAAA,EAAAA,EAAAyG,+BAAgC,EAAAvE,EAAAjX,KAAA+U,IAAAmC,EAAAuE,GAAAA,EAC9CvC,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZkS,GACdqH,GAAAA,EAAkB5b,KAAKqZ,GAEzBE,CAAQpW,EAAO0D,EAAS,IAG3ByM,QAAQ,YAAa,CACpBK,MAAO,OAAA0D,EAAQ,MAAApC,OAAA,EAAAA,EAAA4G,wBAA0BxE,EAAA,YACzC4B,KAA2C,OAArC1B,EAAA,OAAQD,EAAA,MAAArC,OAAA,EAAAA,EAAA6G,4BAA6B,EAAAxE,EAAApX,KAAA+U,IAAAsC,EAAAwE,GAAAA,EAC3C3C,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZkS,GACdyH,GAAAA,GAAehc,KAAKqZ,GACpB,CAAE4C,SAAS,GAEb1C,CAAQpW,EAAO0D,EAAS,IAI9B,MAAMqV,GAAgBnD,GAAarF,SACjC,WACA,OAAA8D,EAAA,MAAAvC,OAAA,EAAAA,EAAQkH,6BAA+B3E,EAAA,YAGrCmB,IACFuD,GAAc5I,QAAQ,QAAS,CAC7BK,MAAO,OAAA8D,EAAQ,MAAAxC,OAAA,EAAAA,EAAAmH,qBAAuB3E,EAAA,QACtCwB,KAAwC,OAAlCtB,EAAA,OAAQD,EAAA,MAAAzC,OAAA,EAAAA,EAAAoH,yBAA0B,EAAA3E,EAAAxX,KAAA+U,IAAA0C,EAAA2E,GAAAA,EACxClD,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZuS,GAA4B2H,GAAAA,GAAiBvc,KAAKqZ,GAClEE,CAAQpW,EAAO0D,EAAS,IAK9BqV,GAAc5I,QAAQ,OAAQ,CAC5BK,MAAO,OAAAiE,EAAQ,MAAA3C,OAAA,EAAAA,EAAAuH,yBAA2B5E,EAAA,OAC1CqB,KAA4C,OAAtCnB,EAAA,OAAQD,EAAA,MAAA5C,OAAA,EAAAA,EAAAwH,6BAA8B,EAAA5E,EAAA3X,KAAA+U,IAAA6C,EAAA4E,GAAAA,EAC5CtD,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZuS,GAA4B+H,GAAAA,GAAgB3c,KAAKqZ,GACjEE,CAAQpW,EAAO0D,EAAS,IAIxBgS,IACFqD,GAAc5I,QAAQ,QAAS,CAC7BK,MAAO,OAAAoE,EAAQ,MAAA9C,OAAA,EAAAA,EAAA2H,qBAAuB7E,EAAA,QACtCkB,KAAwC,OAAlChB,EAAA,OAAQD,EAAA,MAAA/C,OAAA,EAAAA,EAAA4H,yBAA0B,EAAA7E,EAAA9X,KAAA+U,IAAAgD,EAAA6E,GAAAA,EACxC1D,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EACxB,OAAEJ,GAAOkB,EACblB,EAAKiS,GAAWjS,GACV,MAAA4O,EAAO5O,EAAG+F,UAAU6I,KACpBkM,GAAQC,EAAAA,GAAAA,IAAY3D,EAAK,EAAG,GAC7BpX,EAAAA,EAAG6S,qBAAqBiI,GAC7BlW,EAAS5E,GAET2F,uBAAsB,KACpB,MAAMqV,EAAU5a,EAAKc,MAAME,IAAIZ,QAAQmC,KACjCgC,EAAOvE,EAAKc,MAAME,IAAIqG,QAC1BmH,EAAOoM,EAAUA,EAAUpM,EAAO,EAAI,EAAIA,GAEtC7I,EAAY2J,EAAAA,GAAcuL,KAAKtW,GAC/BuW,EAAK9a,EAAKc,MAAMlB,GACtBkb,EAAGrW,aAAakB,GACPnB,EAAAsW,EAAG7I,iBAAiB,GAC7B,IAKJkE,IACF0D,GAAc5I,QAAQ,OAAQ,CAC5BK,MAAO,OAAAuE,EAAQ,MAAAjD,OAAA,EAAAA,EAAAmI,oBAAsBlF,EAAA,OACrCe,KAAuC,OAAjCb,GAAA,OAAQD,GAAA,MAAAlD,OAAA,EAAAA,EAAAoI,wBAAyB,EAAAlF,GAAAjY,KAAA+U,IAAAmD,GAAAkF,GAAAA,EACvClE,MAAQC,IACA,MAAAhX,EAAOgX,EAAIxN,IAAIE,EAAAA,KACf,SAAElF,EAAU1D,MAAAA,GAAUd,EAEZuS,GAA4B+H,GAAAA,GAAgB3c,KAAKqZ,GAAM,CACrEkE,SAAU,SAEZhE,CAAQpW,EAAO0D,EAAS,IAK9B,OAAAwR,GAAA,MAAApD,OAAA,EAAAA,EAAQuI,YAAYnF,GAAAnY,KAAA+U,EAAA8D,IAEhB,IAAA7D,GAAS6D,GAAa9E,QAEtBnK,IACOoL,GAAAA,GACNpE,KAAKsC,IACE,MAAAqK,EAAQrK,EAAMK,MAAM3J,QAAQyJ,GAChCA,EAAKI,MAAM1P,cAAc6O,SAAShJ,EAAO7F,iBAGpC,UACFmP,EACHK,MAAAgK,EACF,IAED3T,QAAQsJ,GAAUA,EAAMK,MAAMtP,OAAS,KAG5C,MAAMsP,GAAQyB,GAAOwI,SAASC,GAAWA,EAAOlK,QAazC,OAZDA,GAAAmK,SAAQ,CAACrK,EAAMrJ,KACnBvN,OAAOoE,OAAOwS,EAAM,CAAErJ,SAAQ,IAGzBgL,GAAA2I,QAAO,CAACC,EAAK1K,KACZ,MAAA2K,EAAMD,EAAM1K,EAAMK,MAAMtP,OAIvB,OAHPxH,OAAOoE,OAAOqS,EAAO,CACnBrC,MAAO,CAAC+M,EAAKC,KAERA,CAAA,GACN,GAEI,CACL7I,UACAtQ,KAAM6O,GAAMtP,OAEhB,CDvSU6Z,CAAUlU,EAAQmL,EAAQ9N,IAChC,CAAC2C,IAGGmU,GAAOC,EAAAA,GAAAA,OACNC,EAAYC,IAAiBC,EAAAA,GAAAA,IAAS,GAEvCvhB,GAAOqY,EAAAA,GAAAA,KAAQ,IAAM8I,EAAKK,QAAQC,eAA8B,CAACN,IAEjEO,GAAoBC,EAAAA,GAAAA,IAAO,CAAE5V,GAAI,IAAKW,GAAI,MAE1CkV,GAAcC,EAAAA,GAAAA,KAAaC,IAC/B,MAAMC,EAAUL,EAAkBF,QAClC,IAAKO,EAAS,OAER,QAAEhW,EAAGW,EAAAA,GAAMoV,EACjBC,EAAQhW,EAAIA,EACZgW,EAAQrV,EAAIA,CAAA,GACX,KAEHsV,EAAAA,GAAAA,KAAU,KACK,IAATla,GAAc2J,EAAM,MAAAgB,GAAAA,IACf4O,GAAcvZ,GAAMwZ,EAAc,EAAE,GAC5C,CAACxZ,EAAM2J,IAEV,MAAMwQ,GAAUJ,EAAAA,GAAAA,KACd,CACEzU,EACA8U,KAEAZ,GAAea,IACb,MAAMC,EAAwB,oBAAVhV,EAAuBA,EAAM+U,GAAQ/U,EAGlD,OADC,MAAA8U,GAAAA,EAAAE,GACDA,CAAA,GACP,GAEJ,IAGIC,GAAgBR,EAAAA,GAAAA,KAAazU,IAC3B,MAAAwI,EAASuL,EAAKK,QAAQc,cAC1B,gBAAgBlV,OAEZmV,EAAapB,EAAKK,QAAQc,cAA2B,gBAEtD1M,GAAW2M,IAELA,EAAAvU,UAAY4H,EAAO4M,UAAYD,EAAWC,UAAA,GACpD,IAEGC,GAAaZ,EAAAA,GAAAA,KAChBzU,IACO,MAAAqJ,EAAO2B,EAAOwI,SAAStK,GAAUA,EAAMK,QAAOd,GAAGzI,GACnDqJ,GAAQpM,GAAUoM,EAAA6F,MAAMjS,GAE5B,MAAAoI,GAAAA,GAAA,GAEF,CAAC2F,IAGGsK,GAAYb,EAAAA,GAAAA,KACfC,GACe,WAAVA,EAAE9S,KACJ8S,EAAEa,sBACF,MAAAlQ,GAAAA,MAIY,cAAVqP,EAAE9S,KACJ8S,EAAEa,iBACKV,GACJ7U,GAAWA,EAAQtF,EAAO,EAAIsF,EAAQ,EAAIA,GAC3CiV,IAIU,YAAVP,EAAE9S,KACJ8S,EAAEa,iBACKV,GACJ7U,GAAWA,GAAS,EAAIA,EAAQA,EAAQ,GACzCiV,IAIU,cAAVP,EAAE9S,KACJ8S,EAAEa,iBACKV,GAAS7U,IACd,MAAMkJ,EAAQ8B,EAAOpB,MAClBC,GAAUA,EAAMhD,MAAM,IAAM7G,GAAS6J,EAAMhD,MAAM,GAAK7G,IAErD,IAACkJ,EAAc,OAAAlJ,EAEnB,MAAMwV,EAAYxK,EAAOA,EAAOyK,QAAQvM,GAAS,GAC7C,OAACsM,EAEEA,EAAU3O,MAAM,GAAK,EAFL7G,CAEK,GAC3BiV,IAGS,eAAVP,EAAE9S,KACJ8S,EAAEa,iBACKV,GAAS7U,IACd,MAAMkJ,EAAQ8B,EAAOpB,MAClBC,GAAUA,EAAMhD,MAAM,IAAM7G,GAAS6J,EAAMhD,MAAM,GAAK7G,IAErD,IAACkJ,EAAc,OAAAlJ,EAEnB,MAAM0V,EAAY1K,EAAOA,EAAOyK,QAAQvM,GAAS,GAC7C,OAACwM,EAEEA,EAAU7O,MAAM,GAFA7G,CAEE,GACxBiV,SAGS,UAAVP,EAAE9S,MACJ8S,EAAEa,iBACFF,EAAWpB,MAGf,CAAC5O,EAAM2F,EAAQiJ,IAGX0B,GAAelB,EAAAA,GAAAA,KAAazU,GACxB0U,IACN,MAAMC,EAAUL,EAAkBF,QAClC,IAAKO,EAAS,OAER,QAAEhW,EAAGW,EAAAA,GAAMoV,EACb/V,IAAMgW,EAAQhW,GAAKW,IAAMqV,EAAQrV,GAErCuV,EAAQ7U,EAAM,GAEf,IAWI,OATP4U,EAAAA,GAAAA,KAAU,KACJvQ,EAAAzR,EAAWwK,iBAAiB,UAAWkY,EAAW,CAAEM,SAAS,IAAMhjB,EAC7D0K,oBAAoB,UAAWgY,EAAW,CAAEM,SAAS,IAExD,KACLhjB,EAAK0K,oBAAoB,UAAWgY,EAAW,CAAEM,SAAS,GAAO,IAElE,CAACvR,EAAMiR,IAEHO,GAAAA,EAAA;wBACgBnB,GAAkBA,EAAEa;;;YAGjCvK,EAAOpE,KACNsC,GACC2M,GAAAA,EAAA;sBACQ3M,EAAMtH;8BACE,IAAMiT,EAAQ3L,EAAMrC,MAAM,GAAIoO;wBACpChB,GAAc/K,EAAMrC,MAAM,IAClCoN,EAAa/K,EAAMrC,MAAM,GACrB,WACA;;kBAEFqC,EAAMO;;;;6CAKqB+K;UACnCxJ,EAAOpE,KAAKsC,GACL2M,GAAAA,EAAA;uBACM3M,EAAMtH;oBACTsH,EAAMO;;kBAERP,EAAMK,MAAM3C,KACXyC,GACCwM,GAAAA,EAAA;4BACQxM,EAAKzH;mCACEyH,EAAKrJ;8BACViU,IAAe5K,EAAKrJ,MAAQ,QAAU;qCAC/B2V,EAAatM,EAAKrJ;oCACnB,KA/MpC,IAAAlD,EAgNwB,OAAKA,EAAAiX,EAAAK,QACFc,cAAc,gBAAgB7L,EAAKrJ,aAClClD,EAAAgZ,UAAUC,IAAI;kCAER,KApNlC,IAAAjZ,EAqNwB,OAAKA,EAAAiX,EAAAK,QACFc,cAAc,gBAAgB7L,EAAKrJ,aAClClD,EAAAgZ,UAAU1R,OAAO,UACrBiR,EAAWhM,EAAKrJ,MAAM;;wBAGtBqJ,EAAK0F;8BACC1F,EAAKI;;;;;;;GAMzB,EAMVqB,GAAcpI,MAAQ,CACpBzF,IAAKxK,OACLsY,OAAQtY,OACR4R,KAAM2R,QACNpW,OAAQqW,OACR5Q,KAAMxS,UAGK,MAAAqjB,IAAcC,EAAAA,GAAAA,GAAErL,I,IEhP7BsL,GAAAC,GAAAC,G,0TAWa,MAAAC,GCQN,SAAsDC,GAC3D,MAAMC,GAAYzf,EAAAA,EAAAA,IAChB,CAAC,EACD,GAAGwf,gBAECE,GAAcxU,EAAAA,EAAAA,KAAQjF,IAC1B,MAAMuF,EAAOvF,EAAI0E,IAAI8U,EAAU7U,KAC/B,OAAO,IAAIa,EAAAA,GAAO,CAChBb,IAAK,IAAIQ,EAAAA,GAAU,GAAGoU,cACnBhU,GACH,IAEEzO,EAAS,CAAC0iB,EAAWC,GAYpB,OAXP3iB,EAAO6N,IAAM6U,EAAU7U,IACvB7N,EAAO+R,UAAY4Q,EAAY9U,IAC/B6U,EAAU7f,KAAO,CACfE,QAAS,yBACTQ,YAAa,kBAAkBkf,KAEjCE,EAAY9f,KAAO,CACjBE,QAAS,yBACTQ,YAAa,gBAAgBkf,KAGxBziB,CACT,CDjCoB4iB,CAAa,cAOpBC,IAAU5f,EAAAA,EAAAA,IACrB,CACEqN,KAAMA,OACNgB,KAAMA,QAER,eAGFwR,EAAAA,GAAAA,GAAe,sBAAuBX,IAOtC,MAAMY,GAKJ5b,WAAAA,CAAY+B,EAAU9E,EAAkB4S,GAJ/BgM,GAAA,KAAAX,IACAW,GAAA,KAAAV,IAC6BU,GAAA,KAAAT,GAAA,MAiEtC,KAAAtS,OAAU7L,IACH6e,GAAA,KAAAX,IAAerS,OAAO7L,EAAK,EAGlC,KAAAkM,KAAQnN,IACN+f,GAAA3hB,KAAKghB,GAAuBpf,GAC5B8f,GAAA1hB,KAAK8gB,IAASxW,OAAS,GACvBoX,GAAA1hB,KAAK+gB,IAAehS,MAAK,EAG3B,KAAAgB,KAAO,KACL4R,GAAA3hB,KAAKghB,GAAuB,MAC5BU,GAAA1hB,KAAK+gB,IAAehR,MAAK,EAG3B,KAAAnB,QAAU,KACR8S,GAAA1hB,KAAK+gB,IAAenS,UACpB8S,GAAA1hB,KAAK8gB,IAAShS,QAAO,EA/EhB6S,GAAA,KAAAb,GAAW,IAAIF,IACfc,GAAA,KAAAZ,IAAS/Q,KAAO/P,KAAK+P,KAC1B2R,GAAA1hB,KAAK8gB,IAASnZ,IAAMA,EACpB+Z,GAAA1hB,KAAK8gB,IAASrL,OAASA,EAEvB,MAAMpY,EAAO2C,KACR2hB,GAAA,KAAAZ,GAAiB,IAAItQ,GAAc,CACtCxN,QAASye,GAAK,KAAAZ,IACd5iB,SAAU,GACV4U,UAAAA,CAAgC8O,GAE5B,IAAAC,EAAAA,GAAAA,GAAcD,EAAKje,MAAM6E,aACzBsZ,EAAAA,GAAAA,GAASF,EAAKje,MAAM6E,WAEb,SAET,MAAMuZ,EAAc/hB,KAAK+R,WAAW6P,GAAO9f,GACzC,CAAC,YAAa,WAAWwR,SAASxR,EAAKtB,KAAKuB,QAG1C,GAAe,MAAfggB,EAA4B,SAEhC,MAAMngB,EAAM8f,GAAKrkB,EAAA2jB,IAMb,OAJCU,GAAArkB,EAAAyjB,IAASxW,OAASyX,EAAYC,WAAW,KAC1CD,EAAY9gB,MAAM,GAClB8gB,EAEe,kBAARngB,EAEPggB,EAAKje,MAAME,IAAIqG,QAAQtI,GAAKE,SAC5B8f,EAAKje,MAAME,IAAIqG,QAAQ0X,EAAKje,MAAM6E,UAAU6I,MAAMvP,SAElD6f,GAAAtkB,EAAK2jB,GAAuB,OAErB,KAMNe,EAAYC,WAAW,IAErB,EAETvS,OAAQ,MAGLiS,GAAA,KAAAX,IAAe9P,OAAS,KAC3ByQ,GAAA1hB,KAAK8gB,IAAS/R,MAAO,GAElB2S,GAAA,KAAAX,IAAe7P,OAAS,KAC3BwQ,GAAA1hB,KAAK8gB,IAAS/R,MAAO,GAEvB/O,KAAK0O,OAAO7L,GAER8E,EAAAsF,IAAIqU,GAAQhV,IAAK,CACnByC,KAAOnN,GAAQ5B,KAAK+O,KAAKnN,GACzBmO,KAAMA,IAAM/P,KAAK+P,QAClB,EAhEM+Q,GAAA,IAAA3U,QACA4U,GAAA,IAAA5U,QACT6U,GAAA,IAAA7U,QEzBF,MAAM8V,GAAoDC,IAIpD,IAJqD,MACzDC,EAAA,QACAC,EAAA,WACAC,GACIH,EACJ,MAAMI,GAAMrD,EAAAA,GAAAA,OACZK,EAAAA,GAAAA,KAAU,KAjBZ,IAAA9X,EAkBI,OAAIA,EAAA8a,EAAAxD,UAAStX,EAAAgZ,UAAU1R,OAAO,aAazB,OAAAyR,GAAAA,EAAA;;;cAGK+B;sBAdSlD,IApBvB,IAAA5X,EAqBI4X,EAAEa,iBACFb,EAAEmD,kBACF,OAAI/a,EAAA8a,EAAAxD,UAAStX,EAAAgZ,UAAUC,IAAI;oBAEVrB,IAzBrB,IAAA5X,EA0BI4X,EAAEa,iBACFb,EAAEmD,kBACF,MAAAJ,GAAAA,IACA,OAAI3a,EAAA8a,EAAAxD,UAAStX,EAAAgZ,UAAU1R,OAAO;;;WAUxB,MAAAsT,OAAA,EAAAA,MAAeI,GAAAA;;qCAEW,MAAAH,OAAA,EAAAA,MAAkBI,GAAAA;;GAAQ,EAK9DR,GAAqB7U,MAAQ,CAC3B2B,KAAM2R,QACNyB,MAAO5kB,SACP6kB,QAAS7kB,SACT8kB,WAAY9kB,UAGD,MAAAmlB,IAAqB7B,EAAAA,GAAAA,GAAEoB,I,ICrDpCU,GAAAC,GAAA7c,G,0TAcO,MAAM8c,GAKXjd,WAAAA,CAAY+B,EAAU8N,GAJtB5P,GAAA,KAAA8c,IACA9c,GAAA,KAAA+c,IACS/c,GAAA,KAAAE,IAoCT,KAAA2I,OAAS,KACP5H,GAAA9G,KAAK4iB,IAAUlU,QAAO,EAGxB,KAAAE,QAAU,KACR9H,GAAA9G,KAAK4iB,IAAUhU,UACf9H,GAAA9G,KAAK2iB,IAAS7T,QAAO,EAGvB,KAAAqT,MAAQ,KACN,MAAMxa,EAAMb,GAAK,KAAAf,IACXlD,EAAO8E,EAAI0E,IAAIE,EAAAA,IAChB1J,EAAK2P,YAAS3P,EAAQ0E,QAErB,YAAE5D,EAAO0D,SAAAA,GAAaxE,EACtB4E,EAASX,GAAA9G,KAAK4iB,IAAUnb,OAC9B,IAAKA,EAAQ,OAEb,MACM7F,EADO6F,EAAOL,KACHxF,IAAM6F,EAAO3F,KAAKghB,SAC/B,IAAArgB,EAAKkB,EAAMlB,GAAGsgB,OAAOnhB,EAAKkY,GAAAA,GAAgBtZ,KAAKmH,GAAKR,UACnD1E,EAAAA,EAAG6E,aAAa6K,EAAAA,GAAcuL,KAAKjb,EAAGoB,IAAIqG,QAAQtI,KAC9CyF,EAAA5E,EAAGqS,kBAEZhO,GAAA9G,KAAK4iB,IAAU7S,OACfpI,EAAI0E,IAAIiV,GAAQhV,KAAKyC,KAAKtM,EAAG+F,UAAU6I,KAAK,EA1D5CxK,GAAA7G,KAAK+F,GAAO4B,GACN,MAAA1E,EAAU,IAAIyf,GACpB7b,GAAA7G,KAAK2iB,GAAW1f,GACX6D,GAAA,KAAA6b,IAASR,MAAQniB,KAAKmiB,MACtBrb,GAAA,KAAA6b,IAASP,QAAkB,MAAR3M,OAAQ,EAAAA,EAAAuN,cAC3Blc,GAAA,KAAA6b,IAASN,WAAqB,MAAR5M,OAAQ,EAAAA,EAAAwN,eAC9Bpc,GAAA,KAAA+b,GAAY,IAAI/U,GAAc,CACjClG,MACA1E,UACA+M,UAAWA,IAAM,GACjBE,aAAcgT,IAA0B,IAAzB,OAAEzb,EAAA,SAAQyH,GAAegU,EACtC,GAA8B,YAA1Bzb,EAAO3F,KAAKtB,KAAKuB,KAA2B,aAEhD,IAAIohB,EAAkB,EACf1b,EAAA3F,KAAKshB,aAAathB,IACvBqhB,GAAmBrhB,EAAKoB,UAAA,IAE1B,MAAM8B,EAAMyC,EAAOS,GACbmb,EAAUre,EAAImD,wBACdmb,EAAapU,EAAS/G,wBACtB2H,EAAQhE,OAAOyX,iBAAiBve,GAChCwe,EAAaC,OAAOzmB,SAAS8S,EAAM0T,WAAY,KAAO,EACtDE,EAAgBD,OAAOzmB,SAAS8S,EAAM4T,cAAe,KAAO,EAC5DhY,EAAS2X,EAAQ3X,OAAS8X,EAAaE,EACvCC,EAAeL,EAAW5X,OAChC,OAAOyX,EAAkB,GAAKQ,EAAejY,EACzC,aACA,WAGR1L,KAAK0O,QAAO,EAnCdiU,GAAA,IAAAxW,QACAyW,GAAA,IAAAzW,QACSpG,GAAA,IAAAoG,SAiEXoV,EAAAA,GAAAA,GAAe,wBAAyBmB,IC9B3B,MAAAkB,GAAuDA,CAClEC,EACApO,KAGGoO,EAAApO,QAAQ9N,GD0BG,SACdA,EACA8N,GAEI9N,EAAAsF,IAAIxL,EAAY6K,IAAK,CACvB3K,YAAcC,KACGC,EAAAA,EAAAA,KAAYC,GACzB,CAAC,QAAS,aAAc,eAAewR,SAASxR,EAAKtB,KAAKuB,OAD7CF,CAEbD,KAMF+F,EAAAsF,IAAIsD,GAAMjE,IAAK,CACjBzJ,KAAMA,IAAM,IAAIggB,GAAgBlb,EAAK8N,IAEzC,CC3CqBqO,CAAqBnc,EAAK8N,KAC1CA,QAAQ9N,GJ/BG,SAAcA,EAAU8N,GAClC9N,EAAAsF,IAAIgU,GAAK3U,IAAK,CAChBzJ,KAAOA,GAAS,IAAI2e,GAAS7Z,EAAK9E,EAAM4S,IAE5C,CI2BqBsO,CAAcpc,EAAK8N,KACnCuO,IAAI1C,IACJ0C,IAAIzT,IACJyT,IAAI/C,GAAK,C,2cC3DE,SAAA7f,EACdC,EACAC,GASO,OAPPnE,OAAOoE,OAAOF,EAAQ,CACpBC,KAAM2iB,EAAA,CACJziB,QAAS,wBACNF,KAIAD,CACT,C,6UCVO,MAAM6iB,EAAkB,cAElBnH,GAAmBoH,EAAAA,EAAAA,IAAY,eAAe,KAClD,CACLC,QAAQ,EACRxQ,MAAO,QACPyQ,YAAY,EACZ/T,WAAW,EACXgU,WAAW,EACXC,MAAO,GACPC,MAAM,EACNC,SAAU,IACVphB,MAAO,CACLqhB,IAAK,CAAEC,QAAS,IAChBriB,QAAS,CAAEqiB,QAAS,IACpBC,MAAO,CAAED,QAAS,IAEpBE,SAAU,CACR,CACEC,IAAK,kBAAkBZ,MACvBa,SAAW/f,IAxBnB,IAAAwC,EAyBU,KAAMxC,aAAeggB,aAAc,MAAMC,EAAAA,EAAAA,IAAmBjgB,GAErD,OACL0f,IAAK1f,EAAIkgB,aAAa,QAAU,GAChC5iB,QAAS0C,EAAIkgB,aAAa,YAAc,GACxCN,MAAOnB,OAAO,OAAAjc,EAAAxC,EAAIkgB,aAAa,UAAjB1d,EAA6B,GAC7C,IAIN2d,MAAQrjB,GAAS,CAAC,MAAOsjB,EAAE,aAAalB,GAAoBpiB,EAAKuB,QACjEgiB,cAAe,CACbC,MAAOzV,IAAA,IAAC,KAAErP,GAAAqP,EAAA,MAAoB,gBAATrP,CAAS,EAC9B+kB,OAAQA,CAAC5hB,EAAO7B,EAAMtB,KACpB,MAAMkkB,EAAM5iB,EAAK0jB,IACXljB,EAAUR,EAAK2jB,MACrB,IAAIb,EAAQnB,OAAQ3hB,EAAK4jB,KAAkB,IACvCjC,OAAOkC,MAAMf,IAAoB,IAAVA,KAAqBA,EAAA,GAEhDjhB,EAAMiiB,QAAQplB,EAAM,CAClBkkB,MACApiB,UACAsiB,SACA,GAGNiB,WAAY,CACVP,MAAQxjB,GAA4B,gBAAnBA,EAAKtB,KAAKuB,KAC3BwjB,OAAQA,CAAC5hB,EAAO7B,KACd6B,EAAMmiB,SAAS,aACTniB,EAAAiiB,QAAQ,aAAS,OAAW,EAAW,CAC3CH,MAAO3jB,EAAKuB,MAAMf,QAClBkjB,IAAK1jB,EAAKuB,MAAMqhB,IAChBgB,IAAK,GAAGjC,OAAOsC,WAAWjkB,EAAKuB,MAAMuhB,OAAOoB,QAAQ,OAEtDriB,EAAMsiB,WAAU,OCvDxB,SAASC,EAAWC,GACX,OAAAC,EAAAA,EAAAA,IACLD,EACA,aACA,CACErkB,EACA4I,EACAkI,KAZN,IAAApL,EAAAqH,EAcM,GAA8B,KAA1B,OAAArH,EAAK1F,EAAAukB,eAAU,EAAA7e,EAAA7C,QAAc,OAC3B,MAAAxB,EAAa,OAAA0L,EAAK/M,EAAAukB,eAAW,EAAAxX,EAAA,GACnC,IAAK1L,GAAkC,UAApBA,EAAW3C,KAAkB,OAEhD,MAAM,IAAEglB,EAAA,IAAKE,EAAKD,MAAAA,GAAUtiB,EAKtBmjB,EAAU,CACd9lB,KAAM,cACNglB,MACAE,MACAD,SAGF7S,EAAOyT,SAASE,OAAO7b,EAAO,EAAG4b,EAAQ,GAG/C,CDiCAllB,EAAS2b,EAAiBjb,KAAM,CAC9BE,YAAa,0BACb4R,MAAO,eCjCF,MAAM4S,GAAyBC,EAAAA,EAAAA,IACpC,sBACA,IAAM,IAAMP,IAGd9kB,EAASolB,EAAuBnlB,OAAQ,CACtCW,YAAa,2BACb4R,MAAO,eAGTxS,EAASolB,EAAuBnoB,QAAS,CACvC2D,YAAa,iCACb4R,MAAO,eChCF,MAAM8S,EAA4C,CACvD5J,UAAWA,IAAM,eACjB6J,YAAaA,IAAM,eACnBC,aAAcA,IAAMrG,EAAAA,EAAA,cACpBsG,cAAeA,IAAMtG,EAAAA,EAAA,YACrBuG,sBAAuB,8BACvBC,uBAAwB,gBACxBC,SAAWC,GAASC,QAAQhd,QAAQid,IAAIC,gBAAgBH,KAG7CI,GAAmB3lB,EAAAA,EAAAA,IAC9BglB,EACA,uBAGFtlB,EAASimB,EAAkB,CACzBrlB,YAAa,sBACb4R,MAAO,eCXT,IAAI0T,EAAgB,EAEpB,MAAMC,GAASC,EAAAA,EAAAA,IAAe,UAAW,GAE5BC,EAAiDvE,IAQxD,IARyD,IAC7DwB,EAAM,WACNpiB,EAAU,SACVsiB,EAAQ,WACR8C,GAAW,WACXC,GAAW,UACXC,EAAA,OACAnS,GACIyN,EACJ,MAAM2E,GAAQ5I,EAAAA,EAAAA,MACR6I,GAAe7I,EAAAA,EAAAA,MACf8I,GAAY9I,EAAAA,EAAAA,OACX+I,EAAaC,IAAkBpJ,EAAAA,EAAAA,IAASvc,EAAQqC,OAAS,IACzDujB,EAAiBC,IAAsBtJ,EAAAA,EAAAA,IAAwB,IAAf6F,EAAI/f,SACpDyjB,IAAQvJ,EAAAA,EAAAA,IAAS0I,MACjBc,EAAgBC,IAAqBzJ,EAAAA,EAAAA,KAAS,IAC9C0J,EAAaC,IAAkB3J,EAAAA,EAAAA,IAAS6F,IC9B1C,SAAwBxC,GAOnB,IAPmB,MAC7B2F,EAAA,aACAC,EAAA,MACAlD,EAAA,SACA6D,EAAA,IACA/D,EAAA,SACAiD,GACUzF,EACV,MAAMzD,GAAOC,EAAAA,EAAAA,MACPphB,GAAOqY,EAAAA,EAAAA,KAAQ,IAAM8I,EAAKK,QAAQC,eAA8B,CAACN,KAEvEa,EAAAA,EAAAA,KAAU,KACR,MAAMoJ,EAAWb,EAAM/I,QAClB4J,WAEEA,EAASpgB,QAAQqgB,cACjBD,EAASpgB,QAAQoD,OACxBgd,EAAS5Y,MAAMpE,OAAS,MACvB,CAACgZ,KAEJpF,EAAAA,EAAAA,KAAU,KACR,MAAMsJ,EAAkBd,EAAahJ,QAC/B4J,EAAWb,EAAM/I,QACnB,IAAC8J,IAAoBF,EAAU,OAC7B,MAAAG,EAAUzJ,IACdA,EAAEa,iBACI,MAAAlW,EAAM2e,EAASvgB,wBAAwB4B,IACvC2B,EAAS0T,EAAE3V,QAAUM,EACrB+e,EAAIrF,OAAO/X,EAAS,IAAM,IAAMA,GAAQsa,QAAQ,GACtD0C,EAASpgB,QAAQoD,OAASod,EACjBJ,EAAA5Y,MAAMpE,OAAS,GAAGod,KAAK,EAE5BC,EAAYA,KACXzrB,EAAA0K,oBAAoB,cAAe6gB,GACnCvrB,EAAA0K,oBAAoB,YAAa+gB,GACtC,MAAMC,EAAevF,OAAOiF,EAASpgB,QAAQqgB,QACvCM,EAAgBxF,OAAOiF,EAASpgB,QAAQoD,QACxCwd,EAAQzF,OAAOsC,WACnBtC,OAAOwF,EAAgBD,GAAchD,QAAQ,IAE3CvC,OAAOkC,MAAMuD,IAEjBT,EAASS,EAAM,EAGXC,EAAe/J,IACfuI,IACJvI,EAAEa,iBACG3iB,EAAAwK,iBAAiB,cAAe+gB,GAChCvrB,EAAAwK,iBAAiB,YAAaihB,GAAU,EAGzCK,EAAUhK,IACd,MAAMiK,EAAW5K,EAAKK,QAAQ3W,wBAAwBoB,MACtD,IAAK8f,EAAU,OAEf,MAAMnW,EAASkM,EAAElM,OACXxH,EAASwH,EAAOxH,OAChBnC,EAAQ2J,EAAO3J,MACf+f,EACJ/f,EAAQ8f,EAAW3d,EAAS2d,GAAY3d,EAASnC,GAC7Cuf,GAAKQ,EAAoB1E,GAAOoB,QAAQ,GAC9C0C,EAASpgB,QAAQqgB,OAASW,EAAkBtD,QAAQ,GACpD0C,EAASpgB,QAAQoD,OAASod,EACjBJ,EAAA5Y,MAAMpE,OAAS,GAAGod,KAAK,EAKlC,OAFSJ,EAAA5gB,iBAAiB,OAAQshB,GAClBR,EAAA9gB,iBAAiB,cAAeqhB,GACzC,KACIT,EAAA1gB,oBAAoB,OAAQohB,GACrBR,EAAA5gB,oBAAoB,cAAemhB,EAAY,CACjE,GACC,GACL,CD1CiBI,CAAA,CACb1B,QACAC,eACAlD,QACA6D,SAAWe,GAAM,MAAA5B,OAAA,EAAAA,EAAU,QAAS4B,GACpC9E,MACAiD,cAGFrI,EAAAA,EAAAA,KAAU,KACJoI,GAEWO,EAAA3lB,EAAQqC,OAAS,EAAE,GACjC,CAAC+iB,IAEE,MA8CA+B,EAAqBA,KAxG7B,IAAAjiB,EAAAqH,EAyGI,MAAA+Y,GAAAA,EAAU,MAAO,OAAA/Y,EAAA,OAAArH,EAAAugB,EAAUjJ,cAAV,EAAAtX,EAAmBjH,OAASsO,EAAA,KAOzC6a,EAAetK,IACnBA,EAAEa,iBACFb,EAAEmD,iBAAgB,EAGpB,OAAOhC,EAAAA,EAAmB,gBAAAoJ,EAAAA,EAAAA,GAAKjC,GAAY;kBAC5BiC,EAAAA,EAAAA,GAAK,aAAcjF,EAAI/f,OAAS,GAAK;gCACtB,MAAA8Q,OAAA,EAAAA,EAAQqH;oBACrB6M,EAAAA,EAAAA,GAAK,gBAAiBtB,GAAkB;;gBAE3CN;;wBAEQ2B;qBACH/B;;kBAEHY;oBAhDInJ,IAClB,MACM7e,EADS6e,EAAElM,OACI3S,MACF4nB,EAAiB,IAAjB5nB,EAAMoE,QACzB6jB,EAAejoB,EAAM;sBAyBJ6e,IACH,UAAVA,EAAE9S,KAAoCmd,GAAA;oBAqB1B,IAAMnB,GAAkB;mBACzB,IAAMA,GAAkB;;sBAEtBqB,EAAAA,EAAAA,GAAK,cAAezB,GAAmB;;uBAErCP;;iBAENS;;;uBAnDShJ,IAAkBwK,O,OAAA,E,EAAA,K,EAAA,YAtF5C,IAAApiB,EAuFI,MAAMyf,EAAQ,OAAAzf,EAAA4X,EAAElM,OAA4B2W,YAAQ,EAAAriB,EAAA,GACpD,IAAKyf,EAAM,OAEL,MAAAzB,QAAY,MAAA/P,OAAA,EAAAA,EAAQuR,SAASC,GAC9BzB,IAEL,MAAAoC,GAAAA,EAAU,MAAOpC,GACjB2C,GAAmB,GAAI,E,yMACzB;;wCA+CsCC;cAC1B,MAAA3S,OAAA,EAAAA,EAAQmR;;uCAEiB,KAjJvC,IAAApf,EAiJ6C,cAAAA,EAAAugB,EAAUjJ,cAAS,EAAAtX,EAAAD,OAAA;cAClD,MAAAkO,OAAA,EAAAA,EAAQqR;;;;;iBAKN6C,EAAAA,EAAAA,GAAK,UAAkC,IAAvBpB,EAAY5jB,QAAgB;kBAC1C,IAAM8kB;;UAEd,MAAAhU,OAAA,EAAAA,EAAQoR;;;kBAGD8C,EAAAA,EAAAA,GAAK,gBAAgC,IAAfjF,EAAI/f,QAAgB;;oDA5DhCya,IACvBA,EAAEa,iBACFb,EAAEmD,kBACEoF,GACWM,GAAC5e,IAAOA,GAAE;YA2DjB,MAAAoM,OAAA,EAAAA,EAAQkR;;;;cAINkB;oBACM3D;cACNQ;cACApiB;gBACEsiB;;iBAECkD;;;;oBAIG4B;eACNC,EAAAA,EAAAA,GAAK,iBAAkB3B,GAAe;oBAChC,MAAAvS,OAAA,EAAAA,EAAQsR;gBAtHT3H,IACf,MACM7e,EADS6e,EAAElM,OACI3S,MACjB+mB,GAAcxb,OAAAzL,aAAainB,GAEvBA,EAAAxb,OAAOnM,YAAW,KACxB,MAAAioB,GAAAA,EAAU,UAAWrnB,EAAA,GACpB,IAAK;eAGa6e,IACrB,MACM7e,EADS6e,EAAElM,OACI3S,MACjB+mB,IACFxb,OAAOzL,aAAainB,GACZA,EAAA,GAGV,MAAAM,GAAAA,EAAU,UAAWrnB,EAAA;cAuGX+B;;UAAO,EAKrBmlB,EAAera,MAAQ,CACrBsX,IAAK/D,OACLre,QAASqe,OACTiE,MAAOnB,OACPiE,SAAUhH,QACViH,SAAUjH,QACVkH,QAASrqB,SACTkY,OAAQtY,SE/LM,SACd2sB,EACA1f,GAEM,MAAA0U,EAAUiL,eAAe1d,IAAIyd,GACpB,MAAXhL,EAKAA,IAAY1U,GAGR4f,QAAAC,KAAK,kBAAkBH,8BAPdC,eAAAG,OAAOJ,EAAS1f,EAQnC,CCJAmX,CAAe,wBHwLaV,EAAAA,EAAAA,GAAE4G,IGvLvB,MAAM0C,GAAiBC,EAAAA,EAAAA,IAC5BrN,EAAiBjb,MAChB6F,GACQ,CAAC0iB,EAAaxnB,EAAMynB,KACzB,MAAMtlB,EAAMlB,SAASI,cACnB,wBAEIuR,EAAS9N,EAAI0E,IAAIgb,EAAiB/a,KAClCie,EAAc9U,EAAO8U,YACrBC,EAAa1oB,IACjB,GAAKyoB,EAEE,CACL,MAAME,EAAaF,EAAYzoB,EAAKuB,MAAMqhB,KAChB,kBAAf+F,EACTzlB,EAAI0f,IAAM+F,EAECA,EAAA7a,MAAM4V,IACfxgB,EAAI0f,IAAMc,CAAA,GAEd,MATIxgB,EAAA0f,IAAM5iB,EAAKuB,MAAMqhB,IAWnB1f,EAAA4f,MAAQ9iB,EAAKuB,MAAMuhB,MACnB5f,EAAA1C,QAAUR,EAAKuB,MAAMf,QAErB0C,EAAA2iB,UAAY9kB,EAAKsG,QAAA,EAYhB,OATPqhB,EAAUH,GACVrlB,EAAI0iB,UAAW,EACX1iB,EAAA4iB,QAAU,CAAC8C,EAAMnqB,KACnB,MAAMqB,EAAM0oB,IACD,MAAP1oB,GAECiB,EAAAwE,SAASxE,EAAKc,MAAMlB,GAAGkoB,iBAAiB/oB,EAAK8oB,EAAMnqB,GAAO,EAEjEyE,EAAIyQ,OAASA,EACN,CACLzQ,MACA0J,OAASkc,GACHA,EAAYpqB,OAAS6pB,EAAY7pB,OAErCgqB,EAAUI,IACH,GAETC,UAAYzL,GACNA,EAAElM,kBAAkB4X,iBAI1BC,WAAYA,KACV/lB,EAAI0iB,UAAW,GAEjBsD,aAAcA,KACZhmB,EAAI0iB,UAAW,GAEjB9Y,QAASA,KACP5J,EAAI8J,QAAO,EAEf,IAKN1N,EAAS+oB,EAAgB,CACvBnoB,YAAa,wBACb4R,MAAO,eClEF,MAAMqX,EAAwC,CACnDzE,EACAzJ,EACAoN,EACA9C,GACA6D,M,8BCdK,SAASrJ,EAAcrZ,GAE5B,MAAqB,eADRA,EAAUgJ,MAAMoB,OAAOpS,KACxBuB,IACd,CAEO,SAAS+f,EAAStZ,GAPzB,IAAAhB,EAQQ,MAAAhH,EAAO,OAAAgH,EAAAgB,EAAUgJ,MAAM1P,KAAK0G,EAAUgJ,MAAM/G,MAAQ,SAAI,EAAAjD,EAAAhH,KAC9D,MAAsB,eAAf,MAAAA,OAAA,EAAAA,EAAMuB,KACf,CAEgB,SAAAwf,EACduI,EACA1f,GAEmC,MAA/B2f,eAAe1d,IAAIyd,IACNC,eAAAG,OAAOJ,EAAS1f,EACnC,C","sources":["../node_modules/lodash.throttle/index.js","../node_modules/@milkdown/plugin-block/src/__internal__/with-meta.ts","../node_modules/@milkdown/plugin-block/src/block-config.ts","../node_modules/@milkdown/plugin-block/src/__internal__/serialize-for-clipboard.ts","../node_modules/@milkdown/plugin-block/src/block-service.ts","../node_modules/@milkdown/plugin-block/src/__internal__/select-node-by-dom.ts","../node_modules/@milkdown/plugin-block/src/block-plugin.ts","../node_modules/@milkdown/plugin-block/src/block-provider.ts","../node_modules/@milkdown/plugin-block/src/index.ts","../node_modules/@milkdown/plugin-slash/src/slash-provider.ts","../node_modules/@milkdown/crepe/src/feature/block-edit/menu/group-builder.ts","../node_modules/@milkdown/crepe/src/feature/block-edit/menu/utils.ts","../node_modules/@milkdown/crepe/src/feature/block-edit/menu/component.ts","../node_modules/@milkdown/crepe/src/feature/block-edit/menu/config.ts","../node_modules/@milkdown/crepe/src/feature/block-edit/menu/index.ts","../node_modules/@milkdown/plugin-slash/src/slash-plugin.ts","../node_modules/@milkdown/crepe/src/feature/block-edit/handle/component.ts","../node_modules/@milkdown/crepe/src/feature/block-edit/handle/index.ts","../node_modules/@milkdown/crepe/src/feature/block-edit/index.ts","../node_modules/@milkdown/components/src/__internal__/meta.ts","../node_modules/@milkdown/components/src/image-block/schema.ts","../node_modules/@milkdown/components/src/image-block/remark-plugin.ts","../node_modules/@milkdown/components/src/image-block/config.ts","../node_modules/@milkdown/components/src/image-block/view/component.ts","../node_modules/@milkdown/components/src/image-block/view/event.ts","../node_modules/@milkdown/components/src/__internal__/helper.ts","../node_modules/@milkdown/components/src/image-block/view/index.ts","../node_modules/@milkdown/components/src/image-block/index.ts","../node_modules/@milkdown/crepe/src/utils/index.ts"],"sourcesContent":["/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = throttle;\n","import type { Meta, MilkdownPlugin } from '@milkdown/ctx'\n\nexport function withMeta<T extends MilkdownPlugin>(\n  plugin: T,\n  meta: Partial<Meta> & Pick<Meta, 'displayName'>\n): T {\n  Object.assign(plugin, {\n    meta: {\n      package: '@milkdown/plugin-block',\n      ...meta,\n    },\n  })\n\n  return plugin\n}\n","import type { Node, ResolvedPos } from '@milkdown/prose/model'\nimport { $ctx } from '@milkdown/utils'\n\nimport { findParent } from '@milkdown/prose'\nimport { withMeta } from './__internal__/with-meta'\n\n/// @internal\nexport type FilterNodes = (pos: ResolvedPos, node: Node) => boolean\n\n/// @internal\nexport const defaultNodeFilter: FilterNodes = (pos) => {\n  const table = findParent((node) => node.type.name === 'table')(pos)\n  if (table) return false\n\n  return true\n}\n\n/// A slice contains the block config.\n/// Possible properties:\n/// - `filterNodes`: A function to filter nodes that can be dragged.\nexport const blockConfig = $ctx<{ filterNodes: FilterNodes }, 'blockConfig'>(\n  { filterNodes: defaultNodeFilter },\n  'blockConfig'\n)\n\nwithMeta(blockConfig, {\n  displayName: 'Ctx<blockConfig>',\n})\n","/**\n * Copy pasted from https://github.com/ProseMirror/prosemirror-view/blob/master/src/clipboard.ts\n */\n\nimport type { NodeType, Slice } from '@milkdown/prose/model'\nimport { DOMSerializer } from '@milkdown/prose/model'\nimport type { EditorView } from '@milkdown/prose/view'\n\nlet _detachedDoc: Document | null = null\nfunction detachedDoc() {\n  return (\n    _detachedDoc ||\n    (_detachedDoc = document.implementation.createHTMLDocument('title'))\n  )\n}\n\nconst wrapMap: { [node: string]: string[] } = {\n  thead: ['table'],\n  tbody: ['table'],\n  tfoot: ['table'],\n  caption: ['table'],\n  colgroup: ['table'],\n  col: ['table', 'colgroup'],\n  tr: ['table', 'tbody'],\n  td: ['table', 'tbody', 'tr'],\n  th: ['table', 'tbody', 'tr'],\n}\n\nexport function serializeForClipboard(view: EditorView, slice: Slice) {\n  const context = []\n  let { openStart, openEnd, content } = slice\n  while (\n    openStart > 1 &&\n    openEnd > 1 &&\n    content.childCount === 1 &&\n    content.firstChild!.childCount === 1\n  ) {\n    openStart -= 1\n    openEnd -= 1\n    const node = content.firstChild!\n    context.push(\n      node.type.name,\n      node.attrs !==\n        (node.type as NodeType & { defaultAttrs: unknown }).defaultAttrs\n        ? node.attrs\n        : null\n    )\n    content = node.content\n  }\n\n  const serializer =\n    view.someProp('clipboardSerializer') ||\n    DOMSerializer.fromSchema(view.state.schema)\n  const doc = detachedDoc()\n  const wrap = doc.createElement('div')\n  wrap.appendChild(serializer.serializeFragment(content, { document: doc }))\n\n  let firstChild = wrap.firstChild\n  let needsWrap\n  let wrappers = 0\n  while (\n    firstChild &&\n    firstChild.nodeType === 1 &&\n    (needsWrap = wrapMap[firstChild.nodeName.toLowerCase()])\n  ) {\n    for (let i = needsWrap.length - 1; i >= 0; i--) {\n      const wrapper = doc.createElement(needsWrap[i] as string)\n      while (wrap.firstChild) wrapper.appendChild(wrap.firstChild)\n      wrap.appendChild(wrapper)\n      wrappers++\n    }\n    firstChild = wrap.firstChild\n  }\n\n  if (firstChild && firstChild.nodeType === 1) {\n    ;(firstChild as HTMLElement).setAttribute(\n      'data-pm-slice',\n      `${openStart} ${openEnd}${wrappers ? ` -${wrappers}` : ''} ${JSON.stringify(context)}`\n    )\n  }\n\n  const text =\n    view.someProp('clipboardTextSerializer', (f) => f(slice, view)) ||\n    slice.content.textBetween(0, slice.content.size, '\\n\\n')\n\n  return { dom: wrap, text }\n}\n","import type { Ctx } from '@milkdown/ctx'\nimport { editorViewCtx } from '@milkdown/core'\nimport { browser } from '@milkdown/prose'\nimport type { Selection } from '@milkdown/prose/state'\nimport { NodeSelection } from '@milkdown/prose/state'\nimport type { EditorView } from '@milkdown/prose/view'\nimport throttle from 'lodash.throttle'\n\nimport type { FilterNodes } from './block-config'\nimport { blockConfig } from './block-config'\nimport { selectRootNodeByDom } from './__internal__/select-node-by-dom'\nimport { serializeForClipboard } from './__internal__/serialize-for-clipboard'\nimport type { ActiveNode } from './types'\n\nconst brokenClipboardAPI =\n  (browser.ie && <number>browser.ie_version < 15) ||\n  (browser.ios && browser.webkit_version < 604)\n\nconst buffer = 20\n\n/// @internal\nexport type BlockServiceMessageType =\n  | {\n      type: 'hide'\n    }\n  | {\n      type: 'show'\n      active: ActiveNode\n    }\n\n/// @internal\nexport type BlockServiceMessage = (message: BlockServiceMessageType) => void\n\n/// @internal\n/// The block service, provide events and methods for block plugin.\n/// Generally you don't need to use this class directly.\nexport class BlockService {\n  /// @internal\n  #ctx?: Ctx\n\n  /// @internal\n  #createSelection: () => null | Selection = () => {\n    if (!this.#active) return null\n    const result = this.#active\n    const view = this.#view\n\n    if (view && NodeSelection.isSelectable(result.node)) {\n      const nodeSelection = NodeSelection.create(\n        view.state.doc,\n        result.$pos.pos\n      )\n      view.dispatch(view.state.tr.setSelection(nodeSelection))\n      view.focus()\n      this.#activeSelection = nodeSelection\n      return nodeSelection\n    }\n    return null\n  }\n\n  /// @internal\n  #activeSelection: null | Selection = null\n  /// @internal\n  #active: null | ActiveNode = null\n  /// @internal\n  #activeDOMRect: undefined | DOMRect = undefined\n\n  /// @internal\n  #dragging = false\n\n  /// @internal\n  get #filterNodes(): FilterNodes | undefined {\n    return this.#ctx?.get(blockConfig.key).filterNodes\n  }\n\n  /// @internal\n  get #view() {\n    return this.#ctx?.get(editorViewCtx)\n  }\n\n  /// @internal\n  #notify?: BlockServiceMessage\n\n  /// @internal\n  #hide = () => {\n    this.#notify?.({ type: 'hide' })\n    this.#active = null\n  }\n\n  /// @internal\n  #show = (active: ActiveNode) => {\n    this.#active = active\n    this.#notify?.({ type: 'show', active })\n  }\n\n  /// Bind editor context and notify function to the service.\n  bind = (ctx: Ctx, notify: BlockServiceMessage) => {\n    this.#ctx = ctx\n    this.#notify = notify\n  }\n\n  /// Add mouse event to the dom.\n  addEvent = (dom: HTMLElement) => {\n    dom.addEventListener('mousedown', this.#handleMouseDown)\n    dom.addEventListener('mouseup', this.#handleMouseUp)\n    dom.addEventListener('dragstart', this.#handleDragStart)\n  }\n\n  /// Remove mouse event to the dom.\n  removeEvent = (dom: HTMLElement) => {\n    dom.removeEventListener('mousedown', this.#handleMouseDown)\n    dom.removeEventListener('mouseup', this.#handleMouseUp)\n    dom.removeEventListener('dragstart', this.#handleDragStart)\n  }\n\n  /// Unbind the notify function.\n  unBind = () => {\n    this.#notify = undefined\n  }\n\n  /// @internal\n  #handleMouseDown = () => {\n    this.#activeDOMRect = this.#active?.el.getBoundingClientRect()\n    this.#createSelection()\n  }\n\n  /// @internal\n  #handleMouseUp = () => {\n    if (!this.#dragging) {\n      requestAnimationFrame(() => {\n        if (!this.#activeDOMRect) return\n        this.#view?.focus()\n      })\n\n      return\n    }\n    this.#dragging = false\n    this.#activeSelection = null\n  }\n\n  /// @internal\n  #handleDragStart = (event: DragEvent) => {\n    this.#dragging = true\n\n    const view = this.#view\n    if (!view) return\n    view.dom.dataset.dragging = 'true'\n\n    const selection = this.#activeSelection\n    if (event.dataTransfer && selection) {\n      const slice = selection.content()\n      event.dataTransfer.effectAllowed = 'copyMove'\n      const { dom, text } = serializeForClipboard(view, slice)\n      event.dataTransfer.clearData()\n      event.dataTransfer.setData(\n        brokenClipboardAPI ? 'Text' : 'text/html',\n        dom.innerHTML\n      )\n      if (!brokenClipboardAPI) event.dataTransfer.setData('text/plain', text)\n      const activeEl = this.#active?.el\n      if (activeEl) event.dataTransfer.setDragImage(activeEl, 0, 0)\n\n      view.dragging = {\n        slice,\n        move: true,\n      }\n    }\n  }\n\n  /// @internal\n  keydownCallback = (view: EditorView) => {\n    this.#hide()\n\n    this.#dragging = false\n    view.dom.dataset.dragging = 'false'\n    return false\n  }\n\n  /// @internal\n  #mousemoveCallback = throttle((view: EditorView, event: MouseEvent) => {\n    if (!view.editable) return\n\n    const rect = view.dom.getBoundingClientRect()\n    const x = rect.left + rect.width / 2\n    const dom = view.root.elementFromPoint(x, event.clientY)\n    if (!(dom instanceof Element)) {\n      this.#hide()\n      return\n    }\n\n    const filterNodes = this.#filterNodes\n    if (!filterNodes) return\n\n    const result = selectRootNodeByDom(\n      view,\n      { x, y: event.clientY },\n      filterNodes\n    )\n\n    if (!result) {\n      this.#hide()\n      return\n    }\n    this.#show(result)\n  }, 200)\n\n  /// @internal\n  mousemoveCallback = (view: EditorView, event: MouseEvent) => {\n    if (view.composing || !view.editable) return false\n\n    this.#mousemoveCallback(view, event)\n\n    return false\n  }\n\n  /// @internal\n  dragoverCallback = (view: EditorView, event: DragEvent) => {\n    if (this.#dragging) {\n      const root = this.#view?.dom.parentElement\n      if (!root) return false\n\n      const hasHorizontalScrollbar = root.scrollHeight > root.clientHeight\n\n      const rootRect = root.getBoundingClientRect()\n      if (hasHorizontalScrollbar) {\n        if (root.scrollTop > 0 && Math.abs(event.y - rootRect.y) < buffer) {\n          const top = root.scrollTop > 10 ? root.scrollTop - 10 : 0\n          root.scrollTop = top\n          return false\n        }\n        const totalHeight = Math.round(view.dom.getBoundingClientRect().height)\n        const scrollBottom = Math.round(root.scrollTop + rootRect.height)\n        if (\n          scrollBottom < totalHeight &&\n          Math.abs(event.y - (rootRect.height + rootRect.y)) < buffer\n        ) {\n          const top = root.scrollTop + 10\n          root.scrollTop = top\n          return false\n        }\n      }\n    }\n    return false\n  }\n\n  /// @internal\n  dragenterCallback = (view: EditorView) => {\n    if (!view.dragging) return\n\n    this.#dragging = true\n    view.dom.dataset.dragging = 'true'\n  }\n\n  /// @internal\n  dragleaveCallback = (view: EditorView, event: DragEvent) => {\n    const x = event.clientX\n    const y = event.clientY\n    // if cursor out of the editor\n    if (x < 0 || y < 0 || x > window.innerWidth || y > window.innerHeight) {\n      this.#active = null\n      this.#dragEnd(view)\n    }\n  }\n\n  /// @internal\n  dropCallback = (view: EditorView) => {\n    this.#dragEnd(view)\n\n    return false\n  }\n\n  /// @internal\n  dragendCallback = (view: EditorView) => {\n    this.#dragEnd(view)\n  }\n\n  /// @internal\n  #dragEnd = (view: EditorView) => {\n    this.#dragging = false\n    view.dom.dataset.dragging = 'false'\n  }\n}\n","import type { EditorView } from '@milkdown/prose/view'\n\nimport type { FilterNodes } from '../block-config'\nimport type { ActiveNode } from '../types'\n\nexport function selectRootNodeByDom(\n  view: EditorView,\n  coords: { x: number; y: number },\n  filterNodes: FilterNodes\n): ActiveNode | null {\n  const root = view.dom.parentElement\n  if (!root) return null\n\n  try {\n    const pos = view.posAtCoords({\n      left: coords.x,\n      top: coords.y,\n    })?.inside\n    if (pos == null || pos < 0) return null\n\n    let $pos = view.state.doc.resolve(pos)\n    let node = view.state.doc.nodeAt(pos)\n    let element = view.nodeDOM(pos) as HTMLElement | null\n\n    const filter = (needLookup: boolean) => {\n      const checkDepth = $pos.depth >= 1 && $pos.index($pos.depth) === 0\n      const shouldLookUp = needLookup || checkDepth\n\n      if (!shouldLookUp) return\n\n      const ancestorPos = $pos.before($pos.depth)\n      node = view.state.doc.nodeAt(ancestorPos)\n      element = view.nodeDOM(ancestorPos) as HTMLElement | null\n      $pos = view.state.doc.resolve(ancestorPos)\n\n      if (!filterNodes($pos, node!)) filter(true)\n    }\n\n    // If filterNodes returns false, we should look up the parent node.\n    const filterResult = filterNodes($pos, node!)\n    filter(!filterResult)\n\n    if (!element || !node) return null\n\n    return { node, $pos, el: element }\n  } catch {\n    return null\n  }\n}\n","import type { PluginSpec } from '@milkdown/prose/state'\nimport { Plugin, PluginKey } from '@milkdown/prose/state'\nimport { $ctx, $prose } from '@milkdown/utils'\n\nimport { BlockService } from './block-service'\nimport { withMeta } from './__internal__/with-meta'\n\n/// @internal\nexport const blockService = $ctx(() => new BlockService(), 'blockService')\n\n/// @internal\nexport const blockServiceInstance = $ctx(\n  {} as BlockService,\n  'blockServiceInstance'\n)\n\nwithMeta(blockService, {\n  displayName: 'Ctx<blockService>',\n})\n\nwithMeta(blockServiceInstance, {\n  displayName: 'Ctx<blockServiceInstance>',\n})\n\n/// A slice contains a factory that will return a plugin spec.\n/// Users can use this slice to customize the plugin.\nexport const blockSpec = $ctx<PluginSpec<any>, 'blockSpec'>({}, 'blockSpec')\n\nwithMeta(blockSpec, {\n  displayName: 'Ctx<blockSpec>',\n})\n\n/// The block prosemirror plugin.\nexport const blockPlugin = $prose((ctx) => {\n  const milkdownPluginBlockKey = new PluginKey('MILKDOWN_BLOCK')\n  const getService = ctx.get(blockService.key)\n  const service = getService()\n  ctx.set(blockServiceInstance.key, service)\n  const spec = ctx.get(blockSpec.key)\n\n  return new Plugin({\n    key: milkdownPluginBlockKey,\n    ...spec,\n    props: {\n      ...spec.props,\n      handleDOMEvents: {\n        drop: (view) => {\n          return service.dropCallback(view)\n        },\n        pointermove: (view, event) => {\n          return service.mousemoveCallback(view, event)\n        },\n        keydown: (view) => {\n          return service.keydownCallback(view)\n        },\n        dragover: (view, event) => {\n          return service.dragoverCallback(view, event)\n        },\n        dragleave: (view, event) => {\n          return service.dragleaveCallback(view, event)\n        },\n        dragenter: (view) => {\n          return service.dragenterCallback(view)\n        },\n        dragend: (view) => {\n          return service.dragendCallback(view)\n        },\n      },\n    },\n  })\n})\n\nwithMeta(blockPlugin, {\n  displayName: 'Prose<block>',\n})\n","import type { Ctx } from '@milkdown/ctx'\nimport type { EditorState } from '@milkdown/prose/state'\nimport type { EditorView } from '@milkdown/prose/view'\n\nimport type {\n  ComputePositionConfig,\n  Middleware,\n  Placement,\n  VirtualElement,\n} from '@floating-ui/dom'\nimport { computePosition, flip, offset } from '@floating-ui/dom'\n\nimport { editorViewCtx } from '@milkdown/core'\nimport type { BlockService } from './block-service'\nimport { blockServiceInstance } from './block-plugin'\nimport type { ActiveNode } from './types'\n\n/// The context of the block provider.\nexport interface DeriveContext {\n  ctx: Ctx\n  active: ActiveNode\n  editorDom: HTMLElement\n  blockDom: HTMLElement\n}\n\n/// Options for creating block provider.\nexport interface BlockProviderOptions {\n  /// The context of the editor.\n  ctx: Ctx\n  /// The content of the block.\n  content: HTMLElement\n  /// The function to determine whether the tooltip should be shown.\n  shouldShow?: (view: EditorView, prevState?: EditorState) => boolean\n  /// The offset to get the block. Default is 0.\n  getOffset?: (deriveContext: DeriveContext) =>\n    | number\n    | {\n        mainAxis?: number\n        crossAxis?: number\n        alignmentAxis?: number | null\n      }\n  /// The function to get the position of the block. Default is the position of the active node.\n  getPosition?: (deriveContext: DeriveContext) => Omit<DOMRect, 'toJSON'>\n  /// The function to get the placement of the block. Default is 'left'.\n  getPlacement?: (deriveContext: DeriveContext) => Placement\n  /// Other middlewares for floating ui. This will be added after the internal middlewares.\n  middleware?: Middleware[]\n  /// Options for floating ui. If you pass `middleware` or `placement`, it will override the internal settings.\n  floatingUIOptions?: Partial<ComputePositionConfig>\n  /// The root element that the block will be appended to.\n  root?: HTMLElement\n}\n\n/// A provider for creating block.\nexport class BlockProvider {\n  /// @internal\n  readonly #element: HTMLElement\n\n  /// @internal\n  readonly #ctx: Ctx\n\n  /// @internal\n  #service?: BlockService\n\n  /// @internal\n  #activeNode: ActiveNode | null = null\n\n  /// @internal\n  readonly #root?: HTMLElement\n\n  /// @internal\n  #initialized = false\n\n  /// @internal\n  readonly #middleware: Middleware[]\n\n  /// @internal\n  readonly #floatingUIOptions: Partial<ComputePositionConfig>\n\n  /// @internal\n  readonly #getOffset?: (deriveContext: DeriveContext) =>\n    | number\n    | {\n        mainAxis?: number\n        crossAxis?: number\n        alignmentAxis?: number | null\n      }\n\n  /// @internal\n  readonly #getPosition?: (\n    deriveContext: DeriveContext\n  ) => Omit<DOMRect, 'toJSON'>\n\n  /// @internal\n  readonly #getPlacement?: (deriveContext: DeriveContext) => Placement\n\n  /// The context of current active node.\n  get active() {\n    return this.#activeNode\n  }\n\n  constructor(options: BlockProviderOptions) {\n    this.#ctx = options.ctx\n    this.#element = options.content\n    this.#getOffset = options.getOffset\n    this.#getPosition = options.getPosition\n    this.#getPlacement = options.getPlacement\n    this.#middleware = options.middleware ?? []\n    this.#floatingUIOptions = options.floatingUIOptions ?? {}\n    this.#root = options.root\n    this.hide()\n  }\n\n  /// @internal\n  #init() {\n    const view = this.#ctx.get(editorViewCtx)\n    const root = this.#root ?? view.dom.parentElement ?? document.body\n    root.appendChild(this.#element)\n\n    const service = this.#ctx.get(blockServiceInstance.key)\n    service.bind(this.#ctx, (message) => {\n      if (message.type === 'hide') {\n        this.hide()\n        this.#activeNode = null\n      } else if (message.type === 'show') {\n        this.show(message.active)\n        this.#activeNode = message.active\n      }\n    })\n\n    this.#service = service\n    this.#service.addEvent(this.#element)\n    this.#element.draggable = true\n  }\n\n  /// Update provider state by editor view.\n  update = (): void => {\n    requestAnimationFrame(() => {\n      if (!this.#initialized) {\n        try {\n          this.#init()\n          this.#initialized = true\n        } catch {\n          // ignore\n        }\n      }\n    })\n  }\n\n  /// Destroy the block.\n  destroy = () => {\n    this.#service?.unBind()\n    this.#service?.removeEvent(this.#element)\n    this.#element.remove()\n  }\n\n  /// Show the block.\n  show = (active: ActiveNode) => {\n    const dom = active.el\n    const editorDom = this.#ctx.get(editorViewCtx).dom\n    const deriveContext: DeriveContext = {\n      ctx: this.#ctx,\n      active,\n      editorDom,\n      blockDom: this.#element,\n    }\n    const virtualEl: VirtualElement = {\n      contextElement: dom,\n      getBoundingClientRect: () => {\n        if (this.#getPosition) return this.#getPosition(deriveContext)\n\n        return dom.getBoundingClientRect()\n      },\n    }\n    const middleware = [flip()]\n    if (this.#getOffset) {\n      const offsetOption = this.#getOffset(deriveContext)\n      const offsetExt = offset(offsetOption)\n      middleware.push(offsetExt)\n    }\n\n    computePosition(virtualEl, this.#element, {\n      placement: this.#getPlacement\n        ? this.#getPlacement(deriveContext)\n        : 'left',\n      middleware: [...middleware, ...this.#middleware],\n      ...this.#floatingUIOptions,\n    }).then(({ x, y }) => {\n      Object.assign(this.#element.style, {\n        left: `${x}px`,\n        top: `${y}px`,\n      })\n      this.#element.dataset.show = 'true'\n    })\n  }\n\n  /// Hide the block.\n  hide = () => {\n    this.#element.dataset.show = 'false'\n  }\n}\n","import type { SliceType } from '@milkdown/ctx'\nimport type { PluginSpec } from '@milkdown/prose/state'\nimport type { $Ctx, $Prose } from '@milkdown/utils'\nimport type { FilterNodes } from './block-config'\nimport { blockConfig } from './block-config'\nimport {\n  blockPlugin,\n  blockService,\n  blockServiceInstance,\n  blockSpec,\n} from './block-plugin'\nimport type { BlockService } from './block-service'\n\nexport * from './block-plugin'\nexport * from './block-provider'\nexport * from './block-service'\nexport * from './block-config'\nexport * from './types'\n\n/// @internal\nexport type BlockPlugin = [\n  $Ctx<PluginSpec<any>, 'blockSpec'>,\n  $Ctx<{ filterNodes: FilterNodes }, 'blockConfig'>,\n  $Ctx<() => BlockService, 'blockService'>,\n  $Ctx<BlockService, 'blockServiceInstance'>,\n  $Prose,\n] & {\n  key: SliceType<PluginSpec<any>, 'blockSpec'>\n  pluginKey: $Prose['key']\n}\n\n/// All plugins exported by this package.\nexport const block = [\n  blockSpec,\n  blockConfig,\n  blockService,\n  blockServiceInstance,\n  blockPlugin,\n] as BlockPlugin\nblock.key = blockSpec.key\nblock.pluginKey = blockPlugin.key\n","import { findParentNode, posToDOMRect } from '@milkdown/prose'\nimport type { EditorState } from '@milkdown/prose/state'\nimport type { Node } from '@milkdown/prose/model'\nimport { TextSelection } from '@milkdown/prose/state'\nimport type { EditorView } from '@milkdown/prose/view'\nimport debounce from 'lodash.debounce'\nimport type {\n  ComputePositionConfig,\n  Middleware,\n  VirtualElement,\n} from '@floating-ui/dom'\nimport { computePosition, flip, offset } from '@floating-ui/dom'\n\n/// Options for slash provider.\nexport interface SlashProviderOptions {\n  /// The slash content.\n  content: HTMLElement\n  /// The debounce time for updating slash, 200ms by default.\n  debounce?: number\n  /// The function to determine whether the tooltip should be shown.\n  shouldShow?: (view: EditorView, prevState?: EditorState) => boolean\n  /// The key trigger for shouldShow, '/' by default.\n  trigger?: string | string[]\n  /// The offset to get the block. Default is 0.\n  offset?:\n    | number\n    | {\n        mainAxis?: number\n        crossAxis?: number\n        alignmentAxis?: number | null\n      }\n  /// Other middlewares for floating ui. This will be added after the internal middlewares.\n  middleware?: Middleware[]\n  /// Options for floating ui. If you pass `middleware` or `placement`, it will override the internal settings.\n  floatingUIOptions?: Partial<ComputePositionConfig>\n  /// The root element that the slash will be appended to.\n  root?: HTMLElement\n}\n\n/// A provider for creating slash.\nexport class SlashProvider {\n  /// The root element of the slash.\n  element: HTMLElement\n\n  /// @internal\n  #initialized = false\n\n  /// @internal\n  readonly #middleware: Middleware[]\n\n  /// @internal\n  readonly #floatingUIOptions: Partial<ComputePositionConfig>\n\n  /// @internal\n  readonly #root?: HTMLElement\n\n  /// @internal\n  readonly #debounce: number\n\n  /// @internal\n  readonly #trigger: string | string[]\n\n  /// @internal\n  readonly #shouldShow: (view: EditorView, prevState?: EditorState) => boolean\n\n  /// The offset to get the block. Default is 0.\n  readonly #offset?:\n    | number\n    | {\n        mainAxis?: number\n        crossAxis?: number\n        alignmentAxis?: number | null\n      }\n\n  /// On show callback.\n  onShow = () => {}\n\n  /// On hide callback.\n  onHide = () => {}\n\n  constructor(options: SlashProviderOptions) {\n    this.element = options.content\n    this.#debounce = options.debounce ?? 200\n    this.#shouldShow = options.shouldShow ?? this.#_shouldShow\n    this.#trigger = options.trigger ?? '/'\n    this.#offset = options.offset\n    this.#middleware = options.middleware ?? []\n    this.#floatingUIOptions = options.floatingUIOptions ?? {}\n    this.#root = options.root\n  }\n\n  /// @internal\n  #onUpdate = (view: EditorView, prevState?: EditorState): void => {\n    const { state, composing } = view\n    const { selection, doc } = state\n    const { ranges } = selection\n    const from = Math.min(...ranges.map((range) => range.$from.pos))\n    const to = Math.max(...ranges.map((range) => range.$to.pos))\n    const isSame =\n      prevState && prevState.doc.eq(doc) && prevState.selection.eq(selection)\n\n    if (!this.#initialized) {\n      const root = this.#root ?? view.dom.parentElement ?? document.body\n      root.appendChild(this.element)\n      this.#initialized = true\n    }\n\n    if (composing || isSame) return\n\n    if (!this.#shouldShow(view, prevState)) {\n      this.hide()\n      return\n    }\n\n    const virtualEl: VirtualElement = {\n      getBoundingClientRect: () => posToDOMRect(view, from, to),\n    }\n    computePosition(virtualEl, this.element, {\n      placement: 'bottom-start',\n      middleware: [flip(), offset(this.#offset), ...this.#middleware],\n      ...this.#floatingUIOptions,\n    }).then(({ x, y }) => {\n      Object.assign(this.element.style, {\n        left: `${x}px`,\n        top: `${y}px`,\n      })\n    })\n\n    this.show()\n  }\n\n  /// @internal\n  #_shouldShow(view: EditorView): boolean {\n    const currentTextBlockContent = this.getContent(view)\n\n    if (!currentTextBlockContent) return false\n\n    const target = currentTextBlockContent.at(-1)\n\n    if (!target) return false\n\n    return Array.isArray(this.#trigger)\n      ? this.#trigger.includes(target)\n      : this.#trigger === target\n  }\n\n  /// Update provider state by editor view.\n  update = (view: EditorView, prevState?: EditorState): void => {\n    const updater = debounce(this.#onUpdate, this.#debounce)\n\n    updater(view, prevState)\n  }\n\n  /// Get the content of the current text block.\n  /// Pass the `matchNode` function to determine whether the current node should be matched, by default, it will match the paragraph node.\n  getContent = (\n    view: EditorView,\n    matchNode: (node: Node) => boolean = (node) =>\n      node.type.name === 'paragraph'\n  ): string | undefined => {\n    const { selection } = view.state\n    const { empty, $from } = selection\n    const isTextBlock = view.state.selection instanceof TextSelection\n\n    const isSlashChildren = this.element.contains(document.activeElement)\n\n    const notHasFocus = !view.hasFocus() && !isSlashChildren\n\n    const isReadonly = !view.editable\n\n    const paragraph = findParentNode(matchNode)(view.state.selection)\n\n    const isNotInParagraph = !paragraph\n\n    if (notHasFocus || isReadonly || !empty || !isTextBlock || isNotInParagraph)\n      return\n\n    return $from.parent.textBetween(\n      Math.max(0, $from.parentOffset - 500),\n      $from.parentOffset,\n      undefined,\n      '\\uFFFC'\n    )\n  }\n\n  /// Destroy the slash.\n  destroy = () => {}\n\n  /// Show the slash.\n  show = () => {\n    this.element.dataset.show = 'true'\n    this.onShow()\n  }\n\n  /// Hide the slash.\n  hide = () => {\n    this.element.dataset.show = 'false'\n    this.onHide()\n  }\n}\n","import type { MenuItem, MenuItemGroup } from './utils'\n\nexport class GroupBuilder {\n  #groups: MenuItemGroup<false>[] = []\n\n  clear = () => {\n    this.#groups = []\n    return this\n  }\n\n  #getGroupInstance = (group: MenuItemGroup<false>) => {\n    const groupInstance = {\n      group,\n      addItem: (key: string, item: Omit<MenuItem, 'key' | 'index'>) => {\n        const data = { key, ...item }\n        group.items.push(data)\n        return groupInstance\n      },\n      clear: () => {\n        group.items = []\n        return groupInstance\n      },\n    }\n    return groupInstance\n  }\n\n  addGroup = (key: string, label: string) => {\n    const items: Omit<MenuItem, 'index'>[] = []\n    const group: MenuItemGroup<false> = {\n      key,\n      label,\n      items,\n    }\n    this.#groups.push(group)\n\n    return this.#getGroupInstance(group)\n  }\n\n  getGroup = (key: string) => {\n    const group = this.#groups.find((group) => group.key === key)\n    if (!group) throw new Error(`Group with key ${key} not found`)\n\n    return this.#getGroupInstance(group)\n  }\n\n  build = () => {\n    return this.#groups\n  }\n}\n","import type { html } from 'atomico'\nimport type { Ctx } from '@milkdown/kit/ctx'\nimport type { Command, Transaction } from '@milkdown/kit/prose/state'\nimport type { Attrs, NodeType } from '@milkdown/kit/prose/model'\nimport { findWrapping } from '@milkdown/kit/prose/transform'\n\nexport interface MenuItem {\n  index: number\n  key: string\n  label: string\n  icon: ReturnType<typeof html>\n  onRun: (ctx: Ctx) => void\n}\n\ntype WithRange<T, HasIndex extends true | false = true> = HasIndex extends true\n  ? T & { range: [start: number, end: number] }\n  : T\n\nexport type MenuItemGroup<HasIndex extends true | false = true> = WithRange<\n  {\n    key: string\n    label: string\n    items: HasIndex extends true ? MenuItem[] : Omit<MenuItem, 'index'>[]\n  },\n  HasIndex\n>\n\nexport function clearRange(tr: Transaction) {\n  const { $from, $to } = tr.selection\n  const { pos: from } = $from\n  const { pos: to } = $to\n  tr = tr.deleteRange(from - $from.node().content.size, to)\n  return tr\n}\n\nexport function setBlockType(\n  tr: Transaction,\n  nodeType: NodeType,\n  attrs: Attrs | null = null\n) {\n  const { from, to } = tr.selection\n  return tr.setBlockType(from, to, nodeType, attrs)\n}\n\nexport function wrapInBlockType(\n  tr: Transaction,\n  nodeType: NodeType,\n  attrs: Attrs | null = null\n) {\n  const { $from, $to } = tr.selection\n\n  const range = $from.blockRange($to)\n  const wrapping = range && findWrapping(range, nodeType, attrs)\n  if (!wrapping) return null\n\n  return tr.wrap(range, wrapping)\n}\n\nexport function addBlockType(\n  tr: Transaction,\n  nodeType: NodeType,\n  attrs: Attrs | null = null\n) {\n  const node = nodeType.createAndFill(attrs)\n  if (!node) return null\n\n  return tr.replaceSelectionWith(node)\n}\n\nexport function clearContentAndSetBlockType(\n  nodeType: NodeType,\n  attrs: Attrs | null = null\n): Command {\n  return (state, dispatch) => {\n    if (dispatch) {\n      const tr = setBlockType(clearRange(state.tr), nodeType, attrs)\n      dispatch(tr.scrollIntoView())\n    }\n    return true\n  }\n}\n\nexport function clearContentAndWrapInBlockType(\n  nodeType: NodeType,\n  attrs: Attrs | null = null\n): Command {\n  return (state, dispatch) => {\n    const tr = wrapInBlockType(clearRange(state.tr), nodeType, attrs)\n    if (!tr) return false\n\n    if (dispatch) dispatch(tr.scrollIntoView())\n\n    return true\n  }\n}\n\nexport function clearContentAndAddBlockType(\n  nodeType: NodeType,\n  attrs: Attrs | null = null\n): Command {\n  return (state, dispatch) => {\n    const tr = addBlockType(clearRange(state.tr), nodeType, attrs)\n    if (!tr) return false\n\n    if (dispatch) dispatch(tr.scrollIntoView())\n\n    return true\n  }\n}\n","import type { Component } from 'atomico'\nimport {\n  c,\n  html,\n  useCallback,\n  useEffect,\n  useHost,\n  useMemo,\n  useRef,\n  useState,\n} from 'atomico'\nimport type { Ctx } from '@milkdown/kit/ctx'\nimport type { BlockEditFeatureConfig } from '../index'\nimport { getGroups } from './config'\n\nexport interface MenuProps {\n  ctx: Ctx\n  show: boolean\n  filter: string\n  hide: () => void\n  config?: BlockEditFeatureConfig\n}\n\nexport const menuComponent: Component<MenuProps> = ({\n  show,\n  hide,\n  ctx,\n  filter,\n  config,\n}) => {\n  const { groups, size } = useMemo(\n    () => getGroups(filter, config, ctx),\n    [filter]\n  )\n\n  const host = useHost()\n  const [hoverIndex, setHoverIndex] = useState(0)\n\n  const root = useMemo(() => host.current.getRootNode() as HTMLElement, [host])\n\n  const prevMousePosition = useRef({ x: -999, y: -999 })\n\n  const onMouseMove = useCallback((e: MouseEvent) => {\n    const prevPos = prevMousePosition.current\n    if (!prevPos) return\n\n    const { x, y } = e\n    prevPos.x = x\n    prevPos.y = y\n  }, [])\n\n  useEffect(() => {\n    if (size === 0 && show) hide?.()\n    else if (hoverIndex >= size) setHoverIndex(0)\n  }, [size, show])\n\n  const onHover = useCallback(\n    (\n      index: number | ((prev: number) => number),\n      after?: (index: number) => void\n    ) => {\n      setHoverIndex((prev) => {\n        const next = typeof index === 'function' ? index(prev) : index\n\n        after?.(next)\n        return next\n      })\n    },\n    []\n  )\n\n  const scrollToIndex = useCallback((index: number) => {\n    const target = host.current.querySelector<HTMLElement>(\n      `[data-index=\"${index}\"]`\n    )\n    const scrollRoot = host.current.querySelector<HTMLElement>('.menu-groups')\n\n    if (!target || !scrollRoot) return\n\n    scrollRoot.scrollTop = target.offsetTop - scrollRoot.offsetTop\n  }, [])\n\n  const runByIndex = useCallback(\n    (index: number) => {\n      const item = groups.flatMap((group) => group.items).at(index)\n      if (item && ctx) item.onRun(ctx)\n\n      hide?.()\n    },\n    [groups]\n  )\n\n  const onKeydown = useCallback(\n    (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        e.preventDefault()\n        hide?.()\n        return\n      }\n\n      if (e.key === 'ArrowDown') {\n        e.preventDefault()\n        return onHover(\n          (index) => (index < size - 1 ? index + 1 : index),\n          scrollToIndex\n        )\n      }\n\n      if (e.key === 'ArrowUp') {\n        e.preventDefault()\n        return onHover(\n          (index) => (index <= 0 ? index : index - 1),\n          scrollToIndex\n        )\n      }\n\n      if (e.key === 'ArrowLeft') {\n        e.preventDefault()\n        return onHover((index) => {\n          const group = groups.find(\n            (group) => group.range[0] <= index && group.range[1] > index\n          )\n          if (!group) return index\n\n          const prevGroup = groups[groups.indexOf(group) - 1]\n          if (!prevGroup) return index\n\n          return prevGroup.range[1] - 1\n        }, scrollToIndex)\n      }\n\n      if (e.key === 'ArrowRight') {\n        e.preventDefault()\n        return onHover((index) => {\n          const group = groups.find(\n            (group) => group.range[0] <= index && group.range[1] > index\n          )\n          if (!group) return index\n\n          const nextGroup = groups[groups.indexOf(group) + 1]\n          if (!nextGroup) return index\n\n          return nextGroup.range[0]\n        }, scrollToIndex)\n      }\n\n      if (e.key === 'Enter') {\n        e.preventDefault()\n        runByIndex(hoverIndex)\n      }\n    },\n    [hide, groups, hoverIndex]\n  )\n\n  const onMouseEnter = useCallback((index: number) => {\n    return (e: MouseEvent) => {\n      const prevPos = prevMousePosition.current\n      if (!prevPos) return\n\n      const { x, y } = e\n      if (x === prevPos.x && y === prevPos.y) return\n\n      onHover(index)\n    }\n  }, [])\n\n  useEffect(() => {\n    if (show) root.addEventListener('keydown', onKeydown, { capture: true })\n    else root.removeEventListener('keydown', onKeydown, { capture: true })\n\n    return () => {\n      root.removeEventListener('keydown', onKeydown, { capture: true })\n    }\n  }, [show, onKeydown])\n\n  return html`\n    <host onmousedown=${(e: MouseEvent) => e.preventDefault()}>\n      <nav class=\"tab-group\">\n        <ul>\n          ${groups.map(\n            (group) =>\n              html`<li\n                key=${group.key}\n                onmousedown=${() => onHover(group.range[0], scrollToIndex)}\n                class=${hoverIndex >= group.range[0] &&\n                hoverIndex < group.range[1]\n                  ? 'selected'\n                  : ''}\n              >\n                ${group.label}\n              </li>`\n          )}\n        </ul>\n      </nav>\n      <div class=\"menu-groups\" onmousemove=${onMouseMove}>\n        ${groups.map((group) => {\n          return html`\n            <div key=${group.key} class=\"menu-group\">\n              <h6>${group.label}</h6>\n              <ul>\n                ${group.items.map(\n                  (item) =>\n                    html`<li\n                      key=${item.key}\n                      data-index=${item.index}\n                      class=${hoverIndex === item.index ? 'hover' : ''}\n                      onmouseenter=${onMouseEnter(item.index)}\n                      onmousedown=${() => {\n                        host.current\n                          .querySelector(`[data-index=\"${item.index}\"]`)\n                          ?.classList.add('active')\n                      }}\n                      onmouseup=${() => {\n                        host.current\n                          .querySelector(`[data-index=\"${item.index}\"]`)\n                          ?.classList.remove('active')\n                        runByIndex(item.index)\n                      }}\n                    >\n                      ${item.icon}\n                      <span>${item.label}</span>\n                    </li>`\n                )}\n              </ul>\n            </div>\n          `\n        })}\n      </div>\n    </host>\n  `\n}\n\nmenuComponent.props = {\n  ctx: Object,\n  config: Object,\n  show: Boolean,\n  filter: String,\n  hide: Function,\n}\n\nexport const MenuElement = c(menuComponent)\n","import { imageBlockSchema } from '@milkdown/kit/component/image-block'\nimport { editorViewCtx } from '@milkdown/kit/core'\nimport type { Ctx } from '@milkdown/kit/ctx'\nimport {\n  blockquoteSchema,\n  bulletListSchema,\n  codeBlockSchema,\n  headingSchema,\n  hrSchema,\n  listItemSchema,\n  orderedListSchema,\n  paragraphSchema,\n} from '@milkdown/kit/preset/commonmark'\nimport { createTable } from '@milkdown/kit/preset/gfm'\nimport { TextSelection } from '@milkdown/kit/prose/state'\nimport { CrepeFeature } from '../../..'\nimport { FeaturesCtx } from '../../../core/slice'\nimport {\n  bulletListIcon,\n  codeIcon,\n  dividerIcon,\n  functionsIcon,\n  h1Icon,\n  h2Icon,\n  h3Icon,\n  h4Icon,\n  h5Icon,\n  h6Icon,\n  imageIcon,\n  orderedListIcon,\n  quoteIcon,\n  tableIcon,\n  textIcon,\n  todoListIcon,\n} from '../../../icons'\nimport type { BlockEditFeatureConfig } from '../index'\nimport { GroupBuilder } from './group-builder'\nimport type { MenuItemGroup } from './utils'\nimport {\n  clearContentAndAddBlockType,\n  clearContentAndSetBlockType,\n  clearContentAndWrapInBlockType,\n  clearRange,\n} from './utils'\n\nexport function getGroups(\n  filter?: string,\n  config?: BlockEditFeatureConfig,\n  ctx?: Ctx\n) {\n  const flags = ctx?.get(FeaturesCtx)\n  const isLatexEnabled = flags?.includes(CrepeFeature.Latex)\n  const isImageBlockEnabled = flags?.includes(CrepeFeature.ImageBlock)\n  const isTableEnabled = flags?.includes(CrepeFeature.Table)\n\n  const groupBuilder = new GroupBuilder()\n  groupBuilder\n    .addGroup('text', config?.slashMenuTextGroupLabel ?? 'Text')\n    .addItem('text', {\n      label: config?.slashMenuTextGroupLabel ?? 'Text',\n      icon: config?.slashMenuTextIcon?.() ?? textIcon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndSetBlockType(paragraphSchema.type(ctx))\n        command(state, dispatch)\n      },\n    })\n    .addItem('h1', {\n      label: config?.slashMenuH1Label ?? 'Heading 1',\n      icon: config?.slashMenuH1Icon?.() ?? h1Icon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndSetBlockType(headingSchema.type(ctx), {\n          level: 1,\n        })\n        command(state, dispatch)\n      },\n    })\n    .addItem('h2', {\n      label: config?.slashMenuH2Label ?? 'Heading 2',\n      icon: config?.slashMenuH2Icon?.() ?? h2Icon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndSetBlockType(headingSchema.type(ctx), {\n          level: 2,\n        })\n        command(state, dispatch)\n      },\n    })\n    .addItem('h3', {\n      label: config?.slashMenuH3Label ?? 'Heading 3',\n      icon: config?.slashMenuH3Icon?.() ?? h3Icon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndSetBlockType(headingSchema.type(ctx), {\n          level: 3,\n        })\n        command(state, dispatch)\n      },\n    })\n    .addItem('h4', {\n      label: config?.slashMenuH4Label ?? 'Heading 4',\n      icon: config?.slashMenuH4Icon?.() ?? h4Icon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndSetBlockType(headingSchema.type(ctx), {\n          level: 4,\n        })\n        command(state, dispatch)\n      },\n    })\n    .addItem('h5', {\n      label: config?.slashMenuH5Label ?? 'Heading 5',\n      icon: config?.slashMenuH5Icon?.() ?? h5Icon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndSetBlockType(headingSchema.type(ctx), {\n          level: 5,\n        })\n        command(state, dispatch)\n      },\n    })\n    .addItem('h6', {\n      label: config?.slashMenuH6Label ?? 'Heading 6',\n      icon: config?.slashMenuH6Icon?.() ?? h6Icon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndSetBlockType(headingSchema.type(ctx), {\n          level: 6,\n        })\n        command(state, dispatch)\n      },\n    })\n    .addItem('quote', {\n      label: config?.slashMenuQuoteLabel ?? 'Quote',\n      icon: config?.slashMenuQuoteIcon?.() ?? quoteIcon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndWrapInBlockType(\n          blockquoteSchema.type(ctx)\n        )\n        command(state, dispatch)\n      },\n    })\n    .addItem('divider', {\n      label: config?.slashMenuDividerLabel ?? 'Divider',\n      icon: config?.slashMenuDividerIcon?.() ?? dividerIcon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndAddBlockType(hrSchema.type(ctx))\n        command(state, dispatch)\n      },\n    })\n\n  groupBuilder\n    .addGroup('list', config?.slashMenuListGroupLabel ?? 'List')\n    .addItem('bullet-list', {\n      label: config?.slashMenuBulletListLabel ?? 'Bullet List',\n      icon: config?.slashMenuBulletListIcon?.() ?? bulletListIcon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndWrapInBlockType(\n          bulletListSchema.type(ctx)\n        )\n        command(state, dispatch)\n      },\n    })\n    .addItem('ordered-list', {\n      label: config?.slashMenuOrderedListLabel ?? 'Ordered List',\n      icon: config?.slashMenuOrderedListIcon?.() ?? orderedListIcon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndWrapInBlockType(\n          orderedListSchema.type(ctx)\n        )\n        command(state, dispatch)\n      },\n    })\n    .addItem('todo-list', {\n      label: config?.slashMenuTaskListLabel ?? 'Todo List',\n      icon: config?.slashMenuTaskListIcon?.() ?? todoListIcon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndWrapInBlockType(\n          listItemSchema.type(ctx),\n          { checked: false }\n        )\n        command(state, dispatch)\n      },\n    })\n\n  const advancedGroup = groupBuilder.addGroup(\n    'advanced',\n    config?.slashMenuAdvancedGroupLabel ?? 'Advanced'\n  )\n\n  if (isImageBlockEnabled) {\n    advancedGroup.addItem('image', {\n      label: config?.slashMenuImageLabel ?? 'Image',\n      icon: config?.slashMenuImageIcon?.() ?? imageIcon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndAddBlockType(imageBlockSchema.type(ctx))\n        command(state, dispatch)\n      },\n    })\n  }\n\n  advancedGroup.addItem('code', {\n    label: config?.slashMenuCodeBlockLabel ?? 'Code',\n    icon: config?.slashMenuCodeBlockIcon?.() ?? codeIcon,\n    onRun: (ctx) => {\n      const view = ctx.get(editorViewCtx)\n      const { dispatch, state } = view\n\n      const command = clearContentAndAddBlockType(codeBlockSchema.type(ctx))\n      command(state, dispatch)\n    },\n  })\n\n  if (isTableEnabled) {\n    advancedGroup.addItem('table', {\n      label: config?.slashMenuTableLabel ?? 'Table',\n      icon: config?.slashMenuTableIcon?.() ?? tableIcon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n        let { tr } = state\n        tr = clearRange(tr)\n        const from = tr.selection.from\n        const table = createTable(ctx, 3, 3)\n        tr = tr.replaceSelectionWith(table)\n        dispatch(tr)\n\n        requestAnimationFrame(() => {\n          const docSize = view.state.doc.content.size\n          const $pos = view.state.doc.resolve(\n            from > docSize ? docSize : from < 0 ? 0 : from\n          )\n          const selection = TextSelection.near($pos)\n          const tr = view.state.tr\n          tr.setSelection(selection)\n          dispatch(tr.scrollIntoView())\n        })\n      },\n    })\n  }\n\n  if (isLatexEnabled) {\n    advancedGroup.addItem('math', {\n      label: config?.slashMenuMathLabel ?? 'Math',\n      icon: config?.slashMenuMathIcon?.() ?? functionsIcon,\n      onRun: (ctx) => {\n        const view = ctx.get(editorViewCtx)\n        const { dispatch, state } = view\n\n        const command = clearContentAndAddBlockType(codeBlockSchema.type(ctx), {\n          language: 'LaTex',\n        })\n        command(state, dispatch)\n      },\n    })\n  }\n\n  config?.buildMenu?.(groupBuilder)\n\n  let groups = groupBuilder.build()\n\n  if (filter) {\n    groups = groups\n      .map((group) => {\n        const items = group.items.filter((item) =>\n          item.label.toLowerCase().includes(filter.toLowerCase())\n        )\n\n        return {\n          ...group,\n          items,\n        }\n      })\n      .filter((group) => group.items.length > 0)\n  }\n\n  const items = groups.flatMap((groups) => groups.items)\n  items.forEach((item, index) => {\n    Object.assign(item, { index })\n  })\n\n  groups.reduce((acc, group) => {\n    const end = acc + group.items.length\n    Object.assign(group, {\n      range: [acc, end],\n    })\n    return end\n  }, 0)\n\n  return {\n    groups: groups as MenuItemGroup[],\n    size: items.length,\n  }\n}\n","import type { PluginView } from '@milkdown/kit/prose/state'\nimport type { EditorView } from '@milkdown/kit/prose/view'\nimport { SlashProvider, slashFactory } from '@milkdown/kit/plugin/slash'\nimport type { Ctx } from '@milkdown/kit/ctx'\nimport type { AtomicoThis } from 'atomico/types/dom'\nimport { $ctx } from '@milkdown/kit/utils'\nimport { defIfNotExists, isInCodeBlock, isInList } from '../../../utils'\nimport type { BlockEditFeatureConfig } from '../index'\nimport type { MenuProps } from './component'\nimport { MenuElement } from './component'\n\nexport const menu = slashFactory('CREPE_MENU')\n\nexport interface MenuAPI {\n  show: (pos: number) => void\n  hide: () => void\n}\n\nexport const menuAPI = $ctx(\n  {\n    show: () => {},\n    hide: () => {},\n  } as MenuAPI,\n  'menuAPICtx'\n)\n\ndefIfNotExists('milkdown-slash-menu', MenuElement)\nexport function configureMenu(ctx: Ctx, config?: BlockEditFeatureConfig) {\n  ctx.set(menu.key, {\n    view: (view) => new MenuView(ctx, view, config),\n  })\n}\n\nclass MenuView implements PluginView {\n  readonly #content: AtomicoThis<MenuProps, HTMLElement>\n  readonly #slashProvider: SlashProvider\n  #programmaticallyPos: number | null = null\n\n  constructor(ctx: Ctx, view: EditorView, config?: BlockEditFeatureConfig) {\n    this.#content = new MenuElement()\n    this.#content.hide = this.hide\n    this.#content.ctx = ctx\n    this.#content.config = config\n    // eslint-disable-next-line ts/no-this-alias\n    const self = this\n    this.#slashProvider = new SlashProvider({\n      content: this.#content,\n      debounce: 20,\n      shouldShow(this: SlashProvider, view: EditorView) {\n        if (\n          isInCodeBlock(view.state.selection) ||\n          isInList(view.state.selection)\n        )\n          return false\n\n        const currentText = this.getContent(view, (node) =>\n          ['paragraph', 'heading'].includes(node.type.name)\n        )\n\n        if (currentText == null) return false\n\n        const pos = self.#programmaticallyPos\n\n        self.#content.filter = currentText.startsWith('/')\n          ? currentText.slice(1)\n          : currentText\n\n        if (typeof pos === 'number') {\n          if (\n            view.state.doc.resolve(pos).node() !==\n            view.state.doc.resolve(view.state.selection.from).node()\n          ) {\n            self.#programmaticallyPos = null\n\n            return false\n          }\n\n          return true\n        }\n\n        if (!currentText.startsWith('/')) return false\n\n        return true\n      },\n      offset: 10,\n    })\n\n    this.#slashProvider.onShow = () => {\n      this.#content.show = true\n    }\n    this.#slashProvider.onHide = () => {\n      this.#content.show = false\n    }\n    this.update(view)\n\n    ctx.set(menuAPI.key, {\n      show: (pos) => this.show(pos),\n      hide: () => this.hide(),\n    })\n  }\n\n  update = (view: EditorView) => {\n    this.#slashProvider.update(view)\n  }\n\n  show = (pos: number) => {\n    this.#programmaticallyPos = pos\n    this.#content.filter = ''\n    this.#slashProvider.show()\n  }\n\n  hide = () => {\n    this.#programmaticallyPos = null\n    this.#slashProvider.hide()\n  }\n\n  destroy = () => {\n    this.#slashProvider.destroy()\n    this.#content.remove()\n  }\n}\n","import type { SliceType } from '@milkdown/ctx'\nimport type { PluginSpec } from '@milkdown/prose/state'\nimport { Plugin, PluginKey } from '@milkdown/prose/state'\nimport type { $Ctx, $Prose } from '@milkdown/utils'\nimport { $ctx, $prose } from '@milkdown/utils'\n\n/// @internal\nexport type SlashPluginSpecId<Id extends string> = `${Id}_SLASH_SPEC`\n\n/// @internal\nexport type SlashPlugin<Id extends string, State = any> = [\n  $Ctx<PluginSpec<State>, SlashPluginSpecId<Id>>,\n  $Prose,\n] & {\n  key: SliceType<PluginSpec<State>, SlashPluginSpecId<Id>>\n  pluginKey: $Prose['key']\n}\n\n/// Create a slash plugin with a unique id.\nexport function slashFactory<Id extends string, State = any>(id: Id) {\n  const slashSpec = $ctx<PluginSpec<State>, SlashPluginSpecId<Id>>(\n    {},\n    `${id}_SLASH_SPEC`\n  )\n  const slashPlugin = $prose((ctx) => {\n    const spec = ctx.get(slashSpec.key)\n    return new Plugin({\n      key: new PluginKey(`${id}_SLASH`),\n      ...spec,\n    })\n  })\n  const result = [slashSpec, slashPlugin] as SlashPlugin<Id>\n  result.key = slashSpec.key\n  result.pluginKey = slashPlugin.key\n  slashSpec.meta = {\n    package: '@milkdown/plugin-slash',\n    displayName: `Ctx<slashSpec>|${id}`,\n  }\n  slashPlugin.meta = {\n    package: '@milkdown/plugin-slash',\n    displayName: `Prose<slash>|${id}`,\n  }\n\n  return result\n}\n","import { type Component, c, html, useEffect, useRef } from 'atomico'\nimport { menuIcon, plusIcon } from '../../../icons'\nimport type { Icon } from '../../shared'\n\nexport interface BlockHandleProps {\n  show: boolean\n  onAdd: () => void\n  addIcon?: Icon\n  handleIcon?: Icon\n}\n\nconst blockHandleComponent: Component<BlockHandleProps> = ({\n  onAdd,\n  addIcon,\n  handleIcon,\n}) => {\n  const ref = useRef<HTMLDivElement>()\n  useEffect(() => {\n    ref.current?.classList.remove('active')\n  })\n  const onMouseDown = (e: MouseEvent) => {\n    e.preventDefault()\n    e.stopPropagation()\n    ref.current?.classList.add('active')\n  }\n  const onMouseUp = (e: MouseEvent) => {\n    e.preventDefault()\n    e.stopPropagation()\n    onAdd?.()\n    ref.current?.classList.remove('active')\n  }\n  return html`\n    <host>\n      <div\n        ref=${ref}\n        onmousedown=${onMouseDown}\n        onmouseup=${onMouseUp}\n        class=\"operation-item\"\n      >\n        ${addIcon?.() || plusIcon}\n      </div>\n      <div class=\"operation-item\">${handleIcon?.() || menuIcon}</div>\n    </host>\n  `\n}\n\nblockHandleComponent.props = {\n  show: Boolean,\n  onAdd: Function,\n  addIcon: Function,\n  handleIcon: Function,\n}\n\nexport const BlockHandleElement = c(blockHandleComponent)\n","import type { PluginView } from '@milkdown/kit/prose/state'\nimport { TextSelection } from '@milkdown/kit/prose/state'\nimport { BlockProvider, block, blockConfig } from '@milkdown/kit/plugin/block'\nimport type { Ctx } from '@milkdown/kit/ctx'\nimport type { AtomicoThis } from 'atomico/types/dom'\nimport { editorViewCtx } from '@milkdown/kit/core'\nimport { paragraphSchema } from '@milkdown/kit/preset/commonmark'\nimport { findParent } from '@milkdown/kit/prose'\nimport { menuAPI } from '../menu'\nimport { defIfNotExists } from '../../../utils'\nimport type { BlockEditFeatureConfig } from '../index'\nimport type { BlockHandleProps } from './component'\nimport { BlockHandleElement } from './component'\n\nexport class BlockHandleView implements PluginView {\n  #content: AtomicoThis<BlockHandleProps>\n  #provider: BlockProvider\n  readonly #ctx: Ctx\n\n  constructor(ctx: Ctx, config?: BlockEditFeatureConfig) {\n    this.#ctx = ctx\n    const content = new BlockHandleElement()\n    this.#content = content\n    this.#content.onAdd = this.onAdd\n    this.#content.addIcon = config?.handleAddIcon\n    this.#content.handleIcon = config?.handleDragIcon\n    this.#provider = new BlockProvider({\n      ctx,\n      content,\n      getOffset: () => 16,\n      getPlacement: ({ active, blockDom }) => {\n        if (active.node.type.name === 'heading') return 'left'\n\n        let totalDescendant = 0\n        active.node.descendants((node) => {\n          totalDescendant += node.childCount\n        })\n        const dom = active.el\n        const domRect = dom.getBoundingClientRect()\n        const handleRect = blockDom.getBoundingClientRect()\n        const style = window.getComputedStyle(dom)\n        const paddingTop = Number.parseInt(style.paddingTop, 10) || 0\n        const paddingBottom = Number.parseInt(style.paddingBottom, 10) || 0\n        const height = domRect.height - paddingTop - paddingBottom\n        const handleHeight = handleRect.height\n        return totalDescendant > 2 || handleHeight < height\n          ? 'left-start'\n          : 'left'\n      },\n    })\n    this.update()\n  }\n\n  update = () => {\n    this.#provider.update()\n  }\n\n  destroy = () => {\n    this.#provider.destroy()\n    this.#content.remove()\n  }\n\n  onAdd = () => {\n    const ctx = this.#ctx\n    const view = ctx.get(editorViewCtx)\n    if (!view.hasFocus()) view.focus()\n\n    const { state, dispatch } = view\n    const active = this.#provider.active\n    if (!active) return\n\n    const $pos = active.$pos\n    const pos = $pos.pos + active.node.nodeSize\n    let tr = state.tr.insert(pos, paragraphSchema.type(ctx).create())\n    tr = tr.setSelection(TextSelection.near(tr.doc.resolve(pos)))\n    dispatch(tr.scrollIntoView())\n\n    this.#provider.hide()\n    ctx.get(menuAPI.key).show(tr.selection.from)\n  }\n}\n\ndefIfNotExists('milkdown-block-handle', BlockHandleElement)\nexport function configureBlockHandle(\n  ctx: Ctx,\n  config?: BlockEditFeatureConfig\n) {\n  ctx.set(blockConfig.key, {\n    filterNodes: (pos) => {\n      const filter = findParent((node) =>\n        ['table', 'blockquote', 'math_inline'].includes(node.type.name)\n      )(pos)\n      if (filter) return false\n\n      return true\n    },\n  })\n  ctx.set(block.key, {\n    view: () => new BlockHandleView(ctx, config),\n  })\n}\n","import { block } from '@milkdown/kit/plugin/block'\nimport type { DefineFeature, Icon } from '../shared'\nimport { configureBlockHandle } from './handle'\nimport { configureMenu, menu, menuAPI } from './menu'\nimport type { GroupBuilder } from './menu/group-builder'\n\ninterface BlockEditConfig {\n  handleAddIcon: Icon\n  handleDragIcon: Icon\n  buildMenu: (builder: GroupBuilder) => void\n\n  slashMenuTextGroupLabel: string\n  slashMenuTextIcon: Icon\n  slashMenuTextLabel: string\n  slashMenuH1Icon: Icon\n  slashMenuH1Label: string\n  slashMenuH2Icon: Icon\n  slashMenuH2Label: string\n  slashMenuH3Icon: Icon\n  slashMenuH3Label: string\n  slashMenuH4Icon: Icon\n  slashMenuH4Label: string\n  slashMenuH5Icon: Icon\n  slashMenuH5Label: string\n  slashMenuH6Icon: Icon\n  slashMenuH6Label: string\n  slashMenuQuoteIcon: Icon\n  slashMenuQuoteLabel: string\n  slashMenuDividerIcon: Icon\n  slashMenuDividerLabel: string\n\n  slashMenuListGroupLabel: string\n  slashMenuBulletListIcon: Icon\n  slashMenuBulletListLabel: string\n  slashMenuOrderedListIcon: Icon\n  slashMenuOrderedListLabel: string\n  slashMenuTaskListIcon: Icon\n  slashMenuTaskListLabel: string\n\n  slashMenuAdvancedGroupLabel: string\n  slashMenuImageIcon: Icon\n  slashMenuImageLabel: string\n  slashMenuCodeBlockIcon: Icon\n  slashMenuCodeBlockLabel: string\n  slashMenuTableIcon: Icon\n  slashMenuTableLabel: string\n  slashMenuMathIcon: Icon\n  slashMenuMathLabel: string\n}\n\nexport type BlockEditFeatureConfig = Partial<BlockEditConfig>\n\nexport const defineFeature: DefineFeature<BlockEditFeatureConfig> = (\n  editor,\n  config\n) => {\n  editor\n    .config((ctx) => configureBlockHandle(ctx, config))\n    .config((ctx) => configureMenu(ctx, config))\n    .use(menuAPI)\n    .use(block)\n    .use(menu)\n}\n","import type { Meta, MilkdownPlugin } from '@milkdown/ctx'\n\nexport function withMeta<T extends MilkdownPlugin>(\n  plugin: T,\n  meta: Partial<Meta> & Pick<Meta, 'displayName'>\n): T {\n  Object.assign(plugin, {\n    meta: {\n      package: '@milkdown/components',\n      ...meta,\n    },\n  })\n\n  return plugin\n}\n","import { $nodeSchema } from '@milkdown/utils'\nimport { expectDomTypeError } from '@milkdown/exception'\nimport { withMeta } from '../__internal__/meta'\n\nexport const IMAGE_DATA_TYPE = 'image-block'\n\nexport const imageBlockSchema = $nodeSchema('image-block', () => {\n  return {\n    inline: false,\n    group: 'block',\n    selectable: true,\n    draggable: true,\n    isolating: true,\n    marks: '',\n    atom: true,\n    priority: 100,\n    attrs: {\n      src: { default: '' },\n      caption: { default: '' },\n      ratio: { default: 1 },\n    },\n    parseDOM: [\n      {\n        tag: `img[data-type=\"${IMAGE_DATA_TYPE}\"]`,\n        getAttrs: (dom) => {\n          if (!(dom instanceof HTMLElement)) throw expectDomTypeError(dom)\n\n          return {\n            src: dom.getAttribute('src') || '',\n            caption: dom.getAttribute('caption') || '',\n            ratio: Number(dom.getAttribute('ratio') ?? 1),\n          }\n        },\n      },\n    ],\n    toDOM: (node) => ['img', { 'data-type': IMAGE_DATA_TYPE, ...node.attrs }],\n    parseMarkdown: {\n      match: ({ type }) => type === 'image-block',\n      runner: (state, node, type) => {\n        const src = node.url as string\n        const caption = node.title as string\n        let ratio = Number((node.alt as string) || 1)\n        if (Number.isNaN(ratio) || ratio === 0) ratio = 1\n\n        state.addNode(type, {\n          src,\n          caption,\n          ratio,\n        })\n      },\n    },\n    toMarkdown: {\n      match: (node) => node.type.name === 'image-block',\n      runner: (state, node) => {\n        state.openNode('paragraph')\n        state.addNode('image', undefined, undefined, {\n          title: node.attrs.caption,\n          url: node.attrs.src,\n          alt: `${Number.parseFloat(node.attrs.ratio).toFixed(2)}`,\n        })\n        state.closeNode()\n      },\n    },\n  }\n})\n\nwithMeta(imageBlockSchema.node, {\n  displayName: 'NodeSchema<image-block>',\n  group: 'ImageBlock',\n})\n","import type { Node } from '@milkdown/transformer'\nimport { visit } from 'unist-util-visit'\nimport { $remark } from '@milkdown/utils'\nimport { withMeta } from '../__internal__/meta'\n\nfunction visitImage(ast: Node) {\n  return visit(\n    ast,\n    'paragraph',\n    (\n      node: Node & { children?: Node[] },\n      index: number,\n      parent: Node & { children: Node[] }\n    ) => {\n      if (node.children?.length !== 1) return\n      const firstChild = node.children?.[0]\n      if (!firstChild || firstChild.type !== 'image') return\n\n      const { url, alt, title } = firstChild as Node & {\n        url: string\n        alt: string\n        title: string\n      }\n      const newNode = {\n        type: 'image-block',\n        url,\n        alt,\n        title,\n      }\n\n      parent.children.splice(index, 1, newNode)\n    }\n  )\n}\n\nexport const remarkImageBlockPlugin = $remark(\n  'remark-image-block',\n  () => () => visitImage\n)\n\nwithMeta(remarkImageBlockPlugin.plugin, {\n  displayName: 'Remark<remarkImageBlock>',\n  group: 'ImageBlock',\n})\n\nwithMeta(remarkImageBlockPlugin.options, {\n  displayName: 'RemarkConfig<remarkImageBlock>',\n  group: 'ImageBlock',\n})\n","import { $ctx } from '@milkdown/utils'\nimport { html } from 'atomico'\nimport { withMeta } from '../__internal__/meta'\n\nexport interface ImageBlockConfig {\n  imageIcon: () => ReturnType<typeof html> | string | HTMLElement\n  captionIcon: () => ReturnType<typeof html> | string | HTMLElement\n  uploadButton: () => ReturnType<typeof html> | string | HTMLElement\n  confirmButton: () => ReturnType<typeof html> | string | HTMLElement\n  uploadPlaceholderText: string\n  captionPlaceholderText: string\n  onUpload: (file: File) => Promise<string>\n  proxyDomURL?: (url: string) => Promise<string> | string\n}\n\nexport const defaultImageBlockConfig: ImageBlockConfig = {\n  imageIcon: () => '🌌',\n  captionIcon: () => '💬',\n  uploadButton: () => html`Upload file`,\n  confirmButton: () => html`Confirm ⏎`,\n  uploadPlaceholderText: 'or paste the image link ...',\n  captionPlaceholderText: 'Image caption',\n  onUpload: (file) => Promise.resolve(URL.createObjectURL(file)),\n}\n\nexport const imageBlockConfig = $ctx(\n  defaultImageBlockConfig,\n  'imageBlockConfigCtx'\n)\n\nwithMeta(imageBlockConfig, {\n  displayName: 'Config<image-block>',\n  group: 'ImageBlock',\n})\n","import type { Component } from 'atomico'\nimport { c, html, useEffect, useRef, useState } from 'atomico'\nimport { customAlphabet } from 'nanoid'\nimport clsx from 'clsx'\nimport type { ImageBlockConfig } from '../config'\nimport { IMAGE_DATA_TYPE } from '../schema'\nimport { useBlockEffect } from './event'\n\nexport interface Attrs {\n  src: string\n  caption: string\n  ratio: number\n}\n\nexport type ImageComponentProps = Attrs & {\n  config: ImageBlockConfig\n  selected: boolean\n  readonly: boolean\n  setAttr: <T extends keyof Attrs>(attr: T, value: Attrs[T]) => void\n}\n\nlet timer: number = 0\n\nconst nanoid = customAlphabet('abcdefg', 8)\n\nexport const imageComponent: Component<ImageComponentProps> = ({\n  src = '',\n  caption = '',\n  ratio = 1,\n  selected = false,\n  readonly = false,\n  setAttr,\n  config,\n}) => {\n  const image = useRef<HTMLImageElement>()\n  const resizeHandle = useRef<HTMLDivElement>()\n  const linkInput = useRef<HTMLInputElement>()\n  const [showCaption, setShowCaption] = useState(caption.length > 0)\n  const [hidePlaceholder, setHidePlaceholder] = useState(src.length !== 0)\n  const [uuid] = useState(nanoid())\n  const [focusLinkInput, setFocusLinkInput] = useState(false)\n  const [currentLink, setCurrentLink] = useState(src)\n\n  useBlockEffect({\n    image,\n    resizeHandle,\n    ratio,\n    setRatio: (r) => setAttr?.('ratio', r),\n    src,\n    readonly,\n  })\n\n  useEffect(() => {\n    if (selected) return\n\n    setShowCaption(caption.length > 0)\n  }, [selected])\n\n  const onInput = (e: InputEvent) => {\n    const target = e.target as HTMLInputElement\n    const value = target.value\n    if (timer) window.clearTimeout(timer)\n\n    timer = window.setTimeout(() => {\n      setAttr?.('caption', value)\n    }, 1000)\n  }\n\n  const onBlurCaption = (e: InputEvent) => {\n    const target = e.target as HTMLInputElement\n    const value = target.value\n    if (timer) {\n      window.clearTimeout(timer)\n      timer = 0\n    }\n\n    setAttr?.('caption', value)\n  }\n\n  const onEditLink = (e: InputEvent) => {\n    const target = e.target as HTMLInputElement\n    const value = target.value\n    setHidePlaceholder(value.length !== 0)\n    setCurrentLink(value)\n  }\n\n  const onUpload = async (e: InputEvent) => {\n    const file = (e.target as HTMLInputElement).files?.[0]\n    if (!file) return\n\n    const url = await config?.onUpload(file)\n    if (!url) return\n\n    setAttr?.('src', url)\n    setHidePlaceholder(true)\n  }\n\n  const onToggleCaption = (e: Event) => {\n    e.preventDefault()\n    e.stopPropagation()\n    if (readonly) return\n    setShowCaption((x) => !x)\n  }\n\n  const onConfirmLinkInput = () => {\n    setAttr?.('src', linkInput.current?.value ?? '')\n  }\n\n  const onKeydown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') onConfirmLinkInput()\n  }\n\n  const preventDrag = (e: Event) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }\n\n  return html`<host class=${clsx(selected && 'selected')}>\n    <div class=${clsx('image-edit', src.length > 0 && 'hidden')}>\n      <div class=\"image-icon\">${config?.imageIcon()}</div>\n      <div class=${clsx('link-importer', focusLinkInput && 'focus')}>\n        <input\n          ref=${linkInput}\n          draggable=\"true\"\n          ondragstart=${preventDrag}\n          disabled=${readonly}\n          class=\"link-input-area\"\n          value=${currentLink}\n          oninput=${onEditLink}\n          onkeydown=${onKeydown}\n          onfocus=${() => setFocusLinkInput(true)}\n          onblur=${() => setFocusLinkInput(false)}\n        />\n        <div class=${clsx('placeholder', hidePlaceholder && 'hidden')}>\n          <input\n            disabled=${readonly}\n            class=\"hidden\"\n            id=${uuid}\n            type=\"file\"\n            accept=\"image/*\"\n            onchange=${onUpload}\n          />\n          <label class=\"uploader\" for=${uuid}>\n            ${config?.uploadButton()}\n          </label>\n          <span class=\"text\" onclick=${() => linkInput.current?.focus()}>\n            ${config?.uploadPlaceholderText}\n          </span>\n        </div>\n      </div>\n      <div\n        class=${clsx('confirm', currentLink.length === 0 && 'hidden')}\n        onclick=${() => onConfirmLinkInput()}\n      >\n        ${config?.confirmButton()}\n      </div>\n    </div>\n    <div class=${clsx('image-wrapper', src.length === 0 && 'hidden')}>\n      <div class=\"operation\">\n        <div class=\"operation-item\" onpointerdown=${onToggleCaption}>\n          ${config?.captionIcon()}\n        </div>\n      </div>\n      <img\n        ref=${image}\n        data-type=${IMAGE_DATA_TYPE}\n        src=${src}\n        alt=${caption}\n        ratio=${ratio}\n      />\n      <div ref=${resizeHandle} class=\"image-resize-handle\"></div>\n    </div>\n    <input\n      draggable=\"true\"\n      ondragstart=${preventDrag}\n      class=${clsx('caption-input', !showCaption && 'hidden')}\n      placeholder=${config?.captionPlaceholderText}\n      oninput=${onInput}\n      onblur=${onBlurCaption}\n      value=${caption}\n    />\n  </host>`\n}\n\nimageComponent.props = {\n  src: String,\n  caption: String,\n  ratio: Number,\n  selected: Boolean,\n  readonly: Boolean,\n  setAttr: Function,\n  config: Object,\n}\n\nexport const ImageElement = c(imageComponent)\n","import { type Ref, useEffect, useHost, useMemo } from 'atomico'\n\ninterface Options {\n  image: Ref<HTMLImageElement>\n  resizeHandle: Ref<HTMLDivElement>\n  ratio: number\n  setRatio: (ratio: number) => void\n  src: string\n  readonly: boolean\n}\n\nexport function useBlockEffect({\n  image,\n  resizeHandle,\n  ratio,\n  setRatio,\n  src,\n  readonly,\n}: Options) {\n  const host = useHost()\n  const root = useMemo(() => host.current.getRootNode() as HTMLElement, [host])\n\n  useEffect(() => {\n    const imageRef = image.current\n    if (!imageRef) return\n\n    delete imageRef.dataset.origin\n    delete imageRef.dataset.height\n    imageRef.style.height = ''\n  }, [src])\n\n  useEffect(() => {\n    const resizeHandleRef = resizeHandle.current\n    const imageRef = image.current\n    if (!resizeHandleRef || !imageRef) return\n    const onMove = (e: PointerEvent) => {\n      e.preventDefault()\n      const top = imageRef.getBoundingClientRect().top\n      const height = e.clientY - top\n      const h = Number(height < 100 ? 100 : height).toFixed(2)\n      imageRef.dataset.height = h\n      imageRef.style.height = `${h}px`\n    }\n    const pointerUp = () => {\n      root.removeEventListener('pointermove', onMove)\n      root.removeEventListener('pointerup', pointerUp)\n      const originHeight = Number(imageRef.dataset.origin)\n      const currentHeight = Number(imageRef.dataset.height)\n      const ratio = Number.parseFloat(\n        Number(currentHeight / originHeight).toFixed(2)\n      )\n      if (Number.isNaN(ratio)) return\n\n      setRatio(ratio)\n    }\n\n    const pointerDown = (e: PointerEvent) => {\n      if (readonly) return\n      e.preventDefault()\n      root.addEventListener('pointermove', onMove)\n      root.addEventListener('pointerup', pointerUp)\n    }\n\n    const onLoad = (e: Event) => {\n      const maxWidth = host.current.getBoundingClientRect().width\n      if (!maxWidth) return\n\n      const target = e.target as HTMLImageElement\n      const height = target.height\n      const width = target.width\n      const transformedHeight =\n        width < maxWidth ? height : maxWidth * (height / width)\n      const h = (transformedHeight * ratio).toFixed(2)\n      imageRef.dataset.origin = transformedHeight.toFixed(2)\n      imageRef.dataset.height = h\n      imageRef.style.height = `${h}px`\n    }\n\n    imageRef.addEventListener('load', onLoad)\n    resizeHandleRef.addEventListener('pointerdown', pointerDown)\n    return () => {\n      imageRef.removeEventListener('load', onLoad)\n      resizeHandleRef.removeEventListener('pointerdown', pointerDown)\n    }\n  }, [])\n}\n","export function defIfNotExists(\n  tagName: string,\n  element: CustomElementConstructor\n) {\n  const current = customElements.get(tagName)\n  if (current == null) {\n    customElements.define(tagName, element)\n    return\n  }\n\n  if (current === element) return\n\n  // eslint-disable-next-line no-console\n  console.warn(`Custom element ${tagName} has been defined before.`)\n}\n","import { $view } from '@milkdown/utils'\nimport type { NodeViewConstructor } from '@milkdown/prose/view'\nimport type { Node } from '@milkdown/prose/model'\nimport { imageBlockSchema } from '../schema'\nimport { imageBlockConfig } from '../config'\nimport { withMeta } from '../../__internal__/meta'\nimport { defIfNotExists } from '../../__internal__/helper'\nimport type { ImageComponentProps } from './component'\nimport { ImageElement } from './component'\n\ndefIfNotExists('milkdown-image-block', ImageElement)\nexport const imageBlockView = $view(\n  imageBlockSchema.node,\n  (ctx): NodeViewConstructor => {\n    return (initialNode, view, getPos) => {\n      const dom = document.createElement(\n        'milkdown-image-block'\n      ) as HTMLElement & ImageComponentProps\n      const config = ctx.get(imageBlockConfig.key)\n      const proxyDomURL = config.proxyDomURL\n      const bindAttrs = (node: Node) => {\n        if (!proxyDomURL) {\n          dom.src = node.attrs.src\n        } else {\n          const proxiedURL = proxyDomURL(node.attrs.src)\n          if (typeof proxiedURL === 'string') {\n            dom.src = proxiedURL\n          } else {\n            proxiedURL.then((url) => {\n              dom.src = url\n            })\n          }\n        }\n        dom.ratio = node.attrs.ratio\n        dom.caption = node.attrs.caption\n\n        dom.readonly = !view.editable\n      }\n\n      bindAttrs(initialNode)\n      dom.selected = false\n      dom.setAttr = (attr, value) => {\n        const pos = getPos()\n        if (pos == null) return\n\n        view.dispatch(view.state.tr.setNodeAttribute(pos, attr, value))\n      }\n      dom.config = config\n      return {\n        dom,\n        update: (updatedNode) => {\n          if (updatedNode.type !== initialNode.type) return false\n\n          bindAttrs(updatedNode)\n          return true\n        },\n        stopEvent: (e) => {\n          if (e.target instanceof HTMLInputElement) return true\n\n          return false\n        },\n        selectNode: () => {\n          dom.selected = true\n        },\n        deselectNode: () => {\n          dom.selected = false\n        },\n        destroy: () => {\n          dom.remove()\n        },\n      }\n    }\n  }\n)\n\nwithMeta(imageBlockView, {\n  displayName: 'NodeView<image-block>',\n  group: 'ImageBlock',\n})\n","import type { MilkdownPlugin } from '@milkdown/ctx'\nimport { imageBlockSchema } from './schema'\nimport { remarkImageBlockPlugin } from './remark-plugin'\nimport { imageBlockView } from './view'\nimport { imageBlockConfig } from './config'\n\nexport * from './schema'\nexport * from './remark-plugin'\nexport * from './config'\nexport * from './view'\n\nexport const imageBlockComponent: MilkdownPlugin[] = [\n  remarkImageBlockPlugin,\n  imageBlockSchema,\n  imageBlockView,\n  imageBlockConfig,\n].flat()\n","import type { Selection } from '@milkdown/kit/prose/state'\n\nexport function isInCodeBlock(selection: Selection) {\n  const type = selection.$from.parent.type\n  return type.name === 'code_block'\n}\n\nexport function isInList(selection: Selection) {\n  const type = selection.$from.node(selection.$from.depth - 1)?.type\n  return type?.name === 'list_item'\n}\n\nexport function defIfNotExists(\n  tagName: string,\n  element: CustomElementConstructor\n) {\n  if (customElements.get(tagName) == null)\n    customElements.define(tagName, element)\n}\n"],"names":["FUNC_ERROR_TEXT","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","freeGlobal","global","Object","freeSelf","self","root","Function","objectToString","prototype","toString","nativeMax","Math","max","nativeMin","min","now","Date","debounce","func","wait","options","lastArgs","lastThis","maxWait","result","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","args","thisArg","undefined","apply","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","setTimeout","remainingWait","debounced","isInvoking","arguments","this","leadingEdge","toNumber","isObject","cancel","clearTimeout","flush","value","type","isObjectLike","call","isSymbol","other","valueOf","replace","isBinary","test","slice","module","exports","withMeta","plugin","meta","assign","package","blockConfig","$ctx","filterNodes","pos","findParent","node","name","displayName","_detachedDoc","wrapMap","thead","tbody","tfoot","caption","colgroup","col","tr","td","th","serializeForClipboard","view","context","openStart","openEnd","content","childCount","firstChild","push","attrs","defaultAttrs","serializer","someProp","DOMSerializer","fromSchema","state","schema","doc","document","implementation","createHTMLDocument","wrap","createElement","appendChild","serializeFragment","needsWrap","wrappers","nodeType","nodeName","toLowerCase","i","length","wrapper","setAttribute","JSON","stringify","dom","text","f","textBetween","size","brokenClipboardAPI","browser","ie","ie_version","ios","webkit_version","BlockService","constructor","__privateAdd","_BlockService_instances","_ctx","_createSelection","_activeSelection","_active","_activeDOMRect","_dragging","_notify","_hide","_show","_handleMouseDown","_handleMouseUp","_handleDragStart","_mousemoveCallback","_dragEnd","__privateSet","__privateGet","view_get","NodeSelection","isSelectable","nodeSelection","create","$pos","dispatch","setSelection","focus","_a","active","bind","ctx","notify","addEvent","addEventListener","removeEvent","removeEventListener","unBind","el","getBoundingClientRect","requestAnimationFrame","event","dataset","dragging","selection","dataTransfer","effectAllowed","clearData","setData","innerHTML","activeEl","setDragImage","move","keydownCallback","throttle","editable","rect","x","left","width","elementFromPoint","clientY","Element","filterNodes_get","coords","parentElement","posAtCoords","top","y","inside","resolve","nodeAt","element","nodeDOM","filter","needLookup","checkDepth","depth","index","ancestorPos","before","filterResult","selectRootNodeByDom","mousemoveCallback","composing","dragoverCallback","hasHorizontalScrollbar","scrollHeight","clientHeight","rootRect","scrollTop","abs","totalHeight","round","height","dragenterCallback","dragleaveCallback","clientX","window","innerWidth","innerHeight","dropCallback","dragendCallback","WeakMap","WeakSet","get","key","editorViewCtx","blockService","blockServiceInstance","blockSpec","blockPlugin","$prose","milkdownPluginBlockKey","PluginKey","service","getService","set","spec","Plugin","props","handleDOMEvents","drop","pointermove","keydown","dragover","dragleave","dragenter","dragend","BlockProvider","_BlockProvider_instances","_element","_ctx2","_service","_activeNode","_root","_initialized","_middleware","_floatingUIOptions","_getOffset","_getPosition","_getPlacement","update","init_fn","destroy","_b","remove","show","editorDom","deriveContext","blockDom","virtualEl","contextElement","middleware","flip","offsetOption","offsetExt","offset","computePosition","placement","then","_ref","style","hide","getOffset","getPosition","getPlacement","floatingUIOptions","body","message","draggable","block","pluginKey","SlashProvider","_this","_SlashProvider_instances","_debounce","_trigger","_shouldShow","_offset","_onUpdate","onShow","onHide","prevState","ranges","from","map","range","$from","to","$to","isSame","eq","posToDOMRect","updater","getContent","matchNode","empty","isTextBlock","TextSelection","isSlashChildren","contains","activeElement","notHasFocus","hasFocus","isReadonly","paragraph","findParentNode","parent","parentOffset","shouldShow","_shouldShow_fn","trigger","currentTextBlockContent","target","at","Array","isArray","includes","_groups","_getGroupInstance","GroupBuilder","__privateAdd$2","clear","group","groupInstance","addItem","item","data","items","addGroup","label","__privateGet$2","getGroup","find","group2","Error","build","clearRange","deleteRange","clearContentAndSetBlockType","setBlockType","scrollIntoView","clearContentAndWrapInBlockType","blockRange","wrapping","findWrapping","wrapInBlockType","clearContentAndAddBlockType","createAndFill","replaceSelectionWith","addBlockType","menuComponent","config","groups","useMemo","_c","_d","_e","_f","_g","_h","_i","_j","_k","_l","_m","_n","_o","_p","_q","_r","_s","_t","_u","_v","_w","_x","_y","_z","_A","_B","_C","_D","_E","_F","_G","_H","_I","_J","_K","_L","_M","_N","_O","_P","_Q","_R","_S","_T","_U","_V","_W","_X","_Y","_Z","flags","FeaturesCtx","isLatexEnabled","CrepeFeature","Latex","isImageBlockEnabled","ImageBlock","isTableEnabled","Table","groupBuilder","slashMenuTextGroupLabel","icon","slashMenuTextIcon","textIcon","onRun","ctx2","paragraphSchema","command","slashMenuH1Label","slashMenuH1Icon","h1Icon","headingSchema","level","slashMenuH2Label","slashMenuH2Icon","h2Icon","slashMenuH3Label","slashMenuH3Icon","h3Icon","slashMenuH4Label","slashMenuH4Icon","h4Icon","slashMenuH5Label","slashMenuH5Icon","h5Icon","slashMenuH6Label","slashMenuH6Icon","h6Icon","slashMenuQuoteLabel","slashMenuQuoteIcon","quoteIcon","blockquoteSchema","slashMenuDividerLabel","slashMenuDividerIcon","dividerIcon","hrSchema","slashMenuListGroupLabel","slashMenuBulletListLabel","slashMenuBulletListIcon","bulletListIcon","bulletListSchema","slashMenuOrderedListLabel","slashMenuOrderedListIcon","orderedListIcon","orderedListSchema","slashMenuTaskListLabel","slashMenuTaskListIcon","todoListIcon","listItemSchema","checked","advancedGroup","slashMenuAdvancedGroupLabel","slashMenuImageLabel","slashMenuImageIcon","imageIcon","imageBlockSchema","slashMenuCodeBlockLabel","slashMenuCodeBlockIcon","codeIcon","codeBlockSchema","slashMenuTableLabel","slashMenuTableIcon","tableIcon","table","createTable","docSize","near","tr2","slashMenuMathLabel","slashMenuMathIcon","functionsIcon","language","buildMenu","items2","flatMap","groups2","forEach","reduce","acc","end","getGroups","host","useHost","hoverIndex","setHoverIndex","useState","current","getRootNode","prevMousePosition","useRef","onMouseMove","useCallback","e","prevPos","useEffect","onHover","after","prev","next","scrollToIndex","querySelector","scrollRoot","offsetTop","runByIndex","onKeydown","preventDefault","prevGroup","indexOf","nextGroup","onMouseEnter","capture","html","classList","add","Boolean","String","MenuElement","c","_content$1","_slashProvider","_programmaticallyPos","menu","id","slashSpec","slashPlugin","slashFactory","menuAPI","defIfNotExists","MenuView","__privateAdd$1","__privateGet$1","__privateSet$1","view2","isInCodeBlock","isInList","currentText","startsWith","blockHandleComponent","_ref2","onAdd","addIcon","handleIcon","ref","stopPropagation","plusIcon","menuIcon","BlockHandleElement","_content","_provider","BlockHandleView","nodeSize","insert","handleAddIcon","handleDragIcon","_ref3","totalDescendant","descendants","domRect","handleRect","getComputedStyle","paddingTop","Number","paddingBottom","handleHeight","defineFeature","editor","configureBlockHandle","configureMenu","use","__spreadValues$1","IMAGE_DATA_TYPE","$nodeSchema","inline","selectable","isolating","marks","atom","priority","src","default","ratio","parseDOM","tag","getAttrs","HTMLElement","expectDomTypeError","getAttribute","toDOM","__spreadValues","parseMarkdown","match","runner","url","title","alt","isNaN","addNode","toMarkdown","openNode","parseFloat","toFixed","closeNode","visitImage","ast","visit","children","newNode","splice","remarkImageBlockPlugin","$remark","defaultImageBlockConfig","captionIcon","uploadButton","confirmButton","uploadPlaceholderText","captionPlaceholderText","onUpload","file","Promise","URL","createObjectURL","imageBlockConfig","timer","nanoid","customAlphabet","imageComponent","selected","readonly","setAttr","image","resizeHandle","linkInput","showCaption","setShowCaption","hidePlaceholder","setHidePlaceholder","uuid","focusLinkInput","setFocusLinkInput","currentLink","setCurrentLink","setRatio","imageRef","origin","resizeHandleRef","onMove","h","pointerUp","originHeight","currentHeight","ratio2","pointerDown","onLoad","maxWidth","transformedHeight","useBlockEffect","r","onConfirmLinkInput","preventDrag","clsx","__async","files","tagName","customElements","console","warn","define","imageBlockView","$view","initialNode","getPos","proxyDomURL","bindAttrs","proxiedURL","attr","setNodeAttribute","updatedNode","stopEvent","HTMLInputElement","selectNode","deselectNode","imageBlockComponent","flat"],"sourceRoot":""}